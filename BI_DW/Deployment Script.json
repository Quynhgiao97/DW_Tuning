{
  "createOrReplace": {
    "object": {
      "database": "BI_DW_DEV"
    },
    "database": {
      "name": "BI_DW_DEV",
      "compatibilityLevel": 1500,
      "model": {
        "culture": "en-US",
        "dataSources": [
          {
            "type": "structured",
            "name": "SQL/192 168 3 31;PNJ_ROLAP",
            "maxConnections": 4,
            "connectionDetails": {
              "protocol": "tds",
              "address": {
                "server": "192.168.3.31",
                "database": "PNJ_ROLAP"
              },
              "authentication": null,
              "query": null
            },
            "credential": {
              "AuthenticationKind": "UsernamePassword",
              "kind": "SQL",
              "path": "192.168.3.31;PNJ_ROLAP",
              "Username": "biread",
              "EncryptConnection": false
            }
          },
          {
            "type": "structured",
            "name": "SQL/192 168 3 31;DW_RAW",
            "connectionDetails": {
              "protocol": "tds",
              "address": {
                "server": "192.168.3.31",
                "database": "DW_RAW"
              },
              "authentication": null,
              "query": null
            },
            "credential": {
              "AuthenticationKind": "UsernamePassword",
              "kind": "SQL",
              "path": "192.168.3.31;DW_RAW",
              "Username": "biread",
              "EncryptConnection": false
            }
          }
        ],
        "tables": [
          {
            "name": "Dim - Company",
            "columns": [
              {
                "name": "ROW_WID",
                "dataType": "int64",
                "isHidden": true,
                "sourceColumn": "ROW_WID"
              },
              {
                "name": "Company",
                "dataType": "string",
                "sourceColumn": "Company"
              },
              {
                "name": "Short Name",
                "dataType": "string",
                "sourceColumn": "Short Name"
              }
            ],
            "partitions": [
              {
                "name": "Partition",
                "dataView": "full",
                "source": {
                  "type": "m",
                  "expression": [
                    "let",
                    "    Source = #\"SQL/192 168 3 31;PNJ_ROLAP\",",
                    "    dbo_W_INT_ORG_D = Source{[Schema=\"dbo\",Item=\"W_VW_COMPANY_D\"]}[Data],",
                    "    #\"Removed Columns\" = Table.RemoveColumns(dbo_W_INT_ORG_D,{\"BU_FLG\", \"SALES_GROUP_FLG\", \"PRTNR_FLG\", \"INTERNAL_FLG\", \"BUSINESS_AREA_FLG\", \"CONTROL_AREA_FLG\", \"COMPANY_FLG\", \"LEGAL_ENTITY_FLG\", \"BUSINESS_GROUP_FLG\", \"INV_ORG_FLG\", \"HR_ORG_FLG\", \"ASSET_ORG_FLG\", \"PURCH_ORG_FLG\", \"SALES_ORG_FLG\", \"SERVICE_ORG_FLG\", \"COST_ORG_FLG\", \"BRANCH_FLG\", \"RETAIL_FLG\", \"MGR_NAME\", \"INT_ORG_ATTR1_CHAR\", \"INT_ORG_ATTR2_CHAR\", \"INT_ORG_ATTR3_CHAR\", \"INT_ORG_ATTR4_CHAR\", \"INT_ORG_ATTR5_CHAR\", \"INT_ORG_ATTR6_CHAR\", \"INT_ORG_ATTR7_CHAR\", \"INT_ORG_ATTR8_CHAR\", \"INT_ORG_ATTR1_DATE\", \"INT_ORG_ATTR2_DATE\", \"CREATED_ON_DT\", \"CHANGED_ON_DT\", \"EFFECTIVE_FROM_DT\", \"EFFECTIVE_TO_DT\", \"DELETE_FLG\", \"CURRENT_FLG\", \"X_CUSTOM\", \"ACTIVE_FLG\", \"LEDGER_WID\", \"COMPANY_WID\", \"TENANT_ID\", \"LAST_UPDATED_DT\", \"INTEGRATION_ID\", \"DATASOURCE_NUM_ID\"}),",
                    "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"ORG_CODE\", \"Company\"}, {\"ORG_NAME\", \"Short Name\"}, {\"ORG_DESC\", \"Name\"}}),",
                    "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Renamed Columns\",{\"Company\", \"Name\", \"Short Name\", \"ORG_TYPE_CODE\", \"LANGUAGE_CODE\", \"CURRENCY_CODE\", \"ST_ADDRESS1\", \"ST_ADDRESS2\", \"CITY_CODE\", \"ROW_WID\", \"POSTAL_CODE\", \"STATE_PROV_CODE\", \"REGION_CODE\", \"COUNTRY_CODE\", \"COUNTRY_NAME\", \"PHONE_NUM\", \"FAX_NUM\", \"EMAIL_ADDRESS\", \"WEB_ADDRESS\", \"FUNC_AREA_FLG\", \"OPERATING_UNIT_FLG\", \"REGISTRATION_NUM\"}),",
                    "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Reordered Columns\",{\"ORG_TYPE_CODE\", \"LANGUAGE_CODE\"}),",
                    "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Removed Columns1\",{{\"CURRENCY_CODE\", \"Currency\"}, {\"ST_ADDRESS1\", \"Address\"}, {\"ST_ADDRESS2\", \"Address 2\"}}),",
                    "    #\"Removed Columns2\" = Table.RemoveColumns(#\"Renamed Columns1\",{\"Address 2\", \"CITY_CODE\", \"POSTAL_CODE\", \"STATE_PROV_CODE\", \"REGION_CODE\", \"Name\"}),",
                    "    #\"Renamed Columns2\" = Table.RenameColumns(#\"Removed Columns2\",{{\"Short Name\", \"Company Name\"}}),",
                    "    #\"Removed Columns3\" = Table.RemoveColumns(#\"Renamed Columns2\",{\"COUNTRY_CODE\", \"COUNTRY_NAME\", \"PHONE_NUM\", \"FAX_NUM\", \"EMAIL_ADDRESS\", \"WEB_ADDRESS\", \"FUNC_AREA_FLG\", \"REGISTRATION_NUM\", \"OPERATING_UNIT_FLG\", \"Currency\"}),",
                    "    #\"Renamed Columns3\" = Table.RenameColumns(#\"Removed Columns3\",{{\"ORG_SHORT_NAME\", \"Short Name\"}})",
                    "in",
                    "    #\"Renamed Columns3\""
                  ]
                }
              }
            ]
          },
          {
            "name": "Dim - Customer",
            "columns": [
              {
                "name": "BIRTHDAY",
                "dataType": "int64",
                "sourceColumn": "Birthday"
              },
              {
                "name": "Gender",
                "dataType": "string",
                "sourceColumn": "Gender"
              },
              {
                "name": "REGION_WID",
                "dataType": "int64",
                "sourceColumn": "REGION_WID"
              },
              {
                "name": "ROW_WID",
                "dataType": "int64",
                "isHidden": true,
                "sourceColumn": "ROW_WID"
              },
              {
                "name": "PROVINCE_EN",
                "dataType": "string",
                "sourceColumn": "PROVINCE_EN"
              },
              {
                "name": "LOYALTY_POINT",
                "dataType": "int64",
                "sourceColumn": "LOYALTY_POINT"
              },
              {
                "name": "CUST_CARD_DESC",
                "dataType": "string",
                "sourceColumn": "CUST_CARD_DESC"
              },
              {
                "name": "CREATED_ON_DT",
                "dataType": "int64",
                "sourceColumn": "CREATED_ON_DT"
              },
              {
                "name": "CUST_CAT",
                "dataType": "int64",
                "sourceColumn": "CUST_CAT"
              },
              {
                "name": "PHONE_FLAG",
                "dataType": "string",
                "sourceColumn": "PHONE_FLAG"
              },
              {
                "name": "EMAIL_FLAG",
                "dataType": "string",
                "sourceColumn": "EMAIL_FLAG"
              },
              {
                "name": "Customer Code",
                "dataType": "string",
                "sourceColumn": "Customer Code"
              },
              {
                "name": "Customer Group",
                "dataType": "string",
                "sourceColumn": "Customer Group"
              },
              {
                "name": "Created By",
                "dataType": "string",
                "sourceColumn": "Created By"
              },
              {
                "name": "Create Date",
                "dataType": "dateTime",
                "sourceColumn": "Create Date",
                "formatString": "Short Date",
                "annotations": [
                  {
                    "name": "Format",
                    "value": "<Format Format=\"DateTimeShortDatePattern\" />"
                  }
                ]

              },
              {
                "name": "Customer Parent Code",
                "dataType": "string",
                "sourceColumn": "Customer Parent Code"
              },
              {
                "type": "calculated",
                "name": "Age",
                "dataType": "double",
                "isDataTypeInferred": true,
                "expression": " year(today()) - LEFT('Dim - Customer'[Birthday], 4)"
              },
              {
                "type": "calculated",
                "name": "Number of month Not Buy",
                "dataType": "int64",
                "isDataTypeInferred": true,
                "expression": " DATEDIFF('Dim - Customer'[Last Order Date], TODAY(),MONTH)"
              },
              {
                "type": "calculated",
                "name": "VL_Flag",
                "dataType": "string",
                "isDataTypeInferred": true,
                "expression": " if((left('Dim - Customer'[Customer Code], 3) =\"VL_\")||'Dim - Customer'[Customer Code] in {\"KTG\",\"0000\", \"000\"},\"Y\",\"N\")"
              },
              {
                "name": "EMAIL",
                "dataType": "int64",
                "sourceColumn": "EMAIL"
              },
              {
                "name": "Customer Name",
                "dataType": "string",
                "sourceColumn": "Customer Name"
              },
              {
                "name": "Title",
                "dataType": "string",
                "sourceColumn": "Title"
              },
              {
                "name": "Last Order Date",
                "dataType": "dateTime",
                "sourceColumn": "Last Order Date"
              },
              {
                "name": "KOL_FLG",
                "dataType": "boolean",
                "sourceColumn": "KOL_FLG"
              },
              {
                "name": "CUSTOMER_KOL",
                "dataType": "string",
                "sourceColumn": "CUSTOMER_KOL"
              },
              {
                "name": "SEARCH_TERM",
                "dataType": "string",
                "sourceColumn": "SEARCH_TERM"
              }
            ],
            "partitions": [
              {
                "name": "Partition",
                "dataView": "full",
                "source": {
                  "type": "m",
                  "expression": [
                    "let",
                    "    Source = #\"SQL/192 168 3 31;PNJ_ROLAP\",",
                    "    dbo_W_VW_CUSTOMER_D = Source{[Schema=\"dbo\",Item=\"W_VW_CUSTOMER_D\"]}[Data],",
                    "    #\"Renamed Columns\" = Table.RenameColumns(dbo_W_VW_CUSTOMER_D,{{\"CUST_CODE\", \"Customer Code\"}, {\"CUST_NAME\", \"Customer Name\"}, {\"PARENT_CODE\", \"Customer Parent Code\"}, {\"XMAN_CODE\", \"XMAN Code\"}, {\"ADDRESS\", \"Address\"}, {\"STREET\", \"Street\"}, {\"BIRTHDAY\", \"Birthday\"}, {\"PHONE\", \"Phone\"}, {\"GENDER\", \"Gender\"}, {\"TITLE\", \"Title\"}, {\"DISTRICT\", \"District\"}, {\"ACCNT_GRP\", \"Account Group\"}, {\"CUST_GRP\", \"Customer Group\"}, {\"COUNTRY\", \"Country\"}, {\"CUSTOMER_TYPE\", \"Customer Type\"}, {\"PROVINCE\", \"Province\"}, {\"REGION_DESC\", \"Region Description\"}, {\"SUB_REGION\", \"Sub Region\"}, {\"SUB_REGION_DESC\", \"Sub Region Description\"}, {\"CITY\", \"City\"}, {\"CAREER\", \"Career\"}}),",
                    "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Renamed Columns\",{{\"Customer Parent Code\", type text}}),",
                    "    #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type\",{\"PLANT\", \"INTEGRATION_ID\", \"X_CUSTOM\", \"LAST_UPDATED_DT\", \"EFFECTIVE_FROM_DT\", \"EFFECTIVE_TO_DT\", \"CUST_PAR_CODE\", \"Street\", \"Address\"}),",
                    "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Removed Columns\",{\"CUST_REF_CODE\", \"TENANT_ID\", \"DATASOURCE_NUM_ID\", \"Phone\", \"Career\", \"Sub Region Description\", \"Sub Region\", \"Region Description\", \"Province\", \"Customer Type\", \"Account Group\", \"District\", \"Country\", \"City\", \"UPD_STATUS\", \"LONGTITUDE\", \"LATITUDE\", \"CHANGED_ON_DT\"}),",
                    "    #\"Duplicated Column\" = Table.DuplicateColumn(#\"Removed Columns1\", \"CREATED_ON_DT\", \"CREATED_ON_DT - Copy\"),",
                    "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Duplicated Column\",{{\"CREATED_ON_DT\", type date}, {\"LAST_ORDER_DT\", type text}}),",
                    "    #\"Changed Type2\" = Table.TransformColumnTypes(#\"Changed Type1\",{{\"LAST_ORDER_DT\", type date}}),",
                    "    #\"Renamed Columns2\" = Table.RenameColumns(#\"Changed Type2\",{{\"CREATED_ON_DT\", \"Create Date\"}, {\"LAST_ORDER_DT\", \"Last Order Date\"}, {\"CREATED_ON_DT - Copy\", \"CREATED_ON_DT\"}, {\"REGISTER_BY\", \"Created By\"}}),",
                    "    #\"Removed Columns3\" = Table.RemoveColumns(#\"Renamed Columns2\",{\"XMAN Code\", \"WARD\"})",
                    "in",
                    "    #\"Removed Columns3\""
                  ]
                }
              }
            ],
            "measures": [
              {
                "name": "# Customer (Master)",
                "expression": " CALCULATE(DISTINCTCOUNT('Dim - Customer'[Customer Parent Code]))",
                "formatString": "#,0"
              },
              {
                "name": "# Customer (master) (create)",
                "expression": " CALCULATE('Dim - Customer'[# Customer (Master)], USERELATIONSHIP('Dim - Customer'[CREATED_ON_DT], 'Dim - Time'[ROW_WID]))",
                "formatString": "#,0"
              },
              {
                "name": "# Customer NOT Buy",
                "expression": " CALCULATE(DISTINCTCOUNT('Dim - Customer'[Customer Parent Code]),FILTER('Dim - Customer', ISBLANK('Dim - Customer'[Last Order Date]) =TRUE()),USERELATIONSHIP('Dim - Customer'[CREATED_ON_DT], 'Dim - Time'[ROW_WID]))",
                "formatString": "#,0"
              }
            ]
          },
          {
            "name": "Dim - Product",
            "columns": [
              {
                "name": "ROW_WID",
                "dataType": "int64",
                "isHidden": true,
                "sourceColumn": "ROW_WID"
              },
              {
                "name": "PROD_CAT_WID",
                "dataType": "int64",
                "sourceColumn": "PROD_CAT_WID"
              },
              {
                "name": "Product Code",
                "dataType": "string",
                "sourceColumn": "Product Code"
              },
              {
                "name": "Product Name",
                "dataType": "string",
                "sourceColumn": "Product Name"
              },
              {
                "name": "XMAN Product Code",
                "dataType": "string",
                "sourceColumn": "XMAN Product Code"
              },
              {
                "name": "Product Type Name",
                "dataType": "string",
                "sourceColumn": "Product Type Name"
              },
              {
                "name": "Purity of Gold",
                "dataType": "double",
                "sourceColumn": "Purity of Gold"
              },
              {
                "name": "Brand class",
                "dataType": "string",
                "sourceColumn": "Brand class"
              },
              {
                "name": "COLECTION_CODE",
                "dataType": "string",
                "sourceColumn": "COLECTION_CODE"
              },
              {
                "name": "Item Size",
                "dataType": "string",
                "sourceColumn": "Item Size"
              },
              {
                "name": "Product Group 2 Code",
                "dataType": "string",
                "sourceColumn": "Product Group 2 Code"
              },
              {
                "name": "Product Group 2 Name",
                "dataType": "string",
                "sourceColumn": "Product Group 2 Name"
              },
              {
                "name": "Product Group 3 Code",
                "dataType": "string",
                "sourceColumn": "Product Group 3 Code"
              },
              {
                "name": "Product Group 3 Name",
                "dataType": "string",
                "sourceColumn": "Product Group 3 Name"
              },
              {
                "name": "Product Group 4 Code",
                "dataType": "string",
                "sourceColumn": "Product Group 4 Code"
              },
              {
                "name": "Product Group 4 Name",
                "dataType": "string",
                "sourceColumn": "Product Group 4 Name"
              },
              {
                "name": "SIZE",
                "dataType": "string",
                "sourceColumn": "Size"
              },
              {
                "name": "SC_PRODUCT_LV4",
                "dataType": "string",
                "sourceColumn": "SC_PRODUCT_LV4"
              },
              {
                "name": "Colection Name",
                "dataType": "string",
                "sourceColumn": "Colection Name"
              },
              {
                "name": "RPT - Product Group 2 Code",
                "dataType": "string",
                "sourceColumn": "RPT - Product Group 2 Code"
              },
              {
                "name": "RPT - Product Group 7 Name",
                "dataType": "string",
                "sourceColumn": "RPT - Product Group 7 Name"
              },
              {
                "name": "RPT - Product Group 4 Name",
                "dataType": "string",
                "sourceColumn": "RPT - Product Group 4 Name"
              },
              {
                "name": "MKT_PRODUCT_GRP4_RPT",
                "dataType": "string",
                "sourceColumn": "MKT_PRODUCT_GRP4_RPT"
              },
              {
                "name": "RPT - Product Group 2 Name",
                "dataType": "string",
                "sourceColumn": "RPT - Product Group 2 Name"
              },
              {
                "name": "Product Kind",
                "dataType": "string",
                "sourceColumn": "Product Kind"
              },
              {
                "name": "Gem Type",
                "dataType": "string",
                "sourceColumn": "Gem Type"
              },
              {
                "name": "Gem Main",
                "dataType": "string",
                "sourceColumn": "Gem Main"
              },
              {
                "name": "Gem Second",
                "dataType": "string",
                "sourceColumn": "Gem Second"
              },
              {
                "name": "Gem Group Size",
                "dataType": "string",
                "sourceColumn": "Gem Group Size"
              },
              {
                "name": "Gem Group Size (SAP)",
                "dataType": "string",
                "sourceColumn": "Gem Group Size (SAP)"
              },
              {
                "name": "Gem Group Size (MKT)",
                "dataType": "string",
                "sourceColumn": "Gem Group Size (MKT)"
              },
              {
                "name": "net_weight",
                "dataType": "double",
                "sourceColumn": "net_weight"
              },
              {
                "name": "Co-Operate Brand",
                "dataType": "string",
                "sourceColumn": "Co-Operate Brand"
              },
              {
                "name": "CREATION_STATUS_INFO",
                "dataType": "string",
                "sourceColumn": "CREATION_STATUS_INFO"
              }
            ],
            "partitions": [
              {
                "name": "Partition",
                "dataView": "full",
                "source": {
                  "type": "m",
                  "expression": [
                    "let",
                    "    Source = Value.NativeQuery(#\"SQL/192 168 3 31;PNJ_ROLAP\",\"SELECT  [ROW_WID]",
                    "      ,[INTEGRATION_ID]",
                    "      ,[DATASOURCE_NUM_ID]",
                    "      ,[PROD_NUM]",
                    "      ,[PRODUCT_NAME]",
                    "      ,[PRODUCT_SHORT_NAME]",
                    "      ,[PRODUCT_DESC_EINVC]",
                    "      ,[PRODUCT_DESC_SD]",
                    "      ,[XMAN_PROD_NUM]",
                    "      ,[SUB_SEGMENT_CODE]",
                    "      ,[PRODUCT_TYPE_CODE]",
                    "      ,[PRODUCT_TYPE_NAME]",
                    "      ,[BASIC_PRODUCT]",
                    "      ,[PROD_GRP]",
                    "      ,[PROD_GRP_NAME]",
                    "      ,[PROD_GRP1]",
                    "      ,[PROD_GRP1_NAME]",
                    "      ,[PROD_GRP2]",
                    "      ,[PROD_GRP2_NAME]",
                    "      ,[PROD_GRP3]",
                    "      ,[PROD_GRP3_NAME]",
                    "      ,[PROD_GRP4]",
                    "      ,[PROD_GRP4_NAME]",
                    "      ,[PROD_GRP5]",
                    "      ,[PROD_GRP5_NAME]",
                    "      ,[PROD_GRP6]",
                    "      ,[PROD_GRP6_NAME]",
                    "      ,[PROD_GRP7]",
                    "      ,[PROD_GRP7_NAME]",
                    "      ,[PROD_COST_EST_NUM]",
                    "      ,[DIVISION]",
                    "      ,[LOW_LEVEL_CODE]",
                    "      ,[COLOR]",
                    "      ,[CUSTOM_PROD_FLG]",
                    "      ,[ITEM_SIZE]",
                    "      ,[PART_NUM]",
                    "      ,[HAZARD_MTL_CODE]",
                    "      ,[SALES_UOM_CODE]",
                    "      ,[SHELF_LIFE]",
                    "      ,[SOURCE_OF_SUPPLY]",
                    "      ,[BASE_UOM_CODE]",
                    "      ,[PURITY_OF_GOLD]",

                    "      ,[UNIT_GROSS_WEIGHT]",
                    "      ,[UNIT_NET_WEIGHT]",
                    "      ,[UNIT_WEIGHT]",
                    "      ,[VOLUME]",
                    "      ,[UNIT_VOLUME]",
                    "      ,[STATUS_CODE]",
                    "      ,[STANDARD_PRICE]",
                    "      ,[ABC_INDICATOR]",
                    "      ,[VALUATION_CLASS_CODE]",
                    "      ,[PRODUCT_CAT_CODE]",
                    "      ,[COST_ORG_CODE]",
                    "      ,[PROFIT_CENTER_CODE]",
                    "      ,[LANGUAGE_CODE]",
                    "      ,[ACTIVE_FLG]",
                    "      ,[DELETE_FLG]",
                    "      ,[CREATED_ON_DT]",
                    "      ,[CHANGED_ON_DT]",
                    "      ,[EFFECTIVE_FROM_DT]",
                    "      ,[EFFECTIVE_TO_DT]",
                    "      ,[X_CUSTOM]",
                    "      ,[TENANT_ID]",
                    "      ,[LAST_UPDATED_DT]",
                    "      ,[PROD_CAT_WID]",
                    "      ,[COLECTION_CODE]",
                    "      ,[COLECTION_NAME]",
                    "      ,[PROD_CAT2_CODE]",
                    "      ,[PROD_CAT2_NAME]",
                    "      ,[PROD_CAT3_CODE]",
                    "      ,[PROD_CAT3_NAME]",
                    "      ,[PROD_CAT4_CODE]",
                    "      ,[PROD_CAT4_NAME]",
                    "      ,[PROD_LV2_RPT]",
                    "      ,[PROD_GRP_7_RPT]",
                    "      ,[PROD_LV4_RPT]",
                    "      ,[MKT_PRODUCT_GRP4_RPT]",
                    "      ,[PROD_LV2_RPT_NAME]",
                    "      ,[Brand class]",
                    "      ,[PRODUCT_KIND]",
                    "      ,[STONE_TYPE]",
                    "      ,[STONE_MAIN]",
                    "      ,[STONE_SECOND]",
                    "      ,[SIZE]",
                    "      ,[SIZE_WID]",
                    "      ,[SIZE_STONE]",
                    "      ,[SIZE_STONE_SAP]",
                    "      ,[SIZE_STONE_MKT]",
                    "      ,[SC_PRODUCT_LV4]",
                    "      ,[net_weight]",
                    "      ,[BRAND]",
                    "      ,[CREATION_STATUS_INFO]",
                    "  FROM [dbo].[W_VW_PRODUCT_D] with (nolock)\"),",
                    "       #\"Removed Columns\" = Table.RemoveColumns(Source,{\"INTEGRATION_ID\", \"PROD_COST_EST_NUM\", \"LOW_LEVEL_CODE\", \"CUSTOM_PROD_FLG\", \"HAZARD_MTL_CODE\", \"SALES_UOM_CODE\", \"PART_NUM\", \"SHELF_LIFE\", \"SOURCE_OF_SUPPLY\", \"STATUS_CODE\", \"STANDARD_PRICE\", \"ABC_INDICATOR\", \"VALUATION_CLASS_CODE\", \"LANGUAGE_CODE\", \"CREATED_ON_DT\", \"CHANGED_ON_DT\", \"X_CUSTOM\", \"LAST_UPDATED_DT\", \"PRODUCT_SHORT_NAME\", \"PRODUCT_DESC_EINVC\", \"PRODUCT_DESC_SD\"}),",
                    "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"PROD_NUM\", \"Product Number\"}, {\"PRODUCT_NAME\", \"Product Name\"}, {\"XMAN_PROD_NUM\", \"XMAN Product Number\"}, {\"SUB_SEGMENT_CODE\", \"Sub Segment Code\"}, {\"PRODUCT_TYPE_CODE\", \"Product Type Code\"}, {\"PRODUCT_TYPE_NAME\", \"Product Type Name\"}, {\"BASIC_PRODUCT\", \"Basic Product\"}, {\"PROD_GRP\", \"Product Group\"}, {\"PROD_GRP_NAME\", \"Product Group Name\"}, {\"PROD_GRP1\", \"Product Group LV1\"}, {\"PROD_GRP1_NAME\", \"Product Group Name LV1\"}, {\"PROD_GRP2\", \"Product Group LV2\"}, {\"PROD_GRP2_NAME\", \"Product Group Name LV2\"}, {\"PROD_GRP3\", \"Product Group LV3\"}, {\"PROD_GRP3_NAME\", \"Product Group Name LV3\"}, {\"PROD_GRP4\", \"Product Group LV4\"}, {\"PROD_GRP4_NAME\", \"Product Group Name LV4\"}, {\"PROD_GRP5\", \"Product Group LV5\"}, {\"PROD_GRP5_NAME\", \"Product Group Name LV5\"}, {\"PROD_GRP6\", \"Product Group LV6\"}, {\"PROD_GRP6_NAME\", \"Product Group Name LV6\"}, {\"PROD_GRP7\", \"Product Group LV7\"}, {\"PROD_GRP7_NAME\", \"Product Group Name LV7\"}, {\"DIVISION\", \"Division\"}, {\"COLOR\", \"Color\"}, {\"ITEM_SIZE\", \"Item Size\"}, {\"BASE_UOM_CODE\", \"Base UOM Code\"}, {\"PURITY_OF_GOLD\", \"Purity of Gold\"}, {\"UNIT_GROSS_WEIGHT\", \"Gross Weight\"}, {\"UNIT_NET_WEIGHT\", \"Net Weight\"}, {\"UNIT_WEIGHT\", \"Unit Weight\"}, {\"VOLUME\", \"Volume\"}, {\"UNIT_VOLUME\", \"Unit Volume\"}, {\"PRODUCT_CAT_CODE\", \"Product Category Code\"}, {\"COST_ORG_CODE\", \"Cost ORG Code\"}, {\"PROFIT_CENTER_CODE\", \"Profit Center Code\"}, {\"ACTIVE_FLG\", \"Active Flag\"}, {\"DELETE_FLG\", \"Delete Flag\"}, {\"EFFECTIVE_FROM_DT\", \"Effective From Date\"}, {\"EFFECTIVE_TO_DT\", \"Effective To Date\"}, {\"TENANT_ID\", \"Tenant ID\"}}),",
                    "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Renamed Columns\",{\"Effective From Date\", \"Effective To Date\", \"Cost ORG Code\", \"DATASOURCE_NUM_ID\", \"Tenant ID\", \"Gross Weight\", \"Net Weight\", \"Unit Weight\", \"Volume\", \"Unit Volume\", \"Sub Segment Code\"}),",
                    "    #\"Removed Columns2\" = Table.RemoveColumns(#\"Removed Columns1\",{\"Basic Product\", \"Product Group\", \"Product Group Name\", \"Product Group LV1\", \"Product Group Name LV1\", \"Product Group LV2\", \"Product Group Name LV2\", \"Product Group LV3\", \"Product Group Name LV3\", \"Product Group LV4\", \"Product Group Name LV4\", \"Product Group LV5\", \"Product Group Name LV5\", \"Product Group LV6\", \"Product Group Name LV6\", \"Product Group LV7\", \"Product Group Name LV7\", \"Division\", \"Profit Center Code\", \"Active Flag\", \"Delete Flag\"}),",
                    "    #\"Removed Duplicates\" = Table.Distinct(#\"Removed Columns2\", {\"Product Number\"}),",
                    "    #\"Removed Columns3\" = Table.RemoveColumns(#\"Removed Duplicates\",{\"Color\"}),",
                    "    #\"Renamed Columns2\" = Table.RenameColumns(#\"Removed Columns3\",{{\"Product Number\", \"Product Code\"}, {\"XMAN Product Number\", \"XMAN Product Code\"}}),",
                    "    #\"Removed Columns4\" = Table.RemoveColumns(#\"Renamed Columns2\",{\"Product Type Code\", \"Product Category Code\", \"Base UOM Code\"}),",
                    "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Removed Columns4\",{{\"PROD_LV4_RPT\", \"RPT - Product Group 4 Name\"}, {\"PROD_LV2_RPT_NAME\", \"RPT - Product Group 2 Name\"}, {\"PROD_LV2_RPT\", \"RPT - Product Group 2 Code\"}, {\"PROD_CAT3_NAME\", \"Product Group 3 Name\"}, {\"PROD_CAT3_CODE\", \"Product Group 3 Code\"}, {\"PROD_CAT2_NAME\", \"Product Group 2 Name\"}, {\"PROD_CAT2_CODE\", \"Product Group 2 Code\"}, {\"PROD_CAT4_CODE\", \"Product Group 4 Code\"}, {\"PROD_CAT4_NAME\", \"Product Group 4 Name\"}, {\"COLECTION_NAME\", \"Colection Name\"}, {\"PROD_GRP_7_RPT\", \"RPT - Product Group 7 Name\"}, {\"STONE_TYPE\", \"Gem Type\"}, {\"STONE_MAIN\", \"Gem Main\"}, {\"STONE_SECOND\", \"Gem Second\"}, {\"PRODUCT_KIND\", \"Product Kind\"}, {\"SIZE\", \"Size\"}}),",
                    "    #\"Removed Columns5\" = Table.RemoveColumns(#\"Renamed Columns1\",{\"SIZE_WID\"}),",
                    "    #\"Renamed Columns3\" = Table.RenameColumns(#\"Removed Columns5\",{{\"SIZE_STONE\", \"Gem Group Size\"}, {\"SIZE_STONE_SAP\", \"Gem Group Size (SAP)\"}, {\"SIZE_STONE_MKT\", \"Gem Group Size (MKT)\"}, {\"BRAND\", \"Co-Operate Brand\"}})",
                    "in",
                    "    #\"Renamed Columns3\""
                  ]
                }
              }
            ]
          },
          {
            "name": "Dim - Time",
            "dataCategory": "Time",
            "columns": [
              {
                "name": "ROW_WID",
                "dataType": "int64",
                "isHidden": true,
                "sourceColumn": "ROW_WID"
              },
              {
                "name": "WEEKEND_FLG",
                "dataType": "string",
                "sourceColumn": "WEEKEND_FLG"
              },
              {
                "name": "MONTH_AGO_WID",
                "dataType": "int64",
                "sourceColumn": "MONTH_AGO_WID"
              },
              {
                "name": "YEAR_AGO_WID",
                "dataType": "int64",
                "sourceColumn": "YEAR_AGO_WID"
              },
              {
                "name": "Year",
                "dataType": "string",
                "sourceColumn": "Year"
              },
              {
                "name": "Half Year",
                "dataType": "string",
                "sourceColumn": "Half Year"
              },
              {
                "name": "Quater",
                "dataType": "string",
                "sourceColumn": "Quater"
              },
              {
                "name": "Month",
                "dataType": "string",
                "sourceColumn": "Month"
              },
              {
                "name": "Week",
                "dataType": "string",
                "sourceColumn": "Week"
              },
              {
                "name": "Date",
                "dataType": "dateTime",
                "isKey": true,
                "sourceColumn": "Date"
              },
              {
                "name": "Day Name",
                "dataType": "string",
                "sourceColumn": "Day Name",
                "sortByColumn": "Day of Week Num"
              },
              {
                "name": "Day of Month",
                "dataType": "int64",
                "sourceColumn": "Day of Month"
              },
              {
                "name": "Day of Week Num",
                "dataType": "int64",
                "sourceColumn": "Day of Week Num"
              },
              {
                "name": "Month Name",
                "dataType": "string",
                "sourceColumn": "Month Name"
              },
              {
                "name": "Holiday Flag",
                "dataType": "string",
                "sourceColumn": "Holiday Flag"
              },
              {
                "name": "Lunar Month",
                "dataType": "string",
                "sourceColumn": "Lunar Month"
              },
              {
                "name": "Lunar Date Key",
                "dataType": "int64",
                "sourceColumn": "Lunar Date Key"
              },
              {
                "name": "Lunar Day",
                "dataType": "string",
                "sourceColumn": "Lunar Day"
              },
              {
                "type": "calculated",
                "name": "Month year",
                "dataType": "string",
                "isDataTypeInferred": true,
                "expression": " FORMAT('Dim - Time'[Date], \"mmm yyyy\")"
              },
              {
                "type": "calculated",
                "name": "Month Num",
                "dataType": "string",
                "isDataTypeInferred": true,
                "expression": " mid('Dim - Time'[ROW_WID], 5,2)"
              },
              {
                "name": "! Quater Key",
                "dataType": "int64",
                "sourceColumn": "! Quater Key"
              },
              {
                "type": "calculated",
                "name": "!Order Quater Key",
                "dataType": "int64",
                "isDataTypeInferred": true,
                "expression": " RANKX('Dim - Time', 'Dim - Time'[! Quater Key],, ASC, Dense)"
              },
              {
                "type": "calculated",
                "name": "Year Format",
                "dataType": "string",
                "isDataTypeInferred": true,
                "expression": " IF(YEAR('Dim - Time'[Date]) = YEAR(TODAY()) && YEAR('Dim - Time'[Date]) = YEAR(TODAY()),\"This year\", 'Dim - Time'[Year])"
              },
              {
                "type": "calculated",
                "name": "Month Format",
                "dataType": "string",
                "isDataTypeInferred": true,
                "expression": " IF(MONTH('Dim - Time'[Date]) = MONTH(TODAY()) && YEAR('Dim - Time'[Date]) = YEAR(TODAY()),\"This month\", 'Dim - Time'[Month Num])"
              },
              {
                "type": "calculated",
                "name": "now",
                "dataType": "string",
                "isDataTypeInferred": false,
                "expression": " TODAY()"
              },
              {
                "type": "calculated",
                "name": "earliest Refresh Date",
                "dataType": "dateTime",
                "isDataTypeInferred": true,
                "expression": " NOW()"
              },
              {
                "type": "calculated",
                "name": "Day_today",
                "dataType": "string",
                "isDataTypeInferred": true,
                "expression": " IF( VALUE('Dim - Time'[Date]) = TODAY(),\"Today\", FORMAT('Dim - Time'[Date],\"mm/dd/yyyy\"))"
              }
            ],
            "partitions": [
              {
                "name": "Partition",
                "dataView": "full",
                "source": {
                  "type": "m",
                  "expression": [
                    "let",
                    "    Source = #\"SQL/192 168 3 31;PNJ_ROLAP\",",
                    "    dbo_W_DAY_D = Source{[Schema=\"dbo\",Item=\"W_DAY_D\"]}[Data],",
                    "    #\"Removed Columns\" = Table.RemoveColumns(dbo_W_DAY_D,{\"ENT_PERIOD_AGO_WID\", \"CAL_HALF\", \"CAL_QTR\", \"CAL_TRIMESTER\", \"CAL_WEEK\", \"DATASOURCE_NUM_ID\", \"ENT_DAY_OF_PERIOD\", \"ENT_DAY_OF_WEEK\", \"ENT_DAY_OF_YEAR\", \"ENT_HALF\", \"ENT_PERIOD\", \"ENT_QTR\", \"ENT_TRIMESTER\", \"ENT_WEEK\", \"ENT_YEAR\", \"HALF_AGO_DT\", \"HALF_AGO_WID\", \"PER_NAME_ENT_QTR\", \"PER_NAME_ENT_TER\", \"PER_NAME_ENT_WEEK\", \"PER_NAME_ENT_YEAR\", \"PER_NAME_OFFSET_WK\", \"TRIMESTER_AGO_DT\", \"TRIMESTER_AGO_WID\", \"WEEK_AGO_DT\", \"WEEK_AGO_WID\", \"M_END_CAL_DT_WID\", \"CAL_WEEK_END_DT_WID\", \"CAL_WEEK_START_DT_WID\", \"CAL_QTR_END_DT_WID\", \"CAL_QTR_START_DT_WID\", \"FST_DAY_CAL_WK_FLG\", \"LAST_DAY_CAL_WK_FLG\", \"FST_DAY_CAL_MNTH_FLG\", \"FST_DAY_CAL_QTR_FLG\", \"LAST_DAY_CAL_QTR_FLG\", \"FST_DAY_CAL_YEAR_FLG\", \"LAST_DAY_CAL_YEAR_FLG\", \"ENT_WEEK_START_DT\", \"ENT_WEEK_END_DT\", \"ENT_PERIOD_START_DT\", \"ENT_PERIOD_END_DT\", \"ENT_QTR_START_DT\", \"ENT_QTR_END_DT\", \"ENT_YEAR_START_DT\", \"ENT_YEAR_END_DT\", \"ENT_WEEK_START_DT_WID\", \"ENT_WEEK_END_DT_WID\", \"ENT_PERIOD_START_DT_WID\", \"ENT_PERIOD_END_DT_WID\", \"ENT_QTR_START_DT_WID\", \"ENT_QTR_END_DT_WID\", \"ENT_YEAR_START_DT_WID\", \"ENT_YEAR_END_DT_WID\", \"ENT_PERIOD_WEEK_NUM\", \"FST_DAY_ENT_WEEK_FLG\", \"LAST_DAY_ENT_WEEK_FLG\", \"FST_DAY_ENT_PERIOD_FLG\", \"LAST_DAY_ENT_PERIOD_FLG\", \"FST_DAY_ENT_QTR_FLG\", \"LAST_DAY_ENT_QTR_FLG\", \"FST_DAY_ENT_YEAR_FLG\", \"LAST_DAY_ENT_YEAR_FLG\", \"INTEGRATION_ID\", \"ENT_QTR_AGO_WID\", \"DATE_KEY\", \"DAY_AGO_DT\", \"DAY_AGO_WID\", \"DAY_OF_YEAR\", \"MONTH_AGO_DT\", \"PER_NAME_TER\", \"QUARTER_AGO_DT\", \"QUARTER_AGO_WID\", \"YEAR_AGO_DT\", \"CAL_YEAR_END_DT_WID\", \"CAL_YEAR_START_DT_WID\", \"CAL_YEAR_START_DT\", \"CAL_YEAR_END_DT\", \"CAL_YEAR_WID\", \"ENT_WEEK_AGO_WID\", \"CAL_YEAR\", \"CAL_MONTH\", \"PER_NAME_ENT_HALF\"}),",
                    "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"CALENDAR_DATE\", \"Date\"}, {\"PER_NAME_HALF\", \"Half Year\"}, {\"PER_NAME_MONTH\", \"Month\"}, {\"PER_NAME_QTR\", \"Quater\"}, {\"PER_NAME_WEEK\", \"Week\"}, {\"PER_NAME_YEAR\", \"Year\"}, {\"PER_NAME_ENT_PERIOD\", \"Period\"}, {\"HOLIDAY_FLG\", \"Holiday Flag\"}, {\"DAY_OF_MONTH\", \"Day of Month\"}, {\"CAL_MONTH_WID\", \"MONTH_KEY\"}, {\"DAY_OF_WEEK\", \"Day of Week Num\"}, {\"DAY_NAME\", \"Day Name\"}, {\"MONTH_NAME\", \"Month Name\"}}),",
                    "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Renamed Columns\",{\"M_START_CAL_DT\", \"M_END_CAL_DT\", \"LAST_DAY_CAL_MNTH_FLG\", \"M_START_CAL_DT_WID\", \"ENT_DATE\", \"ENT_PERIOD_WID\"}),",
                    "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Removed Columns1\",{{\"LUNAR_DATE_WID\", \"Lunar Date Key\"}, {\"LUNAR_DAY\", \"Lunar Day\"}, {\"LUNAR_MONTH\", \"Lunar Month\"}, {\"LUNAR_YEAR\", \"Lunar Year\"}}),",
                    "    #\"Removed Columns2\" = Table.RemoveColumns(#\"Renamed Columns1\",{\"MONTH_KEY\"}),",
                    "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Removed Columns2\",{\"Year\", \"Half Year\", \"Quater\", \"Month\", \"Week\", \"Date\", \"Day Name\", \"Day of Month\", \"Day of Week Num\", \"Month Name\", \"ROW_WID\", \"Holiday Flag\", \"MONTH_AGO_WID\", \"YEAR_AGO_WID\", \"Period\", \"Lunar Year\", \"Lunar Month\", \"Lunar Date Key\", \"Lunar Day\"}),",
                    "    #\"Removed Columns3\" = Table.RemoveColumns(#\"Reordered Columns\",{\"Period\", \"Lunar Year\"}),",
                    "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Removed Columns3\",{{\"Date\", type date}}),",
                    "    #\"Reordered Columns1\" = Table.ReorderColumns(#\"Changed Type\",{\"Year\", \"Half Year\", \"Quater\", \"Month\", \"Week\", \"Date\", \"Day Name\", \"Day of Month\", \"Day of Week Num\", \"Month Name\", \"ROW_WID\", \"Holiday Flag\", \"MONTH_AGO_WID\", \"YEAR_AGO_WID\", \"Lunar Month\", \"Lunar Date Key\", \"Lunar Day\"}),",
                    "    #\"Filtered Rows\" = Table.SelectRows(#\"Reordered Columns1\", each ([Year] = \"2014\" or [Year] = \"2015\" or [Year] = \"2016\" or [Year] = \"2017\" or [Year] = \"2018\" or [Year] = \"2019\" or [Year] = \"2020\" or [Year] = \"2021\" or [Year] = \"2022\" or [Year] = \"2023\" or [Year] = \"2024\" or [Year] = \"2025\" or [Year] = \"2026\" or [Year] = \"2027\" or [Year] = \"2028\")),",
                    "    #\"Renamed Columns2\" = Table.RenameColumns(#\"Filtered Rows\",{{\"CAL_QTR_WID\", \"! Quater Key\"}})",
                    "in",
                    "    #\"Renamed Columns2\""
                  ]
                }
              }
            ]
          },
          {
            "name": "Dim - Plant",
            "columns": [
              {
                "name": "ROW_WID",
                "dataType": "int64",
                "isHidden": true,
                "sourceColumn": "ROW_WID"
              },
              {
                "name": "TIER",
                "dataType": "int64",
                "sourceColumn": "TIER",
                "summarizeBy": "none"
              },
              {
                "name": "REGION",
                "dataType": "string",
                "sourceColumn": "Region"
              },
              {
                "name": "PROVINCE",
                "dataType": "string",
                "sourceColumn": "PROVINCE"
              },
              {
                "name": "DISTRICT",
                "dataType": "string",
                "sourceColumn": "DISTRICT"
              },
              {
                "name": "CLOSED_DT",
                "dataType": "string",
                "sourceColumn": "CLOSED_DT"
              },
              {
                "name": "Plant Code",
                "dataType": "string",
                "sourceColumn": "Plant Code"
              },
              {
                "name": "Distribution Channel",
                "dataType": "string",
                "sourceColumn": "Distribution Channel"
              },
              {
                "name": "Plant Type",
                "dataType": "string",
                "sourceColumn": "Plant Type"
              },
              {
                "name": "Channel Plant",
                "dataType": "string",
                "sourceColumn": "Channel Plant"
              },
              {
                "name": "Open Date",
                "dataType": "string",
                "sourceColumn": "Open Date"
              },
              {
                "name": "Sales District Name",
                "dataType": "string",
                "sourceColumn": "Sales District Name"
              },
              {
                "name": "First Transaction DT",
                "dataType": "int64",
                "sourceColumn": "First Transaction DT",
                "summarizeBy": "none"
              },
              {
                "type": "calculated",
                "name": "First Transaction Date",
                "dataType": "dateTime",
                "isDataTypeInferred": true,
                "expression": [
                  " date(left('Dim - Plant'[First Transaction DT], 4),",
                  "                         mid('Dim - Plant'[First Transaction DT], 5,2),",
                  "                        right('Dim - Plant'[First Transaction DT], 2))"
                ]
              },
              {
                "name": "LAST_TRX_DT",
                "dataType": "int64",
                "sourceColumn": "LAST_TRX_DT"
              },
              {
                "name": "XMAN Code",
                "dataType": "string",
                "sourceColumn": "XMAN Code"
              },
              {
                "name": "Plant Name",
                "dataType": "string",
                "sourceColumn": "Plant Name"
              },
              {
                "name": "Region Code",
                "dataType": "string",
                "sourceColumn": "Region Code"
              },
              {
                "type": "calculated",
                "name": "Tier (desc)",
                "dataType": "string",
                "isDataTypeInferred": true,
                "expression": " if(ISBLANK('Dim - Plant'[TIER]) = TRUE(), \"\", \"Tier \" & 'Dim - Plant'[TIER])"
              },
              {
                "type": "calculated",
                "name": "Sales area",
                "dataType": "string",
                "isDataTypeInferred": true,
                "expression": " if(ISBLANK('Dim - Plant'[Region Code]) = TRUE() || 'Dim - Plant'[Region Code] =\"\", \"\", \"Cụm \" &'Dim - Plant'[Region Code])"
              },
              {
                "name": "INDUSTRY",
                "dataType": "string",
                "sourceColumn": "INDUSTRY"
              },
              {
                "name": "Channel Plant Name",
                "dataType": "string",
                "sourceColumn": "Channel Plant Name"
              },
              {
                "name": "Short Name",
                "dataType": "string",
                "sourceColumn": "Short Name"
              },
              {
                "type": "calculated",
                "name": "Plant Name 1",
                "dataType": "string",
                "isDataTypeInferred": true,
                "expression": " 'Dim - Plant'[Plant Code] &\"_\" & 'Dim - Plant'[Plant Name]"
              },
              {
                "name": "BRANCH_DIRECTOR_NAME",
                "dataType": "string",
                "sourceColumn": "BRANCH_DIRECTOR_NAME"
              },
              {
                "name": "RSM_NAME",
                "dataType": "string",
                "sourceColumn": "RSM_NAME"
              },
              {
                "name": "ASM_NAME",
                "dataType": "string",
                "sourceColumn": "ASM_NAME"
              },
              {
                "name": "STORE_MANAGER_NAME",
                "dataType": "string",
                "sourceColumn": "STORE_MANAGER_NAME"
              },
              {
                "name": "Plant Kind",
                "dataType": "string",
                "sourceColumn": "Plant Kind"
              },
              {
                "name": "Sales District",
                "dataType": "string",
                "sourceColumn": "Sales District"
              },
              {
                "name": "BRANCH_DIRECTOR_CODE",
                "dataType": "string",
                "sourceColumn": "BRANCH_DIRECTOR_CODE"
              },
              {
                "name": "RSM_CODE",
                "dataType": "string",
                "sourceColumn": "RSM_CODE"
              },
              {
                "name": "ASM_CODE",
                "dataType": "string",
                "sourceColumn": "ASM_CODE"
              },
              {
                "name": "STORE_MANAGER_CODE",
                "dataType": "string",
                "sourceColumn": "STORE_MANAGER_CODE"
              },
              {
                "name": "SC_REGION_DESC",
                "dataType": "string",
                "sourceColumn": "SC_REGION_DESC"
              },
              {
                "name": "Company Code",
                "dataType": "string",
                "sourceColumn": "Company Code"
              },
              {
                "name": "Company Name",
                "dataType": "string",
                "sourceColumn": "Company Name"
              },
              {
                "name": "Palexy ID",
                "dataType": "int64",
                "sourceColumn": "Palexy ID"
              },
              {
                "name": "DATASOURCE_NUM_ID",
                "dataType": "int64",
                "sourceColumn": "DATASOURCE_NUM_ID"
              },
              {
                "name": "PLANT_CODE_NAME",
                "dataType": "string",
                "sourceColumn": "PLANT_CODE_NAME"
              },
              {
                "name": "ACTIVE_FLG",
                "dataType": "int64",
                "sourceColumn": "ACTIVE_FLG"
              }
            ],
            "partitions": [
              {
                "name": "Partition",
                "dataView": "full",
                "source": {
                  "type": "m",
                  "expression": [
                    "let",
                    "    Source = #\"SQL/192 168 3 31;PNJ_ROLAP\",",
                    "dbo_W_PLANT_D = Source{[Schema=\"dbo\",Item=\"W_VW_PLANT_D\"]}[Data],",
                    "    #\"Renamed Columns\" = Table.RenameColumns(dbo_W_PLANT_D,{{\"ADDRESS\", \"Address\"}, {\"PLANT_SHORT_NAME\", \"Short Name\"}, {\"PLANT_CODE\", \"Plant Code\"}, {\"PLANT_NAME\", \"Plant Name\"}, {\"HR_CODE\", \"HR Code\"}, {\"AREA\", \"Area\"}, {\"AREA_CODE\", \"Area Code\"}, {\"AREA_NAME\", \"Area Name\"}, {\"CHANNEL\", \"Channel\"}, {\"CHANNEL_NAME\", \"Channel Name\"}, {\"REGION\", \"Region\"}, {\"REGION_CODE\", \"Region Code\"}, {\"REGION_NAME\", \"Region Name\"}}),",
                    "    #\"Removed Columns\" = Table.RemoveColumns(#\"Renamed Columns\",{\"TENANT_ID\", \"EFFECTIVE_FROM_DT\", \"EFFECTIVE_TO_DT\", \"X_CUSTOM\", \"CHANGED_BY\", \"CHANGED_ON_DT\", \"CHANGED_AT\", \"CREATED_ON_DT\", \"CREATED_AT\", \"CREATED_BY\"}),",
                    "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Removed Columns\",{{\"Channel\", \"Channel Plant\"}, {\"Channel Name\", \"Channel Plant Name\"}}),",
                    "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Renamed Columns1\",{\"INTEGRATION_ID\", \"HR Code\", \"BUSINESS_REG_CODE\", \"BUSINESS_REG_DT\", \"PLANT_REF_CODE\", \"PLANT_PAR_CODE\", \"BU_GROUP\", \"TITLE\", \"DELETE_FLG\", \"COUNTRY\", \"SUB_REGION\"}),",
                    "    #\"Renamed Columns2\" = Table.RenameColumns(#\"Removed Columns1\",{{\"YEAR\", \"OPENED_YEAR\"}}),",
                    "    #\"Removed Columns2\" = Table.RemoveColumns(#\"Renamed Columns2\",{\"CHANGED_TIME\", \"GROUND_STATUS\", \"GROUND_ACREAGE\", \"GOLD_ACREAGE\", \"SILVER_ACREAGE\", \"WATCH_ACREAGE\", \"JEMMA_ACREAGE\", \"CUST_CLASS\", \"PHONE1\", \"PHONE2\", \"SALE_TERR_WID\", \"PLANT_CATEGORY\"}),",
                    "    #\"Renamed Columns3\" = Table.RenameColumns(#\"Removed Columns2\",{{\"SALES_DIST\", \"Sales District\"}, {\"SALES_DIST_NAME\", \"Sales District Name\"}}),",
                    "    #\"Removed Columns3\" = Table.RemoveColumns(#\"Renamed Columns3\",{\"SUMMARY_ACREAGE\"}),",
                    "    #\"Renamed Columns4\" = Table.RenameColumns(#\"Removed Columns3\",{{\"OPENED_DT\", \"Open Date\"}}),",
                    "    #\"Removed Columns4\" = Table.RemoveColumns(#\"Renamed Columns4\",{\"OPENED_YEAR\"}),",
                    "    #\"Renamed Columns5\" = Table.RenameColumns(#\"Removed Columns4\",{{\"DIST_CHANNEL\", \"Distribution Channel\"}}),",
                    "    #\"Removed Columns5\" = Table.RemoveColumns(#\"Renamed Columns5\",{\"DATE_KEY\", \"WARD\", \"STREET\", \"QUARTER\", \"MONTH\", \"SALES_GRP\"}),",
                    "    #\"Renamed Columns6\" = Table.RenameColumns(#\"Removed Columns5\",{{\"XMAN_CODE\", \"XMAN Code\"}}),",
                    "    #\"Removed Columns6\" = Table.RemoveColumns(#\"Renamed Columns6\",{\"PURCH_ORG\", \"Region Name\", \"SALES_ORG\", \"STATUS\", \"Address\"}),",
                    "    #\"Renamed Columns7\" = Table.RenameColumns(#\"Removed Columns6\",{{\"PLANT_TYPE\", \"Plant Type\"}, {\"FIRST_TRX_DT\", \"First Transaction DT\"}}),",
                    "    #\"Removed Columns7\" = Table.RemoveColumns(#\"Renamed Columns7\",{\"Area\", \"PLANT_TYPE_CHANGE\", \"Area Name\", \"Area Code\"}),",
                    "    #\"Renamed Columns8\" = Table.RenameColumns(#\"Removed Columns7\",{{\"PLANT_KIND\", \"Plant Kind\"}}),",
                    "    #\"Removed Columns8\" = Table.RemoveColumns(#\"Renamed Columns8\",{\"PLANT_TYPE_OLD\", \"PLANT_TYPE_NEW\", \"COMPANY_WID\", \"LATITUDE\", \"LONGITUDE\"}),",
                    "    #\"Renamed Columns9\" = Table.RenameColumns(#\"Removed Columns8\",{{\"ORG_CODE\", \"Company Code\"}, {\"ORG_SHORT_NAME\", \"Company Name\"}, {\"PALEXY_STORE_ID\", \"Palexy ID\"}})",
                    "in",
                    "    #\"Renamed Columns9\""
                  ]
                }
              }
            ],
            "measures": [
              {
                "name": "#Plant",
                "expression": " CALCULATE(DISTINCTCOUNT('Dim - Plant'[Plant Code]))",
                "formatString": "#,0"
              },
              {
                "name": "# Plant New",
                "expression": " CALCULATE(DISTINCTCOUNT('Dim - Plant'[Plant Code]),  FILTER('Dim - Plant', ISBLANK('Dim - Plant'[First Transaction Date]) = FALSE()),USERELATIONSHIP('Dim - Plant'[First Transaction DT], 'Dim - Time'[ROW_WID]))",
                "formatString": "#,0"
              },
              {
                "name": "..Plant (YTD)",
                "expression": " CALCULATE('Dim - Plant'[# Plant New],FILTER(ALL('Dim - Time'[Date]),'Dim - Time'[Date]<= Max('Dim - Time'[Date])))",
                "formatString": "#,0"
              }
            ]
          },
          {
            "name": "Dim - Program",
            "columns": [
              {
                "name": "PROGRAM_TYPE",
                "dataType": "string",
                "sourceColumn": "PROGRAM_TYPE"
              },
              {
                "name": "PROGRAM_NAME",
                "dataType": "string",
                "sourceColumn": "PROGRAM_NAME"
              },
              {
                "name": "DATE_KEY",
                "dataType": "double",
                "sourceColumn": "DATE_KEY",
                "formatString": "0",
                "summarizeBy": "none"
              },
              {
                "name": "DATASOURCE_NUM_ID",
                "dataType": "int64",
                "sourceColumn": "DATASOURCE_NUM_ID"
              },
              {
                "name": "ROW_WID",
                "dataType": "int64",
                "sourceColumn": "ROW_WID"
              },
              {
                "name": "COMPANY_WID",
                "dataType": "int64",
                "sourceColumn": "COMPANY_WID",
                "summarizeBy": "none"
              },
              {
                "name": "EFFECTIVE_FROM_DT",
                "dataType": "double",
                "sourceColumn": "EFFECTIVE_FROM_DT",
                "formatString": "0",
                "summarizeBy": "none"
              },
              {
                "name": "EFFECTIVE_TO_DT",
                "dataType": "double",
                "sourceColumn": "EFFECTIVE_TO_DT",
                "formatString": "0",
                "summarizeBy": "none"
              },
              {
                "name": "TIME",
                "dataType": "string",
                "sourceColumn": "TIME"
              },
              {
                "name": "PLANT_WID",
                "dataType": "int64",
                "sourceColumn": "PLANT_WID",
                "summarizeBy": "none"
              },
              {
                "name": "PROGRAM_CATEGORY",
                "dataType": "string",
                "sourceColumn": "PROGRAM_CATEGORY"
              },
              {
                "type": "calculated",
                "name": "CK_DL_SDate",
                "dataType": "string",
                "isDataTypeInferred": true,
                "expression": "left('Dim - Program'[EFFECTIVE_FROM_DT],4)-1&Right('Dim - Program'[EFFECTIVE_FROM_DT],4)",
                "summarizeBy": "none"
              },
              {
                "type": "calculated",
                "name": "Date From",
                "dataType": "string",
                "isDataTypeInferred": true,
                "expression": "left('Dim - Program'[TIME],10)"
              },
              {
                "type": "calculated",
                "name": "Date To",
                "dataType": "string",
                "isDataTypeInferred": true,
                "expression": "RIGHT('Dim - Program'[TIME],10)"
              },
              {
                "type": "calculated",
                "name": "Program Length",
                "dataType": "int64",
                "isDataTypeInferred": true,
                "expression": "DATEDIFF(date(left('Dim - Program'[EFFECTIVE_FROM_DT], 4), mid('Dim - Program'[EFFECTIVE_FROM_DT], 5,2), RIGHT('Dim - Program'[EFFECTIVE_FROM_DT], 2)), date(left('Dim - Program'[EFFECTIVE_TO_DT], 4), mid('Dim - Program'[EFFECTIVE_TO_DT], 5,2), RIGHT('Dim - Program'[EFFECTIVE_TO_DT], 2)),DAY) +1"
              },
              {
                "type": "calculated",
                "name": "MKT.Year",
                "dataType": "int64",
                "isDataTypeInferred": true,
                "expression": "Year([Date From])"
              },
              {
                "type": "calculated",
                "name": "CK_DL_EDate",
                "dataType": "string",
                "isDataTypeInferred": true,
                "expression": "left('Dim - Program'[EFFECTIVE_TO_DT],4)-1&Right('Dim - Program'[EFFECTIVE_TO_DT],4)"
              }
            ],
            "partitions": [
              {
                "name": "Partition",
                "dataView": "full",
                "source": {
                  "type": "m",
                  "expression": [
                    "let",
                    "    Source = Value.NativeQuery(#\"SQL/192 168 3 31;PNJ_ROLAP\",\"",
                    "   SELECT [DATASOURCE_NUM_ID]",
                    "      ,[ROW_WID]",
                    "      ,[COMPANY_WID]",
                    "      ,[PROGRAM_NAME]",
                    "      ,[EFFECTIVE_FROM_DT]",
                    "      ,[EFFECTIVE_TO_DT]",
                    "      ,[TIME]",
                    "      ,[PLANT_WID]",
                    "      ,[DATE_KEY]",
                    "      ,[PROGRAM_TYPE]",
                    "      ,[PROGRAM_CATEGORY]",
                    "  FROM [PNJ_ROLAP].[dbo].[W_VW_MARKETING_PROGRAM_D]\")",
                    "",
                    "in",
                    "    Source"
                  ]
                }
              }
            ],
            "measures": [
              {
                "name": "Length",
                "expression": " max('Dim - Program'[Program Length])"
              },
              {
                "name": "Length (LY)",
                "expression": [
                  " ",
                  "VAR LY = CALCULATE([Length],FILTER(",
                  "\tALL('Dim - Program'), ",
                  "\t'Dim - Program'[Program_Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\tVALUE('Dim - Program'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year])) - 1 )",
                  "\t)",
                  "VAR DIFF = [Length] - LY",
                  "RETURN IF (DIFF >0,DIFF & \" ngày\", if(DIFF<0, DIFF*-1 & \" ngày\", IF(diff =0, DIFF & \" ngày\")))"
                ]
              }
            ]
          },
          {
            "name": "Fact - Marketing Plan",
            "columns": [
              {
                "name": "COMPANY_WID",
                "dataType": "int64",
                "isHidden": true,
                "sourceColumn": "COMPANY_WID"
              },
              {
                "name": "PLANT_WID",
                "dataType": "int64",
                "isHidden": true,
                "sourceColumn": "PLANT_WID"
              },
              {
                "name": "DATE_KEY",
                "dataType": "int64",
                "isHidden": true,
                "sourceColumn": "DATE_KEY"
              },
              {
                "name": "PROGRAM_WID",
                "dataType": "int64",
                "sourceColumn": "PROGRAM_WID"
              },
              {
                "name": "TARGET_AMT",
                "dataType": "double",
                "isHidden": true,
                "sourceColumn": "TARGET_AMT"
              },
              {
                "name": "PRODUCT_WID",
                "dataType": "int64",
                "sourceColumn": "PRODUCT_WID"
              },
              {
                "type": "calculated",
                "name": "Program Category",
                "dataType": "string",
                "isDataTypeInferred": true,
                "isHidden": true,
                "expression": "RELATED('Dim - Program'[PROGRAM_CATEGORY])"
              },
              {
                "type": "calculated",
                "name": "MKT.Year",
                "dataType": "int64",
                "isDataTypeInferred": true,
                "expression": " RELATED('Dim - Program'[MKT.Year])"
              }
            ],
            "partitions": [
              {
                "name": "Partition",
                "dataView": "full",
                "source": {
                  "type": "m",
                  "expression": [
                    "let",
                    "    Source = Value.NativeQuery(#\"SQL/192 168 3 31;PNJ_ROLAP\",\"",
                    "    SELECT [COMPANY_WID]",
                    "      ,[PLANT_WID]",
                    "      ,[PRODUCT_WID]",
                    "      ,[DATE_KEY]",
                    "      ,[PROGRAM_WID]",
                    "      ,[TARGET_AMT]",
                    "  FROM [PNJ_ROLAP].[dbo].[W_VW_MARKETING_PLAN_F]\")",
                    "in ",
                    "    Source"
                  ]
                }
              }
            ],
            "measures": [
              {
                "name": ". Target Marketing",
                "expression": " CALCULATE(sum('Fact - Marketing Plan'[TARGET_AMT]))",
                "formatString": "#,0"
              },
              {
                "name": ". Target Maketing (Region)",
                "expression": " [. Target Marketing]/CALCULATE([. Target Marketing], all('Dim - Plant'))",
                "formatString": "0.0 %;-0.0 %;0.0 %"
              },
              {
                "name": ". Target Marketing (LY)",
                "expression": [
                  " CALCULATE(SUM('Fact - Marketing Plan'[TARGET_AMT]),",
                  "\tFILTER(All('Fact - Marketing Plan'),",
                  "\t 'Fact - Marketing Plan'[Program Category] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY]) &&",
                  "\tVALUE('Fact - Marketing Plan'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year])) -1",
                  ")",
                  ")",
                  ""
                ],
                "formatString": "#,0"
              }
            ]
          },
          {
            "name": "Dim - Territory",
            "columns": [
              {
                "name": "Country",
                "dataType": "string",
                "sourceColumn": "Country"
              },
              {
                "name": "Region",
                "dataType": "string",
                "sourceColumn": "Region"
              },
              {
                "name": "Sub region",
                "dataType": "string",
                "sourceColumn": "Sub region"
              },
              {
                "name": "SALES_REGION",
                "dataType": "string",
                "sourceColumn": "SALES_REGION"
              },
              {
                "name": "Province",
                "dataType": "string",
                "sourceColumn": "Province"
              },
              {
                "name": "Province EN",
                "dataType": "string",
                "sourceColumn": "Province EN"
              },
              {
                "name": "District EN",
                "dataType": "string",
                "sourceColumn": "District EN"
              },
              {
                "name": "District XMAN",
                "dataType": "string",
                "sourceColumn": "District XMAN"
              },
              {
                "name": "ROW_WID",
                "dataType": "int64",
                "isHidden": true,
                "sourceColumn": "ROW_WID"
              }
            ],
            "partitions": [
              {
                "name": "Partition",
                "dataView": "full",
                "source": {
                  "type": "m",
                  "expression": [
                    "let",
                    "    Source = #\"SQL/192 168 3 31;PNJ_ROLAP\",",
                    "    dbo_W_TERITORY_DH = Source{[Schema=\"dbo\",Item=\"W_TERITORY_DH\"]}[Data],",
                    "    #\"Removed Columns\" = Table.RemoveColumns(dbo_W_TERITORY_DH,{\"COUNTRY_CD\", \"REGION_CD\", \"SUB_REGION_CD\", \"PROVINCE_CD\", \"DISTRICT_CD\", \"INTEGRATION_ID\"}),",
                    "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"COUNTRY\", \"Country\"}, {\"REGION\", \"Region\"}, {\"SUB_REGION\", \"Sub region\"}, {\"PROVINCE\", \"Province\"}, {\"PROVINCE_EN\", \"Province EN\"}}),",
                    "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Renamed Columns\",{\"DISTRICT\"}),",
                    "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Removed Columns1\",{{\"DISTRICT_EN\", \"District EN\"}, {\"DISTRICT_XMAN\", \"District XMAN\"}})",
                    "in",
                    "    #\"Renamed Columns1\""
                  ]
                }
              }
            ]
          },
          {
            "name": "Dim - Channel",
            "columns": [
              {
                "name": "ROW_WID",
                "dataType": "int64",
                "sourceColumn": "ROW_WID"
              },
              {
                "name": "CHANNEL_CODE",
                "dataType": "string",
                "sourceColumn": "CHANNEL_CODE"
              },
              {
                "name": "CHANNEL_DESC",
                "dataType": "string",
                "sourceColumn": "CHANNEL_DESC"
              }
            ],
            "partitions": [
              {
                "name": "Partition",
                "dataView": "full",
                "source": {
                  "type": "m",
                  "expression": [
                    "let",
                    "    Source = #\"SQL/192 168 3 31;PNJ_ROLAP\",",
                    "    dbo_W_CHANNEL_DH = Source{[Schema=\"dbo\",Item=\"W_CHANNEL_DH\"]}[Data]",
                    "in",
                    "    dbo_W_CHANNEL_DH"
                  ]
                }
              }
            ]
          },
          {
            "name": "Fact - Sales Invoice Line",
            "columns": [
              {
                "name": "PRODUCT_WID",
                "dataType": "int64",
                "sourceColumn": "PRODUCT_WID"
              },
              {
                "name": "PLANT_WID",
                "dataType": "int64",
                "sourceColumn": "PLANT_WID"
              },
              {
                "name": "INVOICED_ON_DT_WID",
                "dataType": "int64",
                "sourceColumn": "INVOICED_ON_DT_WID"
              },
              {
                "name": "Program_wid",
                "dataType": "int64",
                "sourceColumn": "Program_wid"
              },
              {
                "name": "CHANNEL_CODE",
                "dataType": "string",
                "sourceColumn": "CHANNEL_CODE"
              },
              {
                "name": "CUSTOMER_SOLD_TO_WID",
                "dataType": "int64",
                "sourceColumn": "CUSTOMER_SOLD_TO_WID"
              },
              {
                "name": "Invoice Number",
                "dataType": "string",
                "sourceColumn": "Invoice Number"
              },
              {
                "name": "INVOICE_ITEM",
                "dataType": "string",
                "sourceColumn": "INVOICE_ITEM"
              },
              {
                "name": "Net Amount",
                "dataType": "double",
                "sourceColumn": "Net Amount"
              },
              {
                "name": "Discount Amount",
                "dataType": "double",
                "sourceColumn": "Discount Amount"
              },
              {
                "name": "Invoice Type",
                "dataType": "string",
                "sourceColumn": "Invoice Type"
              },
              {
                "name": "Qty",
                "dataType": "double",
                "sourceColumn": "Qty"
              },
              {
                "name": "Customer Type (Month)",
                "dataType": "string",
                "sourceColumn": "Customer Type (Month)"
              },
              {
                "name": "Customer Type (Year)",
                "dataType": "string",
                "sourceColumn": "Customer Type (Year)"
              },
              {
                "name": "Group Age",
                "dataType": "string",
                "sourceColumn": "Group Age"
              },
              {
                "name": "SALES_DEAL_NAME",
                "dataType": "string",
                "sourceColumn": "SALES_DEAL_NAME"
              },
              {
                "name": "DATE_KEY",
                "dataType": "string",
                "isHidden": true,
                "sourceColumn": "DATE_KEY"
              },
              {
                "name": "Program Name",
                "dataType": "string",
                "sourceColumn": "Program Name"
              },
              {
                "name": "Program Category",
                "dataType": "string",
                "sourceColumn": "Program Category"
              },
              {
                "name": "Program Type",
                "dataType": "string",
                "sourceColumn": "Program Type"
              },
              {
                "name": "REGION",
                "dataType": "string",
                "sourceColumn": "REGION"
              },
              {
                "name": "EFFECTIVE_FROM_DT",
                "dataType": "dateTime",
                "sourceColumn": "EFFECTIVE_FROM_DT"
              },
              {
                "name": "EFFECTIVE_TO_DT",
                "dataType": "dateTime",
                "sourceColumn": "EFFECTIVE_TO_DT"
              },
              {
                "name": "CUST_CARD_DESC",
                "dataType": "string",
                "sourceColumn": "CUST_CARD_DESC"
              },
              {
                "type": "calculated",
                "name": "ConditionID",
                "dataType": "string",
                "isDataTypeInferred": true,
                "isHidden": true,
                "expression": "'Fact - Sales Invoice Line'[INVOICED_ON_DT_WID]&\"_\"&'Fact - Sales Invoice Line'[Invoice Number] &\"_\"&'Fact - Sales Invoice Line'[INVOICE_ITEM]"
              },
              {
                "name": "SALES_DEAL",
                "dataType": "string",
                "sourceColumn": "SALES_DEAL"
              },
              {
                "name": "MKT_Customer",
                "dataType": "string",
                "sourceColumn": "MKT_CUSTOMER"
              },
              {
                "type": "calculated",
                "name": "Invoice date",
                "dataType": "dateTime",
                "isDataTypeInferred": true,
                "expression": " date(left('Fact - Sales Invoice Line'[INVOICED_ON_DT_WID], 4), mid('Fact - Sales Invoice Line'[INVOICED_ON_DT_WID], 5,2), RIGHT('Fact - Sales Invoice Line'[INVOICED_ON_DT_WID], 2))",
                "formatString": "yyyy-MM-dd",
                "annotations": [
                  {
                    "name": "Format",
                    "value": "<Format Format=\"DateTimeCustom\"><DateTimes><DateTime LCID=\"1033\" Group=\"ShortDate\" FormatString=\"yyyy-MM-dd\" /></DateTimes></Format>"
                  }
                ]
              },
              {
                "name": "PROGRAM_LENGTH",
                "dataType": "int64",
                "sourceColumn": "PROGRAM_LENGTH"
              },
              {
                "name": "VOUCHER",
                "dataType": "string",
                "sourceColumn": "VOUCHER"
              },
              {
                "name": "VOUCHER_DESC",
                "dataType": "string",
                "sourceColumn": "VOUCHER_DESC"
              },
              {
                "name": "MKT.Year",
                "dataType": "string",
                "sourceColumn": "MKT.Year"
              }
            ],
            "partitions": [
              {
                "name": "Fact - Sales Invoice Line_BF_2021",
                "source": {
                  "type": "m",
                  "expression": [
                    "let",
                    "    Source = Value.NativeQuery(#\"SQL/192 168 3 31;PNJ_ROLAP\",\"SELECT [INVOICE_NUM]",
                    "      ,[INVOICE_ITEM]",
                    "      ,[PRODUCT_WID]",
                    "      ,[PLANT_WID]",
                    "      ,[INVOICED_ON_DT_WID]",
                    "      ,[Program_wid]",
                    "      ,[NET_AMT]",
                    "      ,[DISCOUNT_AMT]",
                    "      ,[INVOICE_TYPE]",
                    "      ,[CHANNEL_CODE]",
                    "      ,[CUSTOMER_SOLD_TO_WID]",
                    "      ,[INVOICED_QTY]",
                    "      ,[CUST_TYPE_MONTH]",
                    "      ,[CUST_TYPE_YEAR]",
                    "      ,[Group_age]",
                    "      ,[SALES_DEAL]",
                    "      ,[SALES_DEAL_NAME]",
                    "      ,[DATE_KEY]",
                    "      ,[PROGRAM_NAME]",
                    "      ,[PROGRAM_CATEGORY]",
                    "      ,[PROGRAM_TYPE]",
                    "      ,[MKT_YEAR] [MKT.Year]",
                    "      ,[REGION]",
                    "",
                    "      ,[EFFECTIVE_FROM_DT]",
                    "      ,[EFFECTIVE_TO_DT]",
                    "      ,[VOUCHER]",
                    "      ,[VOUCHER_DESC]",
                    "      ,[CUST_CARD_DESC]",
                    "      ,[MKT_CUSTOMER]",
                    ", PROGRAM_LENGTH",
                    "  FROM [PNJ_ROLAP].[dbo].[W_VW_SALES_INVOICE_LINE_MAR_F]",
                    "  where [INVOICED_ON_DT_WID] <= 20201231\"),",
                    "     #\"Renamed Columns\" = Table.RenameColumns(#\"Source\",{{\"INVOICE_NUM\", \"Invoice Number\"}, {\"INVOICED_QTY\", \"Invoice Quantity\"}, {\"NET_AMT\", \"Net Amount\"}, {\"DISCOUNT_AMT\", \"Discount Amount\"},   {\"INVOICE_TYPE\", \"Invoice Type\"}}),",
                    "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Renamed Columns\",{ {\"CUST_TYPE_MONTH\", \"Customer Type (Month)\"}, {\"CUST_TYPE_YEAR\", \"Customer Type (Year)\"}}),",
                    "    #\"Renamed Columns3\" = Table.RenameColumns(#\"Renamed Columns1\",{ {\"Invoice Quantity\", \"Qty\"}}),",
                    "    #\"Replaced Value\" = Table.ReplaceValue(#\"Renamed Columns3\",null,\"#Not assign\",Replacer.ReplaceValue,{\"SALES_DEAL\"}),",
                    "    #\"Renamed Columns4\" = Table.RenameColumns(#\"Replaced Value\",{{\"PROGRAM_CATEGORY\", \"Program Category\"}, {\"PROGRAM_TYPE\", \"Program Type\"},  {\"PROGRAM_NAME\", \"Program Name\"}}),",
                    "    #\"Renamed Columns5\" = Table.RenameColumns(#\"Renamed Columns4\",{{\"Group_age\", \"Group Age\"}}),",
                    "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Renamed Columns5\",{{\"EFFECTIVE_TO_DT\", type date}, {\"EFFECTIVE_FROM_DT\", type date}}),",
                    "    #\"Filtered Rows\" = Table.SelectRows(#\"Changed Type\", each ([Invoice Type] <> \"ZRE\" and [Invoice Type] <> \"ZS2\" and [Invoice Type] <> \"ZPI\" ))",
                    "in",
                    "    #\"Filtered Rows\""
                  ]
                },
                "annotations": [
                  {
                    "name": "QueryEditorSerialization",
                    "value": [
                      "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>let",
                      "    Source = Value.NativeQuery(#\"SQL/192 168 3 31;PNJ_ROLAP\",\"SELECT [INVOICE_NUM]",
                      "      ,[INVOICE_ITEM]",
                      "      ,[PRODUCT_WID]",
                      "      ,[PLANT_WID]",
                      "      ,[INVOICED_ON_DT_WID]",
                      "      ,[Program_wid]",
                      "      ,[NET_AMT]",
                      "      ,[DISCOUNT_AMT]",
                      "      ,[INVOICE_TYPE]",
                      "      ,[CHANNEL_CODE]",
                      "      ,[CUSTOMER_SOLD_TO_WID]",
                      "      ,[INVOICED_QTY]",
                      "      ,[CUST_TYPE_MONTH]",
                      "      ,[CUST_TYPE_YEAR]",
                      "      ,[Group_age]",
                      "      ,[SALES_DEAL]",
                      "      ,[SALES_DEAL_NAME]",
                      "      ,[DATE_KEY]",
                      "      ,[PROGRAM_NAME]",
                      "      ,[PROGRAM_CATEGORY]",
                      "      ,[PROGRAM_TYPE]",
                      "      ,[MKT_YEAR] [MKT.Year]",
                      "      ,[REGION]",
                      "",
                      "      ,[EFFECTIVE_FROM_DT]",
                      "      ,[EFFECTIVE_TO_DT]",
                      "      ,[VOUCHER]",
                      "      ,[VOUCHER_DESC]",
                      "      ,[CUST_CARD_DESC]",
                      "      ,[MKT_CUSTOMER]",
                      ", PROGRAM_LENGTH",
                      "  FROM [PNJ_ROLAP].[dbo].[W_VW_SALES_INVOICE_LINE_MAR_F]",
                      "  where [INVOICED_ON_DT_WID] <= 20201231\"),",
                      "     #\"Renamed Columns\" = Table.RenameColumns(#\"Source\",{{\"INVOICE_NUM\", \"Invoice Number\"}, {\"INVOICED_QTY\", \"Invoice Quantity\"}, {\"NET_AMT\", \"Net Amount\"}, {\"DISCOUNT_AMT\", \"Discount Amount\"},   {\"INVOICE_TYPE\", \"Invoice Type\"}}),",
                      "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Renamed Columns\",{ {\"CUST_TYPE_MONTH\", \"Customer Type (Month)\"}, {\"CUST_TYPE_YEAR\", \"Customer Type (Year)\"}}),",
                      "    #\"Renamed Columns3\" = Table.RenameColumns(#\"Renamed Columns1\",{ {\"Invoice Quantity\", \"Qty\"}}),",
                      "    #\"Replaced Value\" = Table.ReplaceValue(#\"Renamed Columns3\",null,\"#Not assign\",Replacer.ReplaceValue,{\"SALES_DEAL\"}),",
                      "    #\"Renamed Columns4\" = Table.RenameColumns(#\"Replaced Value\",{{\"PROGRAM_CATEGORY\", \"Program Category\"}, {\"PROGRAM_TYPE\", \"Program Type\"},  {\"PROGRAM_NAME\", \"Program Name\"}}),",
                      "    #\"Renamed Columns5\" = Table.RenameColumns(#\"Renamed Columns4\",{{\"Group_age\", \"Group Age\"}}),",
                      "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Renamed Columns5\",{{\"EFFECTIVE_TO_DT\", type date}, {\"EFFECTIVE_FROM_DT\", type date}}),",
                      "    #\"Filtered Rows\" = Table.SelectRows(#\"Changed Type\", each ([Invoice Type] <> \"ZRE\" and [Invoice Type] <> \"ZS2\" and [Invoice Type] <> \"ZPI\" ))",
                      "in",
                      "    #\"Filtered Rows\"</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                    ]
                  }
                ]
              },
              {
                "name": "Partition",
                "mode": "import",
                "source": {
                  "type": "m",
                  "expression": [
                    "let",
                    "    Source = Value.NativeQuery(#\"SQL/192 168 3 31;PNJ_ROLAP\",\"SELECT [INVOICE_NUM]",
                    "      ,[INVOICE_ITEM]",
                    "      ,[PRODUCT_WID]",
                    "      ,[PLANT_WID]",
                    "      ,[INVOICED_ON_DT_WID]",
                    "      ,[Program_wid]",
                    "      ,[NET_AMT]",
                    "      ,[DISCOUNT_AMT]",
                    "      ,[INVOICE_TYPE]",
                    "      ,[CHANNEL_CODE]",
                    "      ,[CUSTOMER_SOLD_TO_WID]",
                    "      ,[INVOICED_QTY]",
                    "      ,[CUST_TYPE_MONTH]",
                    "      ,[CUST_TYPE_YEAR]",
                    "      ,[Group_age]",
                    "      ,[SALES_DEAL]",
                    "      ,[SALES_DEAL_NAME]",
                    "      ,[DATE_KEY]",
                    "      ,[PROGRAM_NAME]",
                    "      ,[PROGRAM_CATEGORY]",
                    "      ,[PROGRAM_TYPE]",
                    "      ,[MKT_YEAR] [MKT.Year]",
                    "      ,[REGION]",
                    "",
                    "      ,[EFFECTIVE_FROM_DT]",
                    "      ,[EFFECTIVE_TO_DT]",
                    "      ,[VOUCHER]",
                    "      ,[VOUCHER_DESC]",
                    "      ,[CUST_CARD_DESC]",
                    "      ,[MKT_CUSTOMER]",
                    ", PROGRAM_LENGTH",
                    "  FROM [PNJ_ROLAP].[dbo].[W_VW_SALES_INVOICE_LINE_MAR_F]",
                    "  where [INVOICED_ON_DT_WID] >= 20210101\"),",
                    "     #\"Renamed Columns\" = Table.RenameColumns(#\"Source\",{{\"INVOICE_NUM\", \"Invoice Number\"}, {\"INVOICED_QTY\", \"Invoice Quantity\"}, {\"NET_AMT\", \"Net Amount\"}, {\"DISCOUNT_AMT\", \"Discount Amount\"},   {\"INVOICE_TYPE\", \"Invoice Type\"}}),",
                    "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Renamed Columns\",{ {\"CUST_TYPE_MONTH\", \"Customer Type (Month)\"}, {\"CUST_TYPE_YEAR\", \"Customer Type (Year)\"}}),",
                    "    #\"Renamed Columns3\" = Table.RenameColumns(#\"Renamed Columns1\",{ {\"Invoice Quantity\", \"Qty\"}}),",
                    "    #\"Replaced Value\" = Table.ReplaceValue(#\"Renamed Columns3\",null,\"#Not assign\",Replacer.ReplaceValue,{\"SALES_DEAL\"}),",
                    "    #\"Renamed Columns4\" = Table.RenameColumns(#\"Replaced Value\",{{\"PROGRAM_CATEGORY\", \"Program Category\"}, {\"PROGRAM_TYPE\", \"Program Type\"},  {\"PROGRAM_NAME\", \"Program Name\"}}),",
                    "    #\"Renamed Columns5\" = Table.RenameColumns(#\"Renamed Columns4\",{{\"Group_age\", \"Group Age\"}}),",
                    "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Renamed Columns5\",{{\"EFFECTIVE_TO_DT\", type date}, {\"EFFECTIVE_FROM_DT\", type date}}),",
                    "    #\"Filtered Rows\" = Table.SelectRows(#\"Changed Type\", each ([Invoice Type] <> \"ZRE\" and [Invoice Type] <> \"ZS2\" and [Invoice Type] <> \"ZPI\" ))",
                    "in",
                    "    #\"Filtered Rows\""
                  ]
                },
                "annotations": [
                  {
                    "name": "QueryEditorSerialization",
                    "value": [
                      "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>let",
                      "    Source = Value.NativeQuery(#\"SQL/192 168 3 31;PNJ_ROLAP\",\"SELECT [INVOICE_NUM]",
                      "      ,[INVOICE_ITEM]",
                      "      ,[PRODUCT_WID]",
                      "      ,[PLANT_WID]",
                      "      ,[INVOICED_ON_DT_WID]",
                      "      ,[Program_wid]",
                      "      ,[NET_AMT]",
                      "      ,[DISCOUNT_AMT]",
                      "      ,[INVOICE_TYPE]",
                      "      ,[CHANNEL_CODE]",
                      "      ,[CUSTOMER_SOLD_TO_WID]",
                      "      ,[INVOICED_QTY]",
                      "      ,[CUST_TYPE_MONTH]",
                      "      ,[CUST_TYPE_YEAR]",
                      "      ,[Group_age]",
                      "      ,[SALES_DEAL]",
                      "      ,[SALES_DEAL_NAME]",
                      "      ,[DATE_KEY]",
                      "      ,[PROGRAM_NAME]",
                      "      ,[PROGRAM_CATEGORY]",
                      "      ,[PROGRAM_TYPE]",
                      "      ,[MKT_YEAR] [MKT.Year]",
                      "      ,[REGION]",
                      "",
                      "      ,[EFFECTIVE_FROM_DT]",
                      "      ,[EFFECTIVE_TO_DT]",
                      "      ,[VOUCHER]",
                      "      ,[VOUCHER_DESC]",
                      "      ,[CUST_CARD_DESC]",
                      "      ,[MKT_CUSTOMER]",
                      ", PROGRAM_LENGTH",
                      "  FROM [PNJ_ROLAP].[dbo].[W_VW_SALES_INVOICE_LINE_MAR_F]",
                      "  where [INVOICED_ON_DT_WID] >= 20210101\"),",
                      "     #\"Renamed Columns\" = Table.RenameColumns(#\"Source\",{{\"INVOICE_NUM\", \"Invoice Number\"}, {\"INVOICED_QTY\", \"Invoice Quantity\"}, {\"NET_AMT\", \"Net Amount\"}, {\"DISCOUNT_AMT\", \"Discount Amount\"},   {\"INVOICE_TYPE\", \"Invoice Type\"}}),",
                      "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Renamed Columns\",{ {\"CUST_TYPE_MONTH\", \"Customer Type (Month)\"}, {\"CUST_TYPE_YEAR\", \"Customer Type (Year)\"}}),",
                      "    #\"Renamed Columns3\" = Table.RenameColumns(#\"Renamed Columns1\",{ {\"Invoice Quantity\", \"Qty\"}}),",
                      "    #\"Replaced Value\" = Table.ReplaceValue(#\"Renamed Columns3\",null,\"#Not assign\",Replacer.ReplaceValue,{\"SALES_DEAL\"}),",
                      "    #\"Renamed Columns4\" = Table.RenameColumns(#\"Replaced Value\",{{\"PROGRAM_CATEGORY\", \"Program Category\"}, {\"PROGRAM_TYPE\", \"Program Type\"},  {\"PROGRAM_NAME\", \"Program Name\"}}),",
                      "    #\"Renamed Columns5\" = Table.RenameColumns(#\"Renamed Columns4\",{{\"Group_age\", \"Group Age\"}}),",
                      "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Renamed Columns5\",{{\"EFFECTIVE_TO_DT\", type date}, {\"EFFECTIVE_FROM_DT\", type date}}),",
                      "    #\"Filtered Rows\" = Table.SelectRows(#\"Changed Type\", each ([Invoice Type] <> \"ZRE\" and [Invoice Type] <> \"ZS2\" and [Invoice Type] <> \"ZPI\" ))",
                      "in",
                      "    #\"Filtered Rows\"</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                    ]
                  }
                ]
              }
            ],
            "measures": [
              {
                "name": ". MKT Net Amt (LY)",
                "expression": [
                  " CALCULATE([. Net Amt], ",
                  "FILTER(",
                  "ALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[PLANT KIND],'Fact - Sales Invoice Line'[Customer Type (Month)],'Fact - Sales Invoice Line'[Customer Type (Year)],  'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand], 'Dim - Customer'[CUST_CARD_DESC], 'Dim - Plant'[PLANT NAME],'Fact - Sales Invoice Line'[Group Age], 'Dim - Plant'[Sales District Name], 'Dim - Customer'[Gender], 'Dim - Plant'[Tier], 'Fact - Sales Invoice Line'[MKT_Customer], 'Fact - Sales Invoice Line'[CUST_CARD_DESC],  'Dim - Plant'[Plant Name 1] ) ,",
                  " 'Fact - Sales Invoice Line'[Program Category] = SELECTEDVALUE( 'Dim - Program'[Program_Category] )  &&",
                  "VALUE('Fact - Sales Invoice Line'[MKT.YEAR]) = value(SELECTEDVALUE('Dim - Program'[MKT.Year])) - 1 &&",
                  " 'Fact - Sales Invoice Line'[Program Category] <> BLANK()))",
                  "",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "% MKT Net Amt/Store (LY)",
                "expression": " CALCULATE([AVG Net Amt/Store]/ [MKT Net Amt/Store (LY)]-1)",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "% MKT Net Amt/Store (CK)",
                "expression": " CALCULATE([AVG Net Amt/Store]/ [MKT Net Amt/Store (CK)]-1)",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "% MKT Active Plant (CK)",
                "expression": " CALCULATE([# Active Plant]/[# MKT Active Plant (CK)]-1)",
                "formatString": "0.0 %;-0.0 %;0.0 %"
              },
              {
                "name": "MKT Net Amt/Store (LY)",
                "expression": " CALCULATE([. MKT Net Amt (LY)]/[# MKT Active Plant (LY)])",
                "formatString": "#,0"
              },
              {
                "name": "% MKT Net Amt/Qty (CK)",
                "expression": " CALCULATE([AVG Net Amt/Qty (In)]/[AVG MKT Net Amt/Qty (CK)]-1)",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "% MKT Cust Transaction (CK)",
                "expression": " CALCULATE([# Cust Transaction (PC)]/ [# MKT Cust Transaction (CK)]-1)",
                "formatString": "0.0 %;-0.0 %;0.0 %"
              },
              {
                "name": "% MKT Cust Transaction (LY)",
                "expression": " CALCULATE([# Cust Transaction (PC)]/ [# MKT Cust Transaction (LY)]-1)",
                "formatString": "0.0 %;-0.0 %;0.0 %"
              },
              {
                "name": "% MKT Customer/Store/Day (CK)",
                "expression": " CALCULATE([AVG Customer/Store/Day]/ [AVG MKT Customer/Store (CK)]-1)",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "% MKT Net Qty (CK)",
                "expression": " CALCULATE([. Net Qty]/[. MKT Net Qty (CK)] -1)",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "AVG MKT Net Amt/Qty (CK)",
                "expression": " CALCULATE([. MKT Net Amt (CK)]/[. MKT Net Qty (CK)])",
                "formatString": "#,0"
              },
              {
                "name": "AVG MKT Customer/Store/Day (LY)",
                "expression": [
                  " ",
                  "\tCALCULATE([AVG Customer/Store/Day],",
                  "\tFILTER(ALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[TIER], 'Dim - Plant'[PLANT KIND], 'Fact - Sales Invoice Line'[Customer Type (Month)],",
                  "\t'Fact - Sales Invoice Line'[Customer Type (Year)], 'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand],'Dim - Customer'[CUST_CARD_DESC],'Dim - Plant'[Plant Code], 'Dim - Plant'[PLANT NAME], 'Dim - Plant'[Sales District Name], 'Fact - Sales Invoice Line'[Group Age],  'Dim - Plant'[Plant Name 1] ),",
                  "\t'Fact - Sales Invoice Line'[Program Category] = SELECTEDVALUE('Fact - Sales Invoice Line'[PROGRAM CATEGORY]) &&",
                  "\tVALUE('Fact - Sales Invoice Line'[MKT.YEAR]) = value(SELECTEDVALUE('Dim - Program'[MKT.Year])) - 1 &&",
                  "\t 'Fact - Sales Invoice Line'[Program Category] <> BLANK()))",
                  ""
                ],
                "formatString": "#,0.00"
              },
              {
                "name": "% Net Amt (LY)",
                "expression": [
                  " CALCULATE([. Net Amt]/[. Net Amt (LY)]-1,",
                  "USERELATIONSHIP('Dim - Time'[Date], 'Fact - Sales Invoice Line'[Invoice Date]))",
                  ""
                ],
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "% MKT Net Amt (LY)",
                "expression": [
                  " CALCULATE([. Net Amt]/[. MKT Net Amt (LY)] -1)",
                  ""
                ],
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "AVG Net Amt/Day",
                "expression": [
                  " CALCULATE([. Net Amt]/ DISTINCTCOUNT('Fact - Sales Invoice Line'[INVOICED_ON_DT_WID]))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "% MKT Net Qty (LY)",
                "expression": " CALCULATE([. Net Qty]/[. MKT Net Qty (LY)] -1)",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": ". MKT Net Qty (LY)",
                "expression": [
                  " CALCULATE([. Net Qty],",
                  "FILTER(",
                  "ALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[TIER], 'Dim - Plant'[PLANT KIND],'Fact - Sales Invoice Line'[Customer Type (Month)],'Fact - Sales Invoice Line'[Customer Type (Year)], 'Dim - Customer'[GENDER], 'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand],'Dim - Customer'[CUST_CARD_DESC],'Dim - Plant'[Plant Code], 'Dim - Plant'[PLANT NAME], 'Dim - Plant'[Sales District Name], 'Fact - Sales Invoice Line'[Group Age],  'Dim - Plant'[Plant Name 1] ),",
                  " 'Fact - Sales Invoice Line'[Program Category] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY]) &&",
                  " VALUE('Fact - Sales Invoice Line'[MKT.YEAR]) = value(SELECTEDVALUE('Dim - Program'[MKT.Year])) - 1 &&",
                  " 'Fact - Sales Invoice Line'[Program Category] <> BLANK()))"
                ],
                "formatString": "#,0"
              },
              {
                "name": "# MKT Customer (LY)",
                "expression": [
                  " CALCULATE([# Customer],",
                  "FILTER(",
                  "ALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[TIER], 'Dim - Plant'[PLANT KIND], 'Fact - Sales Invoice Line'[Customer Type (Month)],'Fact - Sales Invoice Line'[Customer Type (Year)], 'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand],'Dim - Customer'[CUST_CARD_DESC],'Dim - Plant'[Plant Code], 'Dim - Plant'[PLANT NAME], 'Dim - Plant'[Sales District Name], 'Fact - Sales Invoice Line'[Group Age], 'Dim - Customer'[GENDER], 'Fact - Sales Invoice Line'[CUST_CARD_DESC], 'Fact - Sales Invoice Line'[MKT_Customer],  'Dim - Plant'[Plant Name 1] ),",
                  " 'Fact - Sales Invoice Line'[Program Category] = SELECTEDVALUE('Fact - Sales Invoice Line'[PROGRAM CATEGORY]) &&",
                  "VALUE('Fact - Sales Invoice Line'[MKT.YEAR]) = value(SELECTEDVALUE('Dim - Program'[MKT.Year])) - 1 &&",
                  " 'Fact - Sales Invoice Line'[Program Category] <> BLANK())",
                  " )",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "% MKT Customer (LY)",
                "expression": " CALCULATE([# Customer]/[# MKT Customer (LY)] -1)",
                "formatString": "0.0 %;-0.0 %;0.0 %"
              },
              {
                "name": "# MKT Cust Transaction (LY)",
                "expression": [
                  " CALCULATE([# Cust Transaction (PC)],",
                  "FILTER(",
                  "ALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[PLANT KIND],'Fact - Sales Invoice Line'[Customer Type (Month)],'Fact - Sales Invoice Line'[Customer Type (Year)],  'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand], 'Dim - Customer'[CUST_CARD_DESC], 'Dim - Plant'[PLANT NAME],'Fact - Sales Invoice Line'[Group Age], 'Dim - Plant'[Sales District Name], 'Dim - Customer'[Gender], 'Dim - Plant'[Tier], 'Fact - Sales Invoice Line'[MKT_Customer], 'Fact - Sales Invoice Line'[CUST_CARD_DESC],  'Dim - Plant'[Plant Name 1] ),",
                  "",
                  " 'Fact - Sales Invoice Line'[Program Category] = SELECTEDVALUE('Fact - Sales Invoice Line'[PROGRAM CATEGORY]) &&",
                  "VALUE('Fact - Sales Invoice Line'[MKT.YEAR]) = value(SELECTEDVALUE('Dim - Program'[MKT.Year])) - 1 &&",
                  " 'Fact - Sales Invoice Line'[Program Category] <> BLANK()))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "% MKT Ticket Size (LY)",
                "expression": " CALCULATE([AVG Ticket Size]/[AVG MKT Ticket Size (LY)]-1)",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "AVG Ticket Size",
                "expression": [
                  " CALCULATE([. Net Amt]/[# Cust Transaction (PC)],",
                  "FILTER('Dim - Customer', NOT 'Dim - Customer'[CUST_CARD_DESC] in {\"One-time\"})",
                  ")"
                ],
                "formatString": "#,0"
              },
              {
                "name": "AVG Ticket Size (LY)",
                "expression": " CALCULATE([. Net Amt (LY)]/[# Cust Transaction (PC) (LY)] )",
                "formatString": "#,0"
              },
              {
                "name": "AVG MKT Ticket Size (LY)",
                "expression": " CALCULATE([. MKT Net Amt (LY)]/[# MKT Cust Transaction (LY)])",
                "formatString": "#,0"
              },
              {
                "name": "% Ticket Size (LY)",
                "expression": " CALCULATE([AVG Ticket Size]/[AVG Ticket Size (LY)]-1)",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "AVG MKT Qty/Bill (LY)",
                "expression": " CALCULATE([. MKT Net Qty (LY)]/[# MKT Bill (LY)])",
                "formatString": "#,0.00"
              },
              {
                "name": "# MKT Bill (LY)",
                "expression": [
                  " CALCULATE([# Bill],FILTER(",
                  "ALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[PLANT KIND],'Fact - Sales Invoice Line'[Customer Type (Month)],'Fact - Sales Invoice Line'[Customer Type (Year)],  'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand], 'Dim - Customer'[CUST_CARD_DESC], 'Dim - Plant'[PLANT NAME],'Fact - Sales Invoice Line'[Group Age], 'Dim - Plant'[Sales District Name], 'Dim - Customer'[Gender], 'Dim - Plant'[Tier], 'Fact - Sales Invoice Line'[MKT_Customer], 'Fact - Sales Invoice Line'[CUST_CARD_DESC],  'Dim - Plant'[Plant Name 1] ), ",
                  "'Fact - Sales Invoice Line'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "VALUE('Fact - Sales Invoice Line'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year])) - 1 &&",
                  "  'Fact - Sales Invoice Line'[Program Category] <> BLANK()))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "# Bill",
                "expression": " CALCULATE(DISTINCTCOUNT('Fact - Sales Invoice Line'[Invoice Number]), FILTER('Fact - Sales Invoice Line', 'Fact - Sales Invoice Line'[Invoice Type] <> \"ZRE\" &&'Fact - Sales Invoice Line'[INVOICE TYPE] <> \"ZS2\" && 'Fact - Sales Invoice Line'[INVOICE TYPE]<> \"ZPI\"))",
                "formatString": "#,0"
              },
              {
                "name": "AVG Net Amt/Bill",
                "expression": " CALCULATE([. Net Amt]/[# Bill])",
                "formatString": "#,0"
              },
              {
                "name": "% Qty/Bill (LY)",
                "expression": " CALCULATE([AVG Qty/Bill]/[AVG Qty/Bill (LY)]-1)",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "AVG Qty/Bill",
                "expression": " CALCULATE([. Net Qty]/[# Bill])",
                "formatString": "#,0.00"
              },
              {
                "name": "AVG Qty/Bill (LY)",
                "expression": " CALCULATE([. Net Qty (LY)]/[# Bill (LY)])",
                "formatString": "#,0.00"
              },
              {
                "name": "# Bill (LY)",
                "expression": [
                  "CALCULATE([# Bill], DATEADD('Dim - Time'[Date], -1, YEAR),  ALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[PLANT KIND],'Fact - Sales Invoice Line'[Customer Type (Month)],'Fact - Sales Invoice Line'[Customer Type (Year)],  'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand], 'Dim - Customer'[CUST_CARD_DESC], 'Dim - Plant'[PLANT NAME],'Fact - Sales Invoice Line'[Group Age], 'Dim - Plant'[Sales District Name], 'Dim - Customer'[Gender], 'Dim - Plant'[Tier], 'Fact - Sales Invoice Line'[MKT_Customer], 'Fact - Sales Invoice Line'[CUST_CARD_DESC], 'Dim - Plant'[Plant Name 1] ))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": ". Net Qty",
                "expression": " CALCULATE(sum('Fact - Sales Invoice Line'[Qty]),FILTER('Fact - Sales Invoice Line', 'Fact - Sales Invoice Line'[Invoice Type] <> \"ZRE\" &&'Fact - Sales Invoice Line'[INVOICE TYPE] <> \"ZS2\" && 'Fact - Sales Invoice Line'[INVOICE TYPE]<> \"ZPI\"))",
                "formatString": "#,0"
              },
              {
                "name": ". Net Qty (LY)",
                "expression": [
                  " CALCULATE([. Net Qty], DATEADD('Dim - Time'[Date], -1, YEAR),  ",
                  "ALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[PLANT KIND],'Fact - Sales Invoice Line'[Customer Type (Month)],'Fact - Sales Invoice Line'[Customer Type (Year)],  'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand], 'Dim - Customer'[CUST_CARD_DESC], 'Dim - Plant'[PLANT NAME],'Fact - Sales Invoice Line'[Group Age], 'Dim - Plant'[Sales District Name], 'Dim - Customer'[Gender], 'Dim - Plant'[Tier], 'Fact - Sales Invoice Line'[MKT_Customer],  'Dim - Plant'[Plant Name 1] ))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "% MKT Qty/Bill (LY)",
                "expression": " CALCULATE([AVG Qty/Bill]/[AVG MKT Qty/Bill (LY)]-1)",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "AVG Net Amt/Bill (LY)",
                "expression": " CALCULATE([. Net Amt (LY)]/[# Bill (LY)])",
                "formatString": "#,0"
              },
              {
                "name": "AVG MKT Net Amt/Bill (LY)",
                "expression": " CALCULATE([. MKT Net Amt (LY)]/[# MKT Bill (LY)])",
                "formatString": "#,0"
              },
              {
                "name": "AVG Net Amt/Store",
                "expression": " CALCULATE([. Net Amt]/[# Active Plant])",
                "formatString": "#,0"
              },
              {
                "name": "AVG Customer/Store",
                "expression": " CALCULATE([# Customer]/[# Active Plant])",
                "formatString": "#,0.00"
              },
              {
                "name": "AVG Net Amt/Store/Day",
                "expression": " CALCULATE([AVG Net Amt/Store]/DISTINCTCOUNT('Fact - Sales Invoice Line'[INVOICED_ON_DT_WID]))",
                "formatString": "#,0"
              },
              {
                "name": "AVG Customer/Store/Day",
                "expression": " CALCULATE([AVG Customer/Store]/ DISTINCTCOUNT('Fact - Sales Invoice Line'[INVOICED_ON_DT_WID]))",
                "formatString": "#,0"
              },
              {
                "name": "# MKT Active Plant (LY)",
                "expression": [
                  " CALCULATE([# Active Plant], FILTER(",
                  "ALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[PLANT KIND],'Fact - Sales Invoice Line'[Customer Type (Month)],'Fact - Sales Invoice Line'[Customer Type (Year)],  'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand], 'Dim - Customer'[CUST_CARD_DESC], 'Dim - Plant'[PLANT NAME],'Fact - Sales Invoice Line'[Group Age], 'Dim - Plant'[Sales District Name], 'Dim - Customer'[Gender], 'Dim - Plant'[Tier], 'Fact - Sales Invoice Line'[MKT_Customer], 'Fact - Sales Invoice Line'[CUST_CARD_DESC],  'Dim - Plant'[Plant Name 1] ),",
                  "\t'Fact - Sales Invoice Line'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\tVALUE('Fact - Sales Invoice Line'[MKT.YEAR]) = value(SELECTEDVALUE('Dim - Program'[MKT.Year])) - 1))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "% MKT Active Plant (LY)",
                "expression": " CALCULATE([# Active Plant]/[# MKT Active Plant (LY)]-1)",
                "formatString": "0.0 %;-0.0 %;0.0 %"
              },
              {
                "name": "Day",
                "expression": "CALCULATE(DISTINCTCOUNT('Fact - Sales Invoice Line'[INVOICED_ON_DT_WID]))"
              },
              {
                "name": "AVG MKT Net Amt/Day (LY)",
                "expression": [
                  " CALCULATE([AVG Net Amt/Day],FILTER(ALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[TIER], 'Dim - Plant'[PLANT KIND],",
                  "\t 'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand],",
                  "\t 'Dim - Plant'[Plant Code], 'Dim - Plant'[PLANT NAME], 'Dim - Plant'[Sales District Name]), ",
                  "\t'Fact - Sales Invoice Line'[Program Category] = SELECTEDVALUE( 'Dim - Program'[Program_Category]) &&",
                  "\tVALUE('Fact - Sales Invoice Line'[MKT.YEAR]) = value(SELECTEDVALUE('Dim - Program'[MKT.Year])) - 1))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "% MKT Net Amt/Day (LY)",
                "expression": " CALCULATE([AVG Net Amt/Day]/[AVG MKT Net Amt/Day (LY)]-1)",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "% Net Amt/Bill (LY)",
                "expression": " CALCULATE([AVG Net Amt/Bill]/[AVG Net Amt/Bill (LY)]-1)",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "% MKT Net Amt/Bill (LY)",
                "expression": " CALCULATE([AVG Net Amt/Bill]/[AVG MKT Net Amt/Bill (LY)]-1)",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "AVG Net Amt/Qty (In)",
                "expression": " CALCULATE([. Net Amt]/[. Net Qty], 'Fact - Sales Invoice Line'[Program Type] = \"2. Trong CT\")",
                "formatString": "#,0"
              },
              {
                "name": "AVG Net Amt/Qty (LY)",
                "expression": " CALCULATE([. Net Amt (LY)]/[. Net Qty (LY)])",
                "formatString": "#,0"
              },
              {
                "name": "AVG MKT Net Amt/Qty (LY)",
                "expression": " CALCULATE([. MKT Net Amt (LY)]/[. MKT Net Qty (LY)])",
                "formatString": "#,0"
              },
              {
                "name": "% MKT Net Amt/Qty (LY)",
                "expression": " CALCULATE([AVG Net Amt/Qty (In)]/[AVG MKT Net Amt/Qty (LY)]-1)",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "% Net Amt/Qty (LY)",
                "expression": " CALCULATE([AVG Net Amt/Qty (In)]/[AVG Net Amt/Qty (LY)]-1)",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "AVG Net Amt/Qty (before)",
                "expression": " CALCULATE([. Net Amt]/[. Net Qty], 'Fact - Sales Invoice Line'[Program Type] = \"1. Trước CT\")",
                "formatString": "#,0"
              },
              {
                "name": "% Net Amt/Qty (B4)",
                "expression": " CALCULATE([AVG Net Amt/Qty (In)]/[AVG Net Amt/Qty (before)]-1)",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "Date Lost Customer",
                "expression": [
                  "",
                  "CALCULATE (       ",
                  "    EOMONTH ( MAX ( 'Fact - Sales Invoice Line'[Invoice Date]),24), ",
                  "    REMOVEFILTERS ('Dim - Time') ",
                  ")"
                ]
              },
              {
                "name": ". MKT Net Amt",
                "expression": [
                  "CALCULATE([. Net Amt], ",
                  "FILTER(",
                  "\tALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[TIER], 'Dim - Plant'[PLANT KIND],'Fact - Sales Invoice Line'[Customer Type (Month)],'Fact - Sales Invoice Line'[Customer Type (Year)],  'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand],'Dim - Customer'[CUST_CARD_DESC], 'Dim - Plant'[PLANT NAME],'Fact - Sales Invoice Line'[Group Age], 'Dim - Plant'[Sales District Name], 'Fact - Sales Invoice Line'[CUST_CARD_DESC], 'Dim - Customer'[GENDER],  'Dim - Plant'[Plant Name 1] ),",
                  " 'Fact - Sales Invoice Line'[Program Category] = SELECTEDVALUE( 'Dim - Program'[Program_Category] )  &&",
                  "VALUE('Fact - Sales Invoice Line'[MKT.YEAR]) = value(SELECTEDVALUE('Dim - Program'[MKT.Year])) &&",
                  " 'Fact - Sales Invoice Line'[Program Category] <> BLANK()))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "All Customer",
                "expression": [
                  " CALCULATE([# Customer],",
                  "    ALL('Dim - Product'),",
                  "    ALL('Dim - Plant'),",
                  "    ALL('Fact - Sales Invoice Line'),",
                  "    FILTER('Dim - Program', VALUE('Dim - Program'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year])) &&",
                  "    'Dim - Program'[PROGRAM_CATEGORY] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY])",
                  "),",
                  "   FILTER('Dim - Customer', NOT 'Dim - Customer'[CUST_CARD_DESC] IN {\"One-time\", \"Payer\"})",
                  ")"
                ],
                "formatString": "#,0"
              },
              {
                "name": "# MKT Cust Transaction (CK)",
                "expression": [
                  " \t",
                  " /*",
                  "    VAR CK_SDate0 = CALCULATE(VALUES('Dim - Program'[CK_DL_Sdate]),",
                  "\t\tFilter('Dim - Program', 'Dim - Program'[PROGRAM_CATEGORY] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY])",
                  "\t\t\t&& 'Dim - Program'[MKT.Year] = SELECTEDVALUE('Dim - Program'[MKT.Year])))",
                  "\t\t\t",
                  "\t--VAR CK_EDate = VALUE(FORMAT(DATEADD(LASTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1, YEAR), \"yyyymmdd\"))",
                  "*/",
                  "    VAR CK_SDate = DATEADD(FIRSTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1,YEAR)",
                  "    VAR CK_EDate = DATEADD(LASTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1, YEAR)",
                  "\tRETURN CALCULATE( [# Cust Transaction (PC)],",
                  "\t\tALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[PLANT KIND],'Fact - Sales Invoice Line'[Customer Type (Month)],'Fact - Sales Invoice Line'[Customer Type (Year)],  'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand], 'Dim - Customer'[CUST_CARD_DESC], 'Dim - Plant'[PLANT NAME],'Fact - Sales Invoice Line'[Group Age], 'Dim - Plant'[Sales District Name], 'Dim - Customer'[Gender], 'Dim - Plant'[Tier], 'Fact - Sales Invoice Line'[MKT_Customer], 'Fact - Sales Invoice Line'[CUST_CARD_DESC], 'Dim - Plant'[Plant Name 1] ),",
                  "\t\tFILTER('Dim - Time', 'Dim - Time'[Date] >= CK_SDate &&",
                  "\t\t\t'Dim - Time'[Date]  <= CK_EDate))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "% MKT Net Amt (CK)",
                "expression": "\tDIVIDE([. Net Amt], [. MKT Net Amt (CK)], 0) -1",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": ". MKT Net Amt (CK)",
                "expression": [
                  " ",
                  " /*",
                  "    VAR CK_SDate0 = CALCULATE(VALUES('Dim - Program'[CK_DL_Sdate]),",
                  "\t\tFilter('Dim - Program', 'Dim - Program'[PROGRAM_CATEGORY] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY])",
                  "\t\t\t&& 'Dim - Program'[MKT.Year] = SELECTEDVALUE('Dim - Program'[MKT.Year])))",
                  "\t\t\t",
                  "\t--VAR CK_EDate = VALUE(FORMAT(DATEADD(LASTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1, YEAR), \"yyyymmdd\"))",
                  "*/",
                  "    VAR CK_SDate = DATEADD(FIRSTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1,YEAR)",
                  "    VAR CK_EDate = DATEADD(LASTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1, YEAR)\t\t\t",
                  "\tRETURN CALCULATE([. Net Amt], ",
                  "\t\tALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[PLANT KIND],'Fact - Sales Invoice Line'[Customer Type (Month)],'Fact - Sales Invoice Line'[Customer Type (Year)],  'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand], 'Dim - Customer'[CUST_CARD_DESC], 'Dim - Plant'[PLANT NAME],'Fact - Sales Invoice Line'[Group Age], 'Dim - Plant'[Sales District Name], 'Dim - Customer'[Gender], 'Dim - Plant'[Tier], 'Fact - Sales Invoice Line'[MKT_Customer], 'Fact - Sales Invoice Line'[CUST_CARD_DESC],  'Dim - Plant'[Plant Name 1] ),",
                  "\t\tFILTER('Dim - Time', 'Dim - Time'[Date] >= CK_SDate &&",
                  "\t\t\t'Dim - Time'[Date]  <= CK_EDate))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "% MKT Customer (CK)",
                "expression": " DIVIDE([# Customer] , [# MKT Customer (CK)],0) -1",
                "formatString": "0.0 %;-0.0 %;0.0 %"
              },
              {
                "name": "AVG MKT Ticket Size (CK)",
                "expression": " CALCULATE([. MKT Net Amt (CK)]/ [# MKT Cust Transaction (CK)] )",
                "formatString": "#,0"
              },
              {
                "name": "% MKT Ticket Size (CK)",
                "expression": " CALCULATE([AVG Ticket Size]/ [AVG MKT Ticket Size (CK)]-1)",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": ". MKT Net Qty (CK)",
                "expression": [
                  "",
                  " /*",
                  "    VAR CK_SDate0 = CALCULATE(VALUES('Dim - Program'[CK_DL_Sdate]),",
                  "\t\tFilter('Dim - Program', 'Dim - Program'[PROGRAM_CATEGORY] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY])",
                  "\t\t\t&& 'Dim - Program'[MKT.Year] = SELECTEDVALUE('Dim - Program'[MKT.Year])))",
                  "\t\t\t",
                  "\t--VAR CK_EDate = VALUE(FORMAT(DATEADD(LASTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1, YEAR), \"yyyymmdd\"))",
                  "*/",
                  "    VAR CK_SDate = DATEADD(FIRSTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1,YEAR)",
                  "    VAR CK_EDate = DATEADD(LASTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1, YEAR)\t\t\t",
                  "\tRETURN CALCULATE([. Net Qty], ",
                  "\t\tALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[PLANT KIND],'Fact - Sales Invoice Line'[Customer Type (Month)],'Fact - Sales Invoice Line'[Customer Type (Year)],  'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand], 'Dim - Customer'[CUST_CARD_DESC], 'Dim - Plant'[PLANT NAME],'Fact - Sales Invoice Line'[Group Age], 'Dim - Plant'[Sales District Name], 'Dim - Customer'[Gender], 'Dim - Plant'[Tier], 'Fact - Sales Invoice Line'[MKT_Customer], 'Fact - Sales Invoice Line'[CUST_CARD_DESC],  'Dim - Plant'[Plant Name 1] ),",
                  "\t\tFILTER('Dim - Time', 'Dim - Time'[Date] >= CK_SDate &&",
                  "\t\t\t'Dim - Time'[Date]  <= CK_EDate))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "AVG MKT Net Amt/Bill (CK)",
                "expression": " CALCULATE([. MKT Net Amt (CK)]/[# MKT Bill (CK)])",
                "formatString": "#,0"
              },
              {
                "name": "% MKT Net Amt/Bill (CK)",
                "expression": " CALCULATE([AVG Net Amt/Bill]/[AVG MKT Net Amt/Bill (CK)])-1",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "AVG MKT Net Amt/Day (CK)",
                "expression": [
                  "",
                  " /*",
                  "    VAR CK_SDate0 = CALCULATE(VALUES('Dim - Program'[CK_DL_Sdate]),",
                  "\t\tFilter('Dim - Program', 'Dim - Program'[PROGRAM_CATEGORY] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY])",
                  "\t\t\t&& 'Dim - Program'[MKT.Year] = SELECTEDVALUE('Dim - Program'[MKT.Year])))",
                  "\t\t\t",
                  "\t--VAR CK_EDate = VALUE(FORMAT(DATEADD(LASTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1, YEAR), \"yyyymmdd\"))",
                  "*/",
                  "    VAR CK_SDate = DATEADD(FIRSTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1,YEAR)",
                  "    VAR CK_EDate = DATEADD(LASTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1, YEAR)\t\t\t",
                  "RETURN\tCALCULATE([AVG Net Amt/Day], ",
                  "\t\tALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[TIER], 'Dim - Plant'[PLANT KIND], 'Dim - Product'[RPT - Product Group 4 Name],",
                  "\t\t 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand], 'Dim - Plant'[Plant Code], 'Dim - Plant'[Plant Name 1] ,",
                  "\t\t  'Dim - Plant'[PLANT NAME], 'Dim - Plant'[Sales District Name]),",
                  "\t\tFILTER('Dim - Time', 'Dim - Time'[Date] >= CK_SDate &&",
                  "\t\t\t'Dim - Time'[Date]  <= CK_EDate))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "# MKT Customer (CK)",
                "expression": [
                  "",
                  " /*",
                  "    VAR CK_SDate0 = CALCULATE(VALUES('Dim - Program'[CK_DL_Sdate]),",
                  "\t\tFilter('Dim - Program', 'Dim - Program'[PROGRAM_CATEGORY] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY])",
                  "\t\t\t&& 'Dim - Program'[MKT.Year] = SELECTEDVALUE('Dim - Program'[MKT.Year])))",
                  "\t\t\t",
                  "\t--VAR CK_EDate = VALUE(FORMAT(DATEADD(LASTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1, YEAR), \"yyyymmdd\"))",
                  "*/",
                  "    VAR CK_SDate = DATEADD(FIRSTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1,YEAR)",
                  "    VAR CK_EDate = DATEADD(LASTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1, YEAR)\t\t\t",
                  "\tRETURN CALCULATE([# Customer], ",
                  "\t\tALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[PLANT KIND],'Fact - Sales Invoice Line'[Customer Type (Month)],'Fact - Sales Invoice Line'[Customer Type (Year)],  'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand], 'Dim - Customer'[CUST_CARD_DESC], 'Dim - Plant'[PLANT NAME],'Fact - Sales Invoice Line'[Group Age], 'Dim - Plant'[Sales District Name], 'Dim - Customer'[Gender], 'Dim - Plant'[Tier], 'Fact - Sales Invoice Line'[MKT_Customer], 'Fact - Sales Invoice Line'[CUST_CARD_DESC],  'Dim - Plant'[Plant Name 1] ),",
                  "\t\tFILTER('Dim - Time', 'Dim - Time'[Date] >= CK_SDate &&",
                  "\t\t\t'Dim - Time'[Date]  <= CK_EDate))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "# MKT Bill (CK)",
                "expression": [
                  "",
                  " /*",
                  "    VAR CK_SDate0 = CALCULATE(VALUES('Dim - Program'[CK_DL_Sdate]),",
                  "\t\tFilter('Dim - Program', 'Dim - Program'[PROGRAM_CATEGORY] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY])",
                  "\t\t\t&& 'Dim - Program'[MKT.Year] = SELECTEDVALUE('Dim - Program'[MKT.Year])))",
                  "\t\t\t",
                  "\t--VAR CK_EDate = VALUE(FORMAT(DATEADD(LASTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1, YEAR), \"yyyymmdd\"))",
                  "*/",
                  "    VAR CK_SDate = DATEADD(FIRSTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1,YEAR)",
                  "    VAR CK_EDate = DATEADD(LASTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1, YEAR)",
                  "\t\t\t",
                  "\tRETURN CALCULATE([# Bill], ",
                  "\t\tALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[PLANT KIND], 'Dim - Plant'[Plant Name 1], 'Fact - Sales Invoice Line'[Customer Type (Month)],'Fact - Sales Invoice Line'[Customer Type (Year)],  'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand], 'Dim - Customer'[CUST_CARD_DESC], 'Dim - Plant'[PLANT NAME],'Fact - Sales Invoice Line'[Group Age], 'Dim - Plant'[Sales District Name], 'Dim - Customer'[Gender], 'Dim - Plant'[Tier], 'Fact - Sales Invoice Line'[MKT_Customer], 'Fact - Sales Invoice Line'[CUST_CARD_DESC]),",
                  "\t\tFILTER('Dim - Time', 'Dim - Time'[Date] >= CK_SDate &&",
                  "\t\t'Dim - Time'[Date]  <= CK_EDate))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "AVG MKT Qty/Bill (CK)",
                "expression": " CALCULATE([. MKT Net Qty (CK)]/[# MKT Bill (CK)])",
                "formatString": "#,0.00"
              },
              {
                "name": "% MKT Qty/Bill (CK)",
                "expression": " CALCULATE([AVG Qty/Bill]/[AVG MKT Qty/Bill (CK)]-1)",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "% MKT Net Amt/Day (CK)",
                "expression": " CALCULATE([AVG Net Amt/Day]/[AVG MKT Net Amt/Day (CK)]-1)",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "# MKT Active Plant (CK)",
                "expression": [
                  " ",
                  " /*",
                  "    VAR CK_SDate0 = CALCULATE(VALUES('Dim - Program'[CK_DL_Sdate]),",
                  "\t\tFilter('Dim - Program', 'Dim - Program'[PROGRAM_CATEGORY] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY])",
                  "\t\t\t&& 'Dim - Program'[MKT.Year] = SELECTEDVALUE('Dim - Program'[MKT.Year])))",
                  "\t\t\t",
                  "\t--VAR CK_EDate = VALUE(FORMAT(DATEADD(LASTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1, YEAR), \"yyyymmdd\"))",
                  "*/",
                  "    VAR CK_SDate = DATEADD(FIRSTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1,YEAR)",
                  "    VAR CK_EDate = DATEADD(LASTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1, YEAR)",
                  "",
                  "",
                  "RETURN CALCULATE([# Active Plant], ",
                  "\tALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[PLANT KIND],'Fact - Sales Invoice Line'[Customer Type (Month)],'Fact - Sales Invoice Line'[Customer Type (Year)],  'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand], 'Dim - Customer'[CUST_CARD_DESC], 'Dim - Plant'[PLANT NAME],'Fact - Sales Invoice Line'[Group Age], 'Dim - Plant'[Sales District Name], 'Dim - Customer'[Gender], 'Dim - Plant'[Tier], 'Fact - Sales Invoice Line'[MKT_Customer], 'Fact - Sales Invoice Line'[CUST_CARD_DESC],  'Dim - Plant'[Plant Name 1] ),",
                  "\t\tFILTER('Dim - Time', 'Dim - Time'[Date] >= CK_SDate &&",
                  "\t\t\t'Dim - Time'[Date]  <= CK_EDate))",
                  "",
                  "\t",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "AVG MKT Customer/Store (LY)",
                "expression": " CALCULATE([# MKT Customer (LY)]/[# MKT Active Plant (LY)])",
                "formatString": "#,0"
              },
              {
                "name": "AVG MKT Customer/Store (CK)",
                "expression": " CALCULATE([# MKT Customer (CK)]/[# MKT Active Plant (CK)])",
                "formatString": "#,0"
              },
              {
                "name": "MKT Net Amt/Store (CK)",
                "expression": " CALCULATE([. MKT Net Amt (CK)]/[# MKT Active Plant (CK)])",
                "formatString": "#,0"
              },
              {
                "name": "% Net Amt (Target)",
                "expression": " CALCULATE([. Net Amt]/[. Target Marketing])",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": ". Net Amt",
                "expression": " CALCULATE(sum('Fact - Sales Invoice Line'[Net Amount]), FILTER('Fact - Sales Invoice Line', 'Fact - Sales Invoice Line'[Invoice Type] <> \"ZRE\" &&'Fact - Sales Invoice Line'[INVOICE TYPE] <> \"ZS2\" && 'Fact - Sales Invoice Line'[INVOICE TYPE]<> \"ZPI\"))",
                "formatString": "#,0"
              },
              {
                "name": ". Net Amt (LY)",
                "expression": [
                  " CALCULATE([. Net Amt], DATEADD('Dim - Time'[Date], -1, YEAR) , ",
                  "ALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[PLANT KIND],'Fact - Sales Invoice Line'[Customer Type (Month)],'Fact - Sales Invoice Line'[Customer Type (Year)],  'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand], 'Dim - Customer'[CUST_CARD_DESC], 'Dim - Plant'[PLANT NAME],'Fact - Sales Invoice Line'[Group Age], 'Dim - Plant'[Sales District Name], 'Dim - Customer'[Gender], 'Dim - Plant'[Tier], 'Fact - Sales Invoice Line'[MKT_Customer],  'Dim - Plant'[Plant Name 1] ))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "%Net Amt (Region)",
                "expression": " CALCULATE([. Net Amt]/ CALCULATE([. Net Amt], ALL('Dim - Plant')))",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "% Net Qty (LY)",
                "expression": " CALCULATE([. Net Qty]/[. Net Qty (LY)]-1)",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "# Customer",
                "expression": [
                  " CALCULATE(DISTINCTCOUNT('Dim - Customer'[Customer Code]), RELATEDTABLE('Fact - Sales Invoice Line'), ALL('Dim - Time'),  FILTER('Fact - Sales Invoice Line', 'Fact - Sales Invoice Line'[Invoice Type] <> \"ZRE\" &&'Fact - Sales Invoice Line'[INVOICE TYPE] <> \"ZS2\" && 'Fact - Sales Invoice Line'[INVOICE TYPE]<> \"ZPI\" ),",
                  "FILTER('Dim - Customer', NOT 'Dim - Customer'[CUST_CARD_DESC] in {\"One-time\",\"Payer\"}))"
                ],
                "formatString": "#,0"
              },
              {
                "name": "# Customer (LY)",
                "expression": " CALCULATE([# Customer], DATEADD('Dim - Time'[Date], -1, YEAR),  ALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[PLANT KIND],'Fact - Sales Invoice Line'[Customer Type (Month)],'Fact - Sales Invoice Line'[Customer Type (Year)],  'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand], 'Dim - Customer'[CUST_CARD_DESC], 'Dim - Plant'[PLANT NAME],'Fact - Sales Invoice Line'[Group Age], 'Dim - Plant'[Sales District Name], 'Dim - Customer'[Gender], 'Dim - Plant'[Tier], 'Fact - Sales Invoice Line'[MKT_Customer], 'Fact - Sales Invoice Line'[CUST_CARD_DESC]))",
                "formatString": "#,0"
              },
              {
                "name": "# Cust Transaction (PC)",
                "expression": " COUNTROWS(GROUPBY('Fact - Sales Invoice Line', 'Fact - Sales Invoice Line'[PLANT_WID], 'Fact - Sales Invoice Line'[CUSTOMER_SOLD_TO_WID], 'Fact - Sales Invoice Line'[INVOICED_ON_DT_WID]))",
                "formatString": "#,0"
              },
              {
                "name": "# Cust Transaction (PC) (LY)",
                "expression": [
                  " CALCULATE([# Cust Transaction (PC)], ",
                  "DATEADD('Dim - Time'[Date], -1, YEAR),",
                  "  ALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[PLANT KIND],'Fact - Sales Invoice Line'[Customer Type (Month)],'Fact - Sales Invoice Line'[Customer Type (Year)],  'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand], 'Dim - Customer'[CUST_CARD_DESC], 'Dim - Plant'[PLANT NAME],'Fact - Sales Invoice Line'[Group Age], 'Dim - Plant'[Sales District Name], 'Dim - Customer'[Gender], 'Dim - Plant'[Tier], 'Fact - Sales Invoice Line'[MKT_Customer], 'Fact - Sales Invoice Line'[CUST_CARD_DESC],  'Dim - Plant'[Plant Name 1] ))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "# Active Plant",
                "expression": " DISTINCTCOUNT('Fact - Sales Invoice Line'[PLANT_WID])",
                "formatString": "#,0"
              },
              {
                "name": ". MKT Net Amt(Corr)",
                "expression": [
                  " CALCULATE([. Net Amt], ",
                  "",
                  "REMOVEFILTERS('Fact - Condition'[Saledeal_ParentGrp]))"
                ],
                "formatString": "#,0.00"
              }
            ]
          },
          {
            "name": "Fact - Condition",
            "columns": [
              {
                "name": "CONDITION_TYPE",
                "dataType": "string",
                "sourceColumn": "CONDITION_TYPE"
              },
              {
                "name": "CONDITION_VALUE",
                "dataType": "double",
                "sourceColumn": "CONDITION_VALUE"
              },
              {
                "name": "INVOICE_NUM",
                "dataType": "string",
                "sourceColumn": "INVOICE_NUM"
              },
              {
                "name": "INVOICE_ITEM",
                "dataType": "string",
                "sourceColumn": "INVOICE_ITEM"
              },
              {
                "name": "INVOICED_ON_DT_WID",
                "dataType": "int64",
                "sourceColumn": "INVOICED_ON_DT_WID",
                "summarizeBy": "none"
              },
              {
                "name": "SALE_DEAL_WID",
                "dataType": "int64",
                "sourceColumn": "SALE_DEAL_WID",
                "summarizeBy": "none"
              },
              {
                "name": "PRODUCT_WID",
                "dataType": "int64",
                "sourceColumn": "PRODUCT_WID",
                "summarizeBy": "none"
              },
              {
                "name": "PLANT_WID",
                "dataType": "int64",
                "sourceColumn": "PLANT_WID",
                "summarizeBy": "none"
              },
              {
                "type": "calculated",
                "name": "ConditionID",
                "dataType": "string",
                "isDataTypeInferred": true,
                "expression": " 'Fact - Condition'[INVOICED_ON_DT_WID]&\"_\"&'Fact - Condition'[INVOICE_NUM] &\"_\"&'Fact - Condition'[INVOICE_ITEM]"
              },
              {
                "type": "calculated",
                "name": "Saledeal_ParentGrp",
                "dataType": "string",
                "isDataTypeInferred": true,
                "expression": [
                  "",
                  "IF (RELATED('Dim - Sale Deals'[SALEDEAL_ParentGrp]) = \"Sale deal CT\" && 'Fact - Condition'[INVOICED_ON_DT_WID] >= RELATED('Dim - Sale Deals'[EFFECTIVE_FROM_DT]) && 'Fact - Condition'[INVOICED_ON_DT_WID] <=RELATED('Dim - Sale Deals'[EFFECTIVE_TO_DT]), RELATED('Dim - Sale Deals'[SALEDEAL_ParentGrp]),",
                  "\tIF (RELATED('Dim - Sale Deals'[SALEDEAL_ParentGrp]) = \"Sale deal CT\" && 'Fact - Condition'[INVOICED_ON_DT_WID] > RELATED('Dim - Sale Deals'[EFFECTIVE_TO_DT]), \"Others\", RELATED('Dim - Sale Deals'[SALEDEAL_ParentGrp])",
                  "))"
                ]
              }
            ],
            "partitions": [
              {
                "name": "Partition",
                "dataView": "full",
                "source": {
                  "type": "m",
                  "expression": [
                    "let",
                    "    Source = #\"SQL/192 168 3 31;PNJ_ROLAP\",",
                    "    dbo_W_CONDITION_TYPE_F = Source{[Schema=\"dbo\",Item=\"W_VW_CONDITION_F\"]}[Data]",
                    "in",
                    "    dbo_W_CONDITION_TYPE_F"
                  ]
                }
              }
            ],
            "measures": [
              {
                "name": ". Discount Amt",
                "expression": [
                  "CALCULATE(SUM([CONDITION_VALUE])*-1,",
                  "CROSSFILTER('Fact - Condition'[ConditionID], 'Fact - Sales Invoice Line'[ConditionID], both))"
                ],
                "formatString": "#,0"
              },
              {
                "name": "# MKT Cust. Use Saledeal",
                "expression": [
                  " ",
                  "\tCALCULATE([# Customer],",
                  "\t\tFilter('Fact - Condition', 'Fact - Condition'[. Discount Amt] >0),",
                  "\t\tFILTER( 'Fact - Sales Invoice Line' ,'Fact - Sales Invoice Line'[Program Category] = SELECTEDVALUE('Fact - Sales Invoice Line'[PROGRAM CATEGORY]) &&",
                  "VALUE('Fact - Sales Invoice Line'[MKT.YEAR]) = value(SELECTEDVALUE('Dim - Program'[MKT.Year])) ",
                  "\t\t)",
                  "\t\t)"
                ],
                "formatString": "#,0"
              },
              {
                "name": "# MKT Cust. Use Saledeal (LY)",
                "expression": [
                  " CALCULATE([# MKT Cust. Use Saledeal],",
                  "FILTER(",
                  "ALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[TIER], 'Dim - Plant'[PLANT KIND], 'Fact - Sales Invoice Line'[Customer Type (Month)],'Fact - Sales Invoice Line'[Customer Type (Year)], 'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand],'Dim - Customer'[CUST_CARD_DESC],'Dim - Plant'[Plant Code], 'Dim - Plant'[PLANT NAME], 'Dim - Plant'[Sales District Name], 'Fact - Sales Invoice Line'[Group Age], 'Dim - Customer'[Gender], 'Fact - Sales Invoice Line'[CUST_CARD_DESC], 'Fact - Sales Invoice Line'[MKT_Customer]),",
                  " 'Fact - Sales Invoice Line'[Program Category] = SELECTEDVALUE('Fact - Sales Invoice Line'[PROGRAM CATEGORY]) &&",
                  "VALUE('Fact - Sales Invoice Line'[MKT.YEAR]) = value(SELECTEDVALUE('Dim - Program'[MKT.Year])) - 1 &&",
                  " 'Fact - Sales Invoice Line'[Program Category] <> BLANK())",
                  " )"
                ],
                "formatString": "#,0"
              },
              {
                "name": "% MKT Cust. Use Saledeal",
                "expression": [
                  " ",
                  "\t\t",
                  "VAR X0 = CALCULATE([# Customer],",
                  "\t\tREMOVEFILTERS('Fact - Condition'[Saledeal_ParentGrp]))",
                  "\t",
                  "RETURN [# MKT Cust. Use Saledeal]/X0"
                ],
                "formatString": "0.0 %;-0.0 %;0.0 %"
              },
              {
                "name": "MKT Discount Amt (LY)",
                "expression": [
                  " CALCULATE(CALCULATE([. Discount Amt], ",
                  "FILTER(",
                  "ALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[PLANT KIND],'Fact - Sales Invoice Line'[Customer Type (Month)],'Fact - Sales Invoice Line'[Customer Type (Year)],  'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand], 'Dim - Customer'[CUST_CARD_DESC], 'Dim - Plant'[PLANT NAME],'Fact - Sales Invoice Line'[Group Age], 'Dim - Plant'[Sales District Name], 'Dim - Customer'[Gender], 'Dim - Plant'[Tier], 'Fact - Sales Invoice Line'[MKT_Customer], 'Fact - Sales Invoice Line'[CUST_CARD_DESC]), ",
                  "",
                  "'Fact - Sales Invoice Line'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "VALUE('Fact - Sales Invoice Line'[MKT.YEAR]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year])) - 1 &&",
                  "  'Fact - Sales Invoice Line'[Program Category] <> BLANK())))"
                ],
                "formatString": "#,0"
              },
              {
                "name": "MKT Discount / Revenue",
                "expression": " [. Discount Amt]/[. Net Amt]",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "MKT Discount / Revenue (LY)",
                "expression": " [MKT Discount Amt (LY)]/[. MKT Net Amt (LY)]",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "% MKT Discount Amt (LY)",
                "expression": " [. Discount Amt]/ [MKT Discount Amt (LY)]-1",
                "formatString": "0.0 %;-0.0 %;0.0 %"
              },
              {
                "name": "% MKT Discount / Revenue (LY)",
                "expression": " [MKT Discount / Revenue]/[MKT Discount / Revenue (LY)]-1",
                "formatString": "0.0 %;-0.0 %;0.0 %"
              },
              {
                "name": "% MKT Cust. Use Saledeal (LY)",
                "expression": [
                  "  ",
                  "VAR X0 =  CALCULATE([# MKT Customer (LY)],",
                  "\t\tREMOVEFILTERS('Fact - Condition'[Saledeal_ParentGrp]))",
                  "RETURN [# MKT Cust. Use Saledeal (LY)]/X0"
                ],
                "formatString": "0.0 %;-0.0 %;0.0 %"
              }
            ]
          },
          {
            "name": "Dim - Camera Age",
            "columns": [
              {
                "name": "Palexy AGEID",
                "dataType": "int64",
                "sourceColumn": "Palexy AGEID"
              },
              {
                "name": "Palexy Age",
                "dataType": "string",
                "sourceColumn": "Palexy Age"
              }
            ],
            "partitions": [
              {
                "name": "Partition",
                "dataView": "full",
                "source": {
                  "type": "m",
                  "expression": [
                    "let",
                    "    Source = #\"SQL/192 168 3 31;DW_RAW\",",
                    "    dbo_PA_AGE_RANGE = Source{[Schema=\"dbo\",Item=\"PA_AGE_RANGE\"]}[Data],",
                    "    #\"Removed Columns\" = Table.RemoveColumns(dbo_PA_AGE_RANGE,{\"CREATION_DATE\", \"FILE_NAME\"}),",
                    "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"AGE_RANGE_ID\", \"Palexy AGEID\"}, {\"AGE_RANGE\", \"Palexy Age\"}})",
                    "in",
                    "    #\"Renamed Columns\""
                  ]
                }
              }
            ]
          },
          {
            "name": "Fact - Marketing Spend",
            "columns": [
              {
                "name": "PROGRAM_WID",
                "dataType": "int64",
                "sourceColumn": "PROGRAM_WID",
                "summarizeBy": "none"
              },
              {
                "name": "Cost Group",
                "dataType": "string",
                "sourceColumn": "COST_GROUP"
              },
              {
                "name": "Item Cost",
                "dataType": "string",
                "sourceColumn": "ITEM_COST"
              },
              {
                "name": "COST",
                "dataType": "double",
                "sourceColumn": "COST"
              },
              {
                "name": "Program Category",
                "dataType": "string",
                "sourceColumn": "PROGRAM_CATEGORY"
              },
              {
                "name": "MKT.Year",
                "dataType": "string",
                "sourceColumn": "MKT.Year"
              },
              {
                "name": "CHARGEBY",
                "dataType": "string",
                "sourceColumn": "CHARGEBY"
              },
              {
                "name": "row_wid",
                "dataType": "double",
                "sourceColumn": "ROW_WID",
                "summarizeBy": "none"
              }
            ],
            "partitions": [
              {
                "name": "Partition",
                "dataView": "full",
                "source": {
                  "type": "m",
                  "expression": [
                    "let",
                    "    Source = #\"SQL/192 168 3 31;PNJ_ROLAP\",",
                    "    dbo_W_VW_SPEND_MKT = Source{[Schema=\"dbo\",Item=\"W_VW_MARKETING_SPEND_F\"]}[Data],",
                    "    #\"Renamed Columns\" = Table.RenameColumns(dbo_W_VW_SPEND_MKT,{{\"Date_key\", \"ROW_WID\"}})",
                    "in",
                    "    #\"Renamed Columns\""
                  ]
                }
              }
            ]
          },
          {
            "name": "Fact - Camera",
            "columns": [
              {
                "name": "DATE",
                "dataType": "int64",
                "sourceColumn": "DATE_WID"
              },
              {
                "name": "age_range",
                "dataType": "int64",
                "sourceColumn": "age_range"
              },
              {
                "name": "PA Store",
                "dataType": "int64",
                "sourceColumn": "PA Store"
              },
              {
                "name": "duration",
                "dataType": "double",
                "sourceColumn": "duration"
              },
              {
                "name": "recording_time",
                "dataType": "int64",
                "sourceColumn": "recording_time"
              },
              {
                "name": "action_type",
                "dataType": "string",
                "sourceColumn": "action_type"
              },
              {
                "name": "PLANT_WID",
                "dataType": "int64",
                "sourceColumn": "PLANT_WID"
              },
              {
                "name": "PersonID",
                "dataType": "int64",
                "sourceColumn": "PersonID"
              }
            ],
            "partitions": [
              {
                "name": "Partition",
                "dataView": "full",
                "source": {
                  "type": "m",
                  "expression": [
                    "let",
                    "    Source = Value.NativeQuery(#\"SQL/192 168 3 31;DW_RAW\",\"SELECT DATE_WID, PERSON_WID PersonID, ACTION_TYPE action_type,STORE_ID [PA Store], PLANT_WID,DURATION duration, RECORDING_TIME recording_time, age_range FROM W_PA_ICA_BASELINE_F where action_type = 'visit'\")",
                    "in",
                    "    Source"
                  ]
                }
              }
            ],
            "measures": [
              {
                "name": "# Visitors",
                "expression": [
                  "",
                  "\tVAR CK_SDate = CALCULATE(VALUES('Dim - Program'[EFFECTIVE_FROM_DT]),",
                  "\t\tFilter('Dim - Program', 'Dim - Program'[PROGRAM_CATEGORY] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY])",
                  "\t\t\t&& 'Dim - Program'[MKT.Year] = SELECTEDVALUE('Dim - Program'[MKT.Year])))",
                  "\t\t\t",
                  "\tVAR CK_EDate = CALCULATE(VALUES('Dim - Program'[EFFECTIVE_TO_DT]),",
                  "\t\tFilter('Dim - Program', 'Dim - Program'[PROGRAM_CATEGORY] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY])",
                  "\t\t\t&& 'Dim - Program'[MKT.Year] = SELECTEDVALUE('Dim - Program'[MKT.Year])))",
                  "RETURN CALCULATE([# Ttl Store Visitors], ",
                  "\t\tALLEXCEPT('Fact - Sales Invoice Line', 'Dim - Plant'[REGION], 'Dim - Plant'[TIER], 'Dim - Plant'[PLANT KIND], 'Dim - Product'[RPT - Product Group 4 Name], 'Dim - Product'[RPT - Product Group 2 Name], 'Dim - Product'[RPT - Product Group 7 Name], 'Dim - Product'[Co-Operate Brand], 'Dim - Plant'[Plant Code], 'Dim - Plant'[PLANT NAME], 'Dim - Plant'[Sales District Name]),",
                  "\t\tFILTER('Dim - Time', 'Dim - time'[row_wid] >= VALUE(CK_SDate) &&",
                  "\t\t'Dim - time'[row_wid]  <= VALUE(CK_EDate)))"
                ],
                "formatString": "#,0"
              },
              {
                "name": "# Ttl Store Visitors",
                "expression": [
                  "",
                  "CALCULATE(DISTINCTCOUNT([PersonID]))"

                ],
                "formatString": "#,0"
              },
              {
                "name": "% CR",
                "expression": [
                  " CALCULATE( DIVIDE([# Customer],[# visitors],0),",
                  "\tCROSSFILTER('Dim - Plant'[ROW_WID], 'Fact - Camera'[PLANT_WID],Both),",
                  "\t'Dim - Plant'[Palexy ID]<> blank())"
                ],
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "# Visitor (CK)",
                "expression": [
                  " ",
                  "    VAR CK_SDate = ",
                  "\t\tCALCULATE(VALUES('Dim - Program'[CK_DL_Sdate]),",
                  "\t\tFilter('Dim - Program', 'Dim - Program'[PROGRAM_CATEGORY] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY])",
                  "\t\t\t&& 'Dim - Program'[MKT.Year] = SELECTEDVALUE('Dim - Program'[MKT.Year])))",
                  "\t\t\t",
                  "\tVAR CK_EDate = FORMAT(DATEADD(LASTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1, YEAR), \"yyyymmdd\")",
                  "",
                  "RETURN ",
                  "\tCALCULATE([# Ttl Store Visitors], DATEADD('Dim - Time'[Date], -1, YEAR),",
                  "\t\tFILTER(ALL('Fact - Camera'),",
                  "\t\tVALUE('Fact - Camera'[Date]) >= value(CK_SDate) && VALUE('Fact - Camera'[Date]) <= value(CK_EDate)))"
                ],
                "formatString": "#,0"
              },
              {
                "name": "% Visitor (CK)",
                "expression": " [# Visitors]/[# Visitor (CK)]-1",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "%CR (CK)",
                "expression": "[# Visitor (CK)]/[# MKT Customer (CK)]",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              }
            ]
          },
          {
            "name": "Dim - Sale Deals",
            "columns": [
              {
                "name": "ROW_WID",
                "dataType": "int64",
                "sourceColumn": "ROW_WID"
              },
              {
                "name": "PROGRAM_CODE",
                "dataType": "string",
                "sourceColumn": "PROGRAM_CODE"
              },
              {
                "name": "PROGRAM_NAME",
                "dataType": "string",
                "sourceColumn": "PROGRAM_NAME"
              },
              {
                "name": "EFFECTIVE_FROM_DT",
                "dataType": "int64",
                "sourceColumn": "EFFECTIVE_FROM_DT"
              },
              {
                "name": "EFFECTIVE_TO_DT",
                "dataType": "int64",
                "sourceColumn": "EFFECTIVE_TO_DT"
              },
              {
                "name": "SD_Category",
                "dataType": "string",
                "sourceColumn": "SD_Category"
              },
              {
                "name": "SALEDEAL_ParentGrp",

                "dataType": "string",
                "sourceColumn": "SALEDEAL_ParentGrp"
              }
            ],
            "partitions": [
              {
                "name": "Partition",
                "dataView": "full",
                "source": {
                  "type": "m",
                  "expression": [
                    "let",
                    "    Source = #\"SQL/192 168 3 31;PNJ_ROLAP\",",
                    "    dbo_Z_SALE_PROGRAM_D = Source{[Schema=\"dbo\",Item=\"W_VW_SALE_PROGRAM_D\"]}[Data],",
                    "    #\"Removed Columns\" = Table.RemoveColumns(dbo_Z_SALE_PROGRAM_D,{\"DATASOURCE_NUM_ID\", \"PROGRAM_CATEGORY\", \"DATE_KEY\", \"APPLY_RANGE\", \"APPLY_PROD_GRP\", \"TIME\", \"YEAR\"})",
                    "in",
                    "    #\"Removed Columns\""
                  ]
                }
              }
            ]
          },
          {
            "name": "Fact - ATL",
            "columns": [
              {
                "name": "Plant_wid",
                "dataType": "int64",
                "sourceColumn": "Plant_wid"
              },
              {
                "name": "PROGRAM_WID",
                "dataType": "int64",
                "sourceColumn": "PROGRAM_WID"
              },
              {
                "name": "Date_key",
                "dataType": "int64",
                "sourceColumn": "Date_key"
              },
              {
                "name": "Source",
                "dataType": "string",
                "sourceColumn": "Source"
              },
              {
                "name": "Layer",
                "dataType": "string",
                "sourceColumn": "Layer"
              },
              {
                "name": "Region",
                "dataType": "string",
                "sourceColumn": "Region"
              },
              {
                "name": "Impressions",
                "dataType": "double",
                "sourceColumn": "Impressions"
              },
              {
                "name": "Clicks",
                "dataType": "double",
                "sourceColumn": "Clicks"
              },
              {
                "name": "Reach",
                "dataType": "double",
                "sourceColumn": "Reach"
              },
              {
                "name": "Ads_Spend",
                "dataType": "double",
                "sourceColumn": "Ads_Spend"
              },
              {
                "name": "CTR",
                "dataType": "double",
                "sourceColumn": "CTR"
              },
              {
                "name": "Frequency",
                "dataType": "double",
                "sourceColumn": "Frequency"
              },
              {
                "name": "Engagement",
                "dataType": "int64",
                "sourceColumn": "Engagement"
              },
              {
                "name": "CPC",
                "dataType": "double",
                "sourceColumn": "CPC"
              },
              {
                "name": "users",
                "dataType": "int64",
                "sourceColumn": "users"
              },
              {
                "name": "newUsers",
                "dataType": "int64",
                "sourceColumn": "newUsers"
              },
              {
                "name": "pageviews",
                "dataType": "int64",
                "sourceColumn": "pageviews"
              },
              {
                "name": "sessions",
                "dataType": "int64",
                "sourceColumn": "sessions"
              },
              {
                "name": "bounceRate",
                "dataType": "double",
                "sourceColumn": "bounceRate"
              },
              {
                "name": "TimeOnPage",
                "dataType": "double",
                "sourceColumn": "TimeOnPage"
              },
              {
                "name": "Program Category",
                "dataType": "string",
                "sourceColumn": "PROGRAM_CATEGORY"
              },
              {
                "name": "PROGRAM_TYPE",
                "dataType": "string",
                "sourceColumn": "PROGRAM_TYPE"
              },
              {
                "name": "MKT.Year",
                "dataType": "string",
                "sourceColumn": "MKT.Year"
              },
              {
                "name": "SessionDuration",
                "dataType": "dateTime",
                "sourceColumn": "SessionDuration"
              }
            ],
            "partitions": [
              {
                "name": "Partition",
                "dataView": "full",
                "source": {
                  "type": "m",
                  "expression": [
                    "let",
                    "    Source = #\"SQL/192 168 3 31;PNJ_ROLAP\",",
                    "    dbo_Z_VW_ATL_MKT = Source{[Schema=\"dbo\",Item=\"W_VW_ATL_MKT\"]}[Data],",
                    "    #\"Renamed Columns\" = Table.RenameColumns(dbo_Z_VW_ATL_MKT,{{\"Amount_Spent_VND\", \"Ads_Spend\"}})",
                    "in",
                    "    #\"Renamed Columns\""
                  ]
                }
              }
            ],
            "measures": [
              {
                "name": ". Impressions",
                "expression": [
                  " CALCULATE(SUM([Impressions]),",
                  "\tFILTER(ALLEXCEPT('Fact - ATL', 'Fact - ATL'[Source], 'Fact - ATL'[Layer], 'Dim - Time'[Date]),",
                  "\t\t'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\t\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year]))",
                  "))"
                ],
                "formatString": "#,0"
              },
              {
                "name": ". Click",
                "expression": [
                  " CALCULATE(SUM([Clicks]), ",
                  "\tFILTER('Fact - ATL', 'Fact - ATL'[Layer] =\"Date\" &&",
                  "\t\t'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\t\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year]))",
                  "))"
                ],
                "formatString": "#,0"
              },
              {
                "name": ". Ads Spend",
                "expression": [
                  " CALCULATE(SUM([Ads_Spend]),",
                  "FILTER('Fact - ATL',  'Fact - ATL'[Layer] = \"Date\" &&",
                  "\t'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year]))",
                  "",
                  "))"
                ],
                "formatString": "#,0"
              },
              {
                "name": ". CTR",
                "expression": [
                  " CALCULATE(",
                  "\tDIVIDE([. Click], [. Impressions],0),",
                  "\t\tFILTER(ALLEXCEPT('Fact - ATL', 'Fact - ATL'[Source], 'Fact - ATL'[Layer], 'Dim - Time'[Date]),",
                  "\t\t'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\t\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year]))",
                  "",
                  "",
                  "\t\t)",
                  "\t\t)"
                ],
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": ". CPC",
                "expression": "[. Ads Spend]/ [. Click]",
                "formatString": "#,0"
              },
              {
                "name": "# Users",
                "expression": [
                  "",
                  "VAR Last_date = VALUE(FORMAT(LASTDATE('Fact - Sales Invoice Line'[Invoice Date]), \"yyyymmdd\"))",
                  "",
                  "RETURN CALCULATE(SUM([users]), ",
                  "FILTER(ALLEXCEPT('Fact - ATL', 'Fact - ATL'[Layer],'Dim - Time'[Date]), 'Fact - ATL'[Source] = \"Google Analytics\" &&",
                  "\t'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year])) ",
                  "))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "# New Users",
                "expression": [
                  "",
                  "VAR Last_date = VALUE(FORMAT(LASTDATE('Fact - Sales Invoice Line'[Invoice Date]), \"yyyymmdd\"))",
                  "",
                  "RETURN CALCULATE(SUM([newUsers]), ",
                  "FILTER(ALLEXCEPT('Fact - ATL', 'Fact - ATL'[Layer], 'Dim - Time'[Date]), 'Fact - ATL'[Source] = \"Google Analytics\" &&",
                  "\t'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year])) ",
                  "))",
                  "",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "# User (LY)",
                "expression": [
                  " ",
                  "",
                  "    VAR CK_SDate = ",
                  "\t\tCALCULATE(VALUES('Dim - Program'[CK_DL_Sdate]),",
                  "\t\tFilter('Dim - Program', 'Dim - Program'[PROGRAM_CATEGORY] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY])",
                  "\t\t\t&& 'Dim - Program'[MKT.Year] = SELECTEDVALUE('Dim - Program'[MKT.Year])))",
                  "\t\t\t",
                  "\tVAR CK_EDate0 = CALCULATE(VALUES('Dim - Program'[CK_DL_Edate]),",
                  "\t\tFilter('Dim - Program', 'Dim - Program'[PROGRAM_CATEGORY] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY])",
                  "\t\t\t&& 'Dim - Program'[MKT.Year] = SELECTEDVALUE('Dim - Program'[MKT.Year])))",
                  "\tVAR CK_EDate = FORMAT(DATEADD(LASTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1, YEAR), \"yyyymmdd\")",
                  "",
                  "",
                  "RETURN CALCULATE(SUM([users]), ",
                  "FILTER(ALLEXCEPT('Fact - ATL', 'Fact - ATL'[Layer],'Dim - Time'[Date]), 'Fact - ATL'[Source] = \"Google Analytics\" &&",
                  "\t'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year])-1) ",
                  "))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "# New User (LY)",
                "expression": [
                  "",
                  "    VAR CK_SDate = ",
                  "\t\tCALCULATE(VALUES('Dim - Program'[CK_DL_Sdate]),",
                  "\t\tFilter('Dim - Program', 'Dim - Program'[PROGRAM_CATEGORY] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY])",
                  "\t\t\t&& 'Dim - Program'[MKT.Year] = SELECTEDVALUE('Dim - Program'[MKT.Year])))",
                  "\t\t\t",
                  "\tVAR CK_EDate0 = CALCULATE(VALUES('Dim - Program'[CK_DL_Edate]),",
                  "\t\tFilter('Dim - Program', 'Dim - Program'[PROGRAM_CATEGORY] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY])",
                  "\t\t\t&& 'Dim - Program'[MKT.Year] = SELECTEDVALUE('Dim - Program'[MKT.Year])))",
                  "\tVAR CK_EDate = FORMAT(DATEADD(LASTDATE('Fact - Sales Invoice Line'[Invoice Date]),-1, YEAR), \"yyyymmdd\")",
                  "",
                  "RETURN CALCULATE(SUM([newUsers]), ",
                  "FILTER(ALLEXCEPT('Fact - ATL', 'Fact - ATL'[Layer], 'Dim - Time'[Date]), 'Fact - ATL'[Source] = \"Google Analytics\" &&",
                  "\t'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year])-1) ",
                  "))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "% Users (CK)",
                "expression": " [# Users]/[# User (LY)]-1",
                "formatString": "0.0 %;-0.0 %;0.0 %"
              },
              {
                "name": "% New Users (LY)",
                "expression": " [# New Users]/[# New User (LY)]-1",
                "formatString": "0.0 %;-0.0 %;0.0 %"
              },
              {
                "name": ". Impressions (LY)",
                "expression": [
                  " ",
                  "",
                  "    VAR CK_SDate = ",
                  "\t\tCALCULATE(VALUES('Dim - Program'[CK_DL_Sdate]),",
                  "\t\tFilter('Dim - Program', 'Dim - Program'[PROGRAM_CATEGORY] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY])",
                  "\t\t\t&& 'Dim - Program'[MKT.Year] = SELECTEDVALUE('Dim - Program'[MKT.Year])))",
                  "\t\t\t",
                  "\tVAR CK_EDate = CALCULATE(VALUES('Dim - Program'[CK_DL_Edate]),",
                  "\t\tFilter('Dim - Program', 'Dim - Program'[PROGRAM_CATEGORY] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY])",
                  "\t\t\t&& 'Dim - Program'[MKT.Year] = SELECTEDVALUE('Dim - Program'[MKT.Year])))",
                  "",
                  "RETURN ",
                  "CALCULATE(SUM([Impressions]),",
                  "DATEADD('Dim - Time'[Date], -1, YEAR),",
                  "FILTER(ALL('Fact - ATL'), ",
                  "VALUE('Fact - ATL'[Date_key]) >= value(CK_SDate) && VALUE('Fact - ATL'[Date_key]) <= value(CK_EDate)))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": ". Ads Spend (LY)",
                "expression": [
                  " CALCULATE([. Ads Spend],",
                  "",
                  "FILTER(All('Fact - ATL'),",
                  "  'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year])-1)",
                  "))"
                ],
                "formatString": "#,0"
              },
              {
                "name": ". % Ads Spend",
                "expression": " [. Ads Spend]/[. Ads Spend (LY)]-1",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": ". CTR (LY)",
                "expression": [
                  " CALCULATE([. CTR],",
                  "FILTER(ALLEXCEPT('Fact - ATL', 'Fact - ATL'[Source], 'Fact - ATL'[Layer]), ",
                  "  'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year])-1)",
                  "))"
                ],
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": ". Click (LY)",
                "expression": [
                  " CALCULATE([. Click],",
                  "FILTER(All('Fact - ATL'),",
                  "  'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year])-1)",
                  "))"
                ],
                "formatString": "#,0"
              },
              {
                "name": ". CPC (LY)",
                "expression": "[. Ads Spend (LY)]/ [. Click (LY)]",
                "formatString": "#,0"
              },
              {
                "name": "% Impressions (LY)",
                "expression": " [. Impressions]/[. Impressions (LY)]-1",
                "formatString": "0.0 %;-0.0 %;0.0 %"
              },
              {
                "name": "% Click (LY)",
                "expression": " [. Click]/[. Click (LY)]-1",
                "formatString": "0.0 %;-0.0 %;0.0 %"
              },
              {
                "name": "% CTR (LY)",
                "expression": " [. CTR]/[. CTR (LY)]-1",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": ". Session duration",
                "expression": [
                  " CALCULATE(SUM([SessionDuration]),",
                  "\tFILTER('Fact - ATL', 'Fact - ATL'[Source] = \"Google Analytics\" &&",
                  "\t\t'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\t\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year]))",
                  "))"
                ],
                "formatString": "H:mm:ss",
                "annotations": [
                  {
                    "name": "Format",
                    "value": "<Format Format=\"DateTimeCustom\"><DateTimes><DateTime LCID=\"1033\" Group=\"LongTime\" FormatString=\"H:mm:ss\" /></DateTimes></Format>"
                  }
                ]
              },
              {
                "name": ". Session Duration (LY)",
                "expression": [
                  " ",
                  "",
                  "    VAR CK_SDate = ",
                  "\t\tCALCULATE(VALUES('Dim - Program'[CK_DL_Sdate]),",
                  "\t\tFilter('Dim - Program', 'Dim - Program'[PROGRAM_CATEGORY] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY])",
                  "\t\t\t&& 'Dim - Program'[MKT.Year] = SELECTEDVALUE('Dim - Program'[MKT.Year])))",
                  "\t\t\t",
                  "\tVAR CK_EDate = CALCULATE(VALUES('Dim - Program'[CK_DL_Edate]),",
                  "\t\tFilter('Dim - Program', 'Dim - Program'[PROGRAM_CATEGORY] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY])",
                  "\t\t\t&& 'Dim - Program'[MKT.Year] = SELECTEDVALUE('Dim - Program'[MKT.Year])))",
                  "",
                  "RETURN ",
                  "CALCULATE(SUM([SessionDuration]),",
                  "DATEADD('Dim - Time'[Date], -1, YEAR),",
                  "\tFILTER('Fact - ATL',  'Fact - ATL'[Source] = \"Google Analytics\" &&",
                  "\t\t'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\t\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year])-1)",
                  "))"
                ],
                "formatString": "H:mm:ss",
                "annotations": [
                  {
                    "name": "Format",
                    "value": "<Format Format=\"DateTimeCustom\"><DateTimes><DateTime LCID=\"1033\" Group=\"LongTime\" FormatString=\"H:mm:ss\" /></DateTimes></Format>"
                  }
                ]
              },
              {
                "name": ". Session duration IMC",
                "expression": [
                  " CALCULATE(SUM([SessionDuration]),",
                  "\tFILTER('Fact - ATL', 'Fact - ATL'[Source] = \"Google Analytics-IMC\" &&",
                  "\t\t'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\t\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year]))",
                  "))"
                ],
                "formatString": "H:mm:ss",
                "annotations": [
                  {
                    "name": "Format",
                    "value": "<Format Format=\"DateTimeCustom\"><DateTimes><DateTime LCID=\"1033\" Group=\"LongTime\" FormatString=\"H:mm:ss\" /></DateTimes></Format>"
                  }
                ]
              },
              {
                "name": ". Session Duration IMC (LY)",
                "expression": [
                  " ",
                  "",
                  "CALCULATE(SUM([SessionDuration]),",
                  "",
                  "\tFILTER('Fact - ATL',  'Fact - ATL'[Source] = \"Google Analytics-IMC\" &&",
                  "\t\t'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\t\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year])-1)",
                  "))"
                ],
                "formatString": "H:mm:ss",
                "annotations": [
                  {
                    "name": "Format",
                    "value": "<Format Format=\"DateTimeCustom\"><DateTimes><DateTime LCID=\"1033\" Group=\"LongTime\" FormatString=\"H:mm:ss\" /></DateTimes></Format>"
                  }
                ]
              },
              {
                "name": ". Session duration IMC vs. Total",
                "expression": " [. Session duration IMC]/[. Session duration]",
                "formatString": "0.0 %;-0.0 %;0.0 %"
              },
              {
                "name": ". Users IMC vs. Total",
                "expression": " [# Users IMC]/[# Users]",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "# Days Ads.",
                "expression": [
                  "CALCULATE(DISTINCTCOUNT([Date_key]),",
                  "\tFILTER('Fact - ATL', 'Fact - ATL'[Layer] = \"Date\" &&",
                  "\t\t'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\t\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year]))",
                  "))"
                ]
              },
              {
                "name": "# Days Ads. (LY)",
                "expression": [
                  " CALCULATE(DISTINCTCOUNT([Date_key]),",
                  "\tFILTER(ALL('Fact - ATL'), 'Fact - ATL'[Layer] = \"Date\" && 'Fact - ATL'[Source] IN {\"Google Ads\", \"Facebook Ads\"} &&",
                  "\t\t'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\t\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year])-1)",
                  "\t))",
                  "",
                  "",
                  ""
                ]
              },
              {
                "name": "# Users IMC",
                "expression": [
                  "",
                  "VAR Last_date = VALUE(FORMAT(LASTDATE('Fact - Sales Invoice Line'[Invoice Date]), \"yyyymmdd\"))",
                  "",
                  "RETURN CALCULATE(SUM([users]), ",
                  "FILTER(ALLEXCEPT('Fact - ATL', 'Fact - ATL'[Layer], 'Dim - Time'[Date]),  'Fact - ATL'[Source] = \"Google Analytics-IMC\" &&",
                  "\t'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year]))",
                  "))",
                  "",
                  ""
                ]
              },
              {
                "name": "# New Users IMC",
                "expression": [
                  "",
                  "VAR Last_date = VALUE(FORMAT(LASTDATE('Fact - Sales Invoice Line'[Invoice Date]), \"yyyymmdd\"))",
                  "",
                  "RETURN CALCULATE(SUM([newUsers]), ",
                  "FILTER(ALLEXCEPT('Fact - ATL', 'Fact - ATL'[Layer],'Dim - Time'[Date]), 'Fact - ATL'[Source] = \"Google Analytics-IMC\" &&",
                  "\t'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year]))",
                  "))",
                  ""
                ],
                "formatString": "0"
              },
              {
                "name": ". Bounce",
                "expression": [
                  " CALCULATE(SUM([bounceRate])/100,",
                  "\tFILTER(ALLEXCEPT('Fact - ATL', 'Fact - ATL'[Layer],'Dim - Time'[Date]),  'Fact - ATL'[Source] = \"Google Analytics\" &&",
                  "\t\t'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\t\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year]))",
                  "))"
                ],
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": ". Bounce (LY)",
                "expression": [
                  " CALCULATE(SUM([bounceRate])/100,",
                  "\tFILTER(ALLEXCEPT('Fact - ATL', 'Fact - ATL'[Layer],'Dim - Time'[Date]), 'Fact - ATL'[Source] = \"Google Analytics\" &&",
                  "\t\t'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\t\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year])-1)",
                  "))"
                ],
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": ". Bounce IMC",
                "expression": [
                  " CALCULATE(SUM([bounceRate])/100,",
                  "\tFILTER(ALLEXCEPT('Fact - ATL', 'Fact - ATL'[Layer],'Dim - Time'[Date]),  'Fact - ATL'[Source] = \"Google Analytics-IMC\" &&",
                  "\t\t'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\t\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year]))",
                  "))"
                ],
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": ". Bounce IMC (LY)",
                "expression": [
                  " CALCULATE(SUM([bounceRate])/100,",
                  "\tFILTER(ALLEXCEPT('Fact - ATL', 'Fact - ATL'[Layer],'Dim - Time'[Date]),  'Fact - ATL'[Source] = \"Google Analytics-IMC\" &&",
                  "\t\t'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\t\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year])-1)",
                  "))"
                ],
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": ". Bounce IMC vs. Total",
                "expression": " [. Bounce IMC]/[. Bounce]",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": ". Bounce IMC vs. Total (LY)",
                "expression": " [. Bounce IMC (LY)]/[. Bounce (LY)]",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": ". Reach",
                "expression": [
                  " CALCULATE(SUM([Reach]),",
                  "\tFILTER(ALLEXCEPT('Fact - ATL', 'Fact - ATL'[Source], 'Fact - ATL'[Layer],'Dim - Time'[Date]),",
                  "\t 'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\t\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year]))",
                  "))"
                ],
                "formatString": "#,0"
              },
              {
                "name": ". Reach (LY)",
                "expression": [
                  " ",
                  "",
                  "    VAR CK_SDate = ",
                  "\t\tCALCULATE(VALUES('Dim - Program'[CK_DL_Sdate]),",
                  "\t\tFilter('Dim - Program', 'Dim - Program'[PROGRAM_CATEGORY] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY])",
                  "\t\t\t&& 'Dim - Program'[MKT.Year] = SELECTEDVALUE('Dim - Program'[MKT.Year])))",
                  "\t\t\t",
                  "\tVAR CK_EDate = CALCULATE(VALUES('Dim - Program'[CK_DL_Edate]),",
                  "\t\tFilter('Dim - Program', 'Dim - Program'[PROGRAM_CATEGORY] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY])",
                  "\t\t\t&& 'Dim - Program'[MKT.Year] = SELECTEDVALUE('Dim - Program'[MKT.Year])))",
                  "",
                  "RETURN ",
                  "CALCULATE(SUM([Reach]),",
                  "\tFILTER('Fact - ATL',",
                  "\t\t'Fact - ATL'[Program Category] = SELECTEDVALUE('Dim - Program'[Program_Category]) &&",
                  "\t\tVALUE('Fact - ATL'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year])-1)",
                  "))"
                ],
                "formatString": "#,0"
              },
              {
                "name": "% Reach (LY)",
                "expression": " [. Reach]/[. Reach (LY)]-1",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": ". New Users IMC vs. Total",
                "expression": " [# New Users IMC]/[# New Users]",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              }
            ]
          },
          {
            "name": "MKT_CAC",
            "columns": [
              {
                "type": "calculatedTableColumn",
                "name": "Value",
                "dataType": "int64",
                "isNameInferred": true,
                "isDataTypeInferred": true,
                "isHidden": true,
                "sourceColumn": "[Value]"
              },
              {
                "type": "calculated",
                "name": "Value 1",
                "dataType": "int64",
                "isDataTypeInferred": true,
                "expression": "{BLANK()}"
              }
            ],
            "partitions": [
              {
                "name": "CalculatedTable 1",
                "source": {
                  "type": "calculated",
                  "expression": "{BLANK()}"
                }
              }
            ],
            "measures": [
              {
                "name": ". Acquisition Cost",
                "expression": [
                  "",
                  "",
                  "\tVAR discount_customer = CALCULATE([. Discount Amt]/[# Customer], FILTER('Fact - Sales Invoice Line', 'Fact - Sales Invoice Line'[MKT_Customer] = \"Khách hàng mới\"))*-1",
                  "RETURN  (discount_customer + [. Ads per Customer])",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": ". Ads per Customer",
                "expression": [
                  " CALCULATE(",
                  "    DIVIDE([. Ttl MKT Cost], [All Customer], 0))"
                ],
                "formatString": "#,0"
              },
              {
                "name": ". Ttl MKT Cost",
                "expression": [
                  " CALCULATE(SUM('Fact - Marketing Spend'[Cost]), ",
                  "\tFILTER('Fact - Marketing Spend', 'Fact - Marketing Spend'[Program Category] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY]) &&",
                  "\tVALUE('Fact - Marketing Spend'[MKT.Year]) = SELECTEDVALUE('Dim - Program'[MKT.Year])",
                  "\t))",
                  "\t",
                  "",
                  "\t",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "MKT Cost / Revenue",
                "expression": [
                  " CALCULATE([. Ttl MKT Cost]/[. Net Amt],",
                  "REMOVEFILTERS('Dim - Plant'),",
                  "REMOVEFILTERS('Dim - Channel'))"
                ],
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": ". Ttl MKT Cost (LY)",
                "expression": [
                  " CALCULATE(SUM('Fact - Marketing Spend'[Cost]), ",
                  "\t",
                  "\tFILTER(ALLEXCEPT('Fact - Marketing Spend','Fact - Marketing Spend'[Cost Group], 'Fact - Marketing Spend'[Item Cost]),",
                  "\t 'Fact - Marketing Spend'[Program Category] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY]) &&",
                  "\tVALUE('Fact - Marketing Spend'[MKT.Year]) = VALUE(SELECTEDVALUE('Dim - Program'[MKT.Year])) -1",
                  "\t))"
                ],
                "formatString": "#,0"
              },
              {
                "name": "% Ttl MKT Cost (LY)",
                "expression": " [. Ttl MKT Cost]/[. Ttl MKT Cost (LY)]-1",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "% MKT Cost / Revenue (LY)",
                "expression": [
                  " ",
                  "VAR LY= [. Ttl MKT Cost (LY)]/[. Net Amt (LY)]",
                  "RETURN [MKT Cost / Revenue]/LY-1"
                ],
                "formatString": "0.0 %;-0.0 %;0.0 %"
              },
              {
                "name": "MKT Cost /Revenue (LY)",
                "expression": [
                  " CALCULATE([. Ttl MKT Cost (LY)]/[. Net Amt (LY)],",
                  "REMOVEFILTERS('Dim - Plant'),",
                  "REMOVEFILTERS('Dim - Channel'))"
                ],
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": ". Ttl MKT Prog Cost (LY)",
                "expression": [
                  " CALCULATE(SUM('Fact - MKT Cost'[Total Cost]),",
                  "\tFILTER('Fact - MKT Cost', 'Fact - MKT Cost'[Program Category] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY]) &&",
                  "\tVALUE('Fact - MKT Cost'[MKT.Year]) = SELECTEDVALUE('Dim - Program'[MKT.Year])-1",
                  "\t))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": ". Ttl MKT Prog Cost",
                "expression": [
                  " CALCULATE(SUM('Fact - MKT Cost'[Total Cost]),",
                  "\tFILTER('Fact - MKT Cost', 'Fact - MKT Cost'[Program Category] = SELECTEDVALUE('Dim - Program'[PROGRAM_CATEGORY]) &&",
                  "\tVALUE('Fact - MKT Cost'[MKT.Year]) = SELECTEDVALUE('Dim - Program'[MKT.Year])",
                  "\t))",
                  ""
                ],
                "formatString": "#,0"
              },
              {
                "name": "MKT Prog Cost / Target (LY)",
                "expression": [
                  " CALCULATE( [. Ttl MKT Prog Cost (LY)]/[. Target Marketing (LY)],",
                  "REMOVEFILTERS('Dim - Plant'),",
                  "REMOVEFILTERS('Dim - Channel'))"
                ],
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "MKT Prog Cost / Target",
                "expression": [
                  " CALCULATE([. Ttl MKT Prog Cost]/[. Target Marketing],",
                  "REMOVEFILTERS('Dim - Plant'),",
                  "REMOVEFILTERS('Dim - Channel'))"
                ],
                "formatString": "0.0 %;-0.0 %;0.0 %"
              },
              {
                "name": "MKT Prog Cost/ Revenue",
                "expression": [
                  " CALCULATE([. Ttl MKT Prog Cost]/[. MKT Net Amt],",
                  "REMOVEFILTERS('Dim - Plant'),",
                  "REMOVEFILTERS('Dim - Channel'))"
                ],
                "formatString": "0.0 %;-0.0 %;0.0 %"
              },
              {
                "name": "MKT Prog Cost/ Revenue (LY)",
                "expression": [
                  " CALCULATE([. Ttl MKT Prog Cost (LY)]/[. MKT Net Amt (LY)],",
                  "REMOVEFILTERS('Dim - Plant'),",
                  "REMOVEFILTERS('Dim - Channel'))"
                ],
                "formatString": "0.0 %;-0.0 %;0.0 %"
              },
              {
                "name": "% MKT Prog Cost/ Revenue",
                "expression": " [MKT Prog Cost/ Revenue]/ [MKT Prog Cost/ Revenue (LY)]-1",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "% MKT Prog Cost / Target",
                "expression": " [MKT Prog Cost / Target]/[MKT Prog Cost / Target (LY)]-1",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              },
              {
                "name": "CPO",
                "expression": [
                  " CALCULATE([. Ttl MKT Prog Cost]/[# Cust Transaction (PC)],",
                  "REMOVEFILTERS('Dim - Plant'),",
                  "REMOVEFILTERS('Dim - Channel'))"
                ],
                "formatString": "#,0"
              },
              {
                "name": "CPO (LY)",
                "expression": [
                  " CALCULATE([. Ttl MKT Prog Cost (LY)]/[# MKT Cust Transaction (LY)],",
                  "REMOVEFILTERS('Dim - Plant'),",
                  "REMOVEFILTERS('Dim - Channel'))"
                ],
                "formatString": "#,0"
              },
              {
                "name": "% Ttl MKT Prog Cost",
                "expression": "[. Ttl MKT Prog Cost]/[. Ttl MKT Prog Cost (LY)]-1",
                "formatString": "0.00 %;-0.00 %;0.00 %"
              }
            ]
          },
          {
            "name": "Dim - Authoring",
            "columns": [
              {
                "name": "Email",
                "dataType": "string",
                "sourceColumn": "Email"
              },
              {
                "name": "PLANT_WID",
                "dataType": "int64",
                "sourceColumn": "Plant_Wid"
              },
              {
                "name": "Plant Code",
                "dataType": "string",
                "sourceColumn": "Plant Code"
              }
            ],
            "partitions": [
              {
                "name": "Partition",
                "dataView": "full",
                "source": {
                  "type": "m",
                  "expression": [
                    "let",
                    "    Source = #\"SQL/192 168 3 31;PNJ_ROLAP\",",
                    "    dbo_W_VW_SYS_AUTHOR_D = Source{[Schema=\"dbo\",Item=\"W_VW_SYS_AUTHOR_D\"]}[Data],",
                    "    #\"Renamed Columns\" = Table.RenameColumns(dbo_W_VW_SYS_AUTHOR_D,{{\"Plant_code\", \"Plant Code\"}, {\"PLANT_WID\", \"Plant_Wid\"}}),",
                    "    #\"Removed Columns\" = Table.RemoveColumns(#\"Renamed Columns\",{\"Roles\", \"FullName\", \"Cum\"})",
                    "in",
                    "    #\"Removed Columns\""
                  ]
                }
              }
            ]
          },
          {
            "name": "Dim - Authoring Brands",
            "columns": [
              {
                "name": "Email",
                "dataType": "string",
                "sourceColumn": "Email"
              },
              {
                "name": "Brands",
                "dataType": "string",
                "sourceColumn": "Brands"
              }
            ],
            "partitions": [
              {
                "name": "Partition",
                "dataView": "full",
                "source": {
                  "type": "m",
                  "expression": [
                    "let",
                    "    Source = #\"SQL/192 168 3 31;PNJ_ROLAP\",",
                    "    dbo_W_SYS_AUTHOR_BRAND_D = Source{[Schema=\"dbo\",Item=\"W_SYS_AUTHOR_BRAND_D\"]}[Data],",
                    "    #\"Removed Columns\" = Table.RemoveColumns(dbo_W_SYS_AUTHOR_BRAND_D,{\"FullName\", \"Roles\", \"Licenses\"})",
                    "in",
                    "    #\"Removed Columns\""
                  ]
                }
              }
            ]
          },
          {
            "name": "Fact - MKT Cost",
            "columns": [
              {
                "name": "Plant_Wid",
                "dataType": "int64",
                "sourceColumn": "Plant_Wid"
              },
              {
                "name": "MKT.Year",
                "dataType": "string",
                "sourceColumn": "MKT.Year"
              },
              {
                "name": "Program Category",
                "dataType": "string",
                "sourceColumn": "Program Category"
              },
              {
                "name": "ChargeBy",
                "dataType": "string",
                "sourceColumn": "ChargeBy"
              },
              {
                "name": "Cost Group",
                "dataType": "string",
                "sourceColumn": "Cost Group"
              },
              {
                "name": "Total Cost",
                "dataType": "double",
                "sourceColumn": "Total Cost"
              },
              {
                "name": "Date_key",
                "dataType": "double",
                "sourceColumn": "Date_key"
              }
            ],
            "partitions": [
              {
                "name": "Partition",
                "dataView": "full",
                "source": {
                  "type": "m",
                  "expression": [
                    "let",
                    "    Source = Value.NativeQuery(#\"SQL/192 168 3 31;PNJ_ROLAP\",\"SELECT PLANT_WID ,[MKT.Year], PROGRAM_CATEGORY, ChargeBy, Date_key, COST_GROUP, COST FROM W_VW_MARKETING_COST_F\"),",
                    "    #\"Renamed Columns\" = Table.RenameColumns(Source,{{\"PROGRAM_CATEGORY\", \"Program Category\"}, {\"COST_GROUP\", \"Cost Group\"}, {\"COST\", \"Total Cost\"}, {\"PLANT_WID\", \"Plant_Wid\"}})",
                    "in",
                    "    #\"Renamed Columns\""
                  ]
                }
              }
            ]
          },
          {
            "name": "Dim - Time (Lunar)",
            "columns": [
              {
                "name": "ROW_WID",
                "dataType": "int64",
                "sourceColumn": "ROW_WID"
              },
              {
                "name": "INTEGRATION_ID",
                "dataType": "string",
                "sourceColumn": "INTEGRATION_ID"
              },
              {
                "name": "DATASOURCE_NUM_ID",
                "dataType": "int64",
                "sourceColumn": "DATASOURCE_NUM_ID"
              },
              {
                "name": "DATE_KEY",
                "dataType": "int64",
                "sourceColumn": "DATE_KEY"
              },
              {
                "name": "CALENDAR_DATE",
                "dataType": "dateTime",
                "sourceColumn": "CALENDAR_DATE"
              },
              {
                "name": "CAL_YEAR",
                "dataType": "int64",
                "sourceColumn": "CAL_YEAR"
              },
              {
                "name": "CAL_HALF",
                "dataType": "int64",
                "sourceColumn": "CAL_HALF"
              },
              {
                "name": "CAL_QTR",
                "dataType": "int64",
                "sourceColumn": "CAL_QTR"
              },
              {
                "name": "CAL_TRIMESTER",
                "dataType": "int64",
                "sourceColumn": "CAL_TRIMESTER"
              },
              {
                "name": "CAL_MONTH",
                "dataType": "int64",
                "sourceColumn": "CAL_MONTH"
              },
              {
                "name": "CAL_WEEK",
                "dataType": "int64",
                "sourceColumn": "CAL_WEEK"
              },
              {
                "name": "DAY_NAME",
                "dataType": "string",
                "sourceColumn": "DAY_NAME"
              },
              {
                "name": "DAY_OF_YEAR",
                "dataType": "int64",
                "sourceColumn": "DAY_OF_YEAR"
              },
              {
                "name": "DAY_OF_MONTH",
                "dataType": "int64",
                "sourceColumn": "DAY_OF_MONTH"
              },
              {
                "name": "DAY_OF_WEEK",
                "dataType": "int64",
                "sourceColumn": "DAY_OF_WEEK"
              },
              {
                "name": "MONTH_NAME",
                "dataType": "string",
                "sourceColumn": "MONTH_NAME"
              },
              {
                "name": "PER_NAME_YEAR",
                "dataType": "string",
                "sourceColumn": "PER_NAME_YEAR"
              },
              {
                "name": "PER_NAME_HALF",
                "dataType": "string",
                "sourceColumn": "PER_NAME_HALF"
              },
              {
                "name": "PER_NAME_TER",
                "dataType": "string",
                "sourceColumn": "PER_NAME_TER"
              },
              {
                "name": "PER_NAME_QTR",
                "dataType": "string",
                "sourceColumn": "PER_NAME_QTR"
              },
              {
                "name": "PER_NAME_MONTH",
                "dataType": "string",
                "sourceColumn": "PER_NAME_MONTH"
              },
              {
                "name": "PER_NAME_WEEK",
                "dataType": "string",
                "sourceColumn": "PER_NAME_WEEK"
              },
              {
                "name": "PER_NAME_OFFSET_WK",
                "dataType": "string",
                "sourceColumn": "PER_NAME_OFFSET_WK"
              },
              {
                "name": "DAY_AGO_DT",
                "dataType": "dateTime",
                "sourceColumn": "DAY_AGO_DT"
              },
              {
                "name": "WEEK_AGO_DT",
                "dataType": "dateTime",
                "sourceColumn": "WEEK_AGO_DT"
              },
              {
                "name": "MONTH_AGO_DT",
                "dataType": "dateTime",
                "sourceColumn": "MONTH_AGO_DT"
              },
              {
                "name": "QUARTER_AGO_DT",
                "dataType": "dateTime",
                "sourceColumn": "QUARTER_AGO_DT"
              },
              {
                "name": "TRIMESTER_AGO_DT",
                "dataType": "dateTime",
                "sourceColumn": "TRIMESTER_AGO_DT"
              },
              {
                "name": "HALF_AGO_DT",
                "dataType": "dateTime",
                "sourceColumn": "HALF_AGO_DT"
              },
              {
                "name": "YEAR_AGO_DT",
                "dataType": "dateTime",
                "sourceColumn": "YEAR_AGO_DT"
              },
              {
                "name": "CAL_YEAR_START_DT",
                "dataType": "dateTime",
                "sourceColumn": "CAL_YEAR_START_DT"
              },
              {
                "name": "CAL_YEAR_END_DT",
                "dataType": "dateTime",
                "sourceColumn": "CAL_YEAR_END_DT"
              },
              {
                "name": "M_START_CAL_DT",
                "dataType": "dateTime",
                "sourceColumn": "M_START_CAL_DT"
              },
              {
                "name": "M_END_CAL_DT",
                "dataType": "dateTime",
                "sourceColumn": "M_END_CAL_DT"
              },
              {
                "name": "HOLIDAY_FLG",
                "dataType": "string",
                "sourceColumn": "HOLIDAY_FLG"
              },
              {
                "name": "WEEKEND_FLG",
                "dataType": "string",
                "sourceColumn": "WEEKEND_FLG"
              },
              {
                "name": "FST_DAY_CAL_WK_FLG",
                "dataType": "string",
                "sourceColumn": "FST_DAY_CAL_WK_FLG"
              },
              {
                "name": "LAST_DAY_CAL_WK_FLG",
                "dataType": "string",
                "sourceColumn": "LAST_DAY_CAL_WK_FLG"
              },
              {
                "name": "FST_DAY_CAL_MNTH_FLG",
                "dataType": "string",
                "sourceColumn": "FST_DAY_CAL_MNTH_FLG"
              },
              {
                "name": "LAST_DAY_CAL_MNTH_FLG",
                "dataType": "string",
                "sourceColumn": "LAST_DAY_CAL_MNTH_FLG"
              },
              {
                "name": "FST_DAY_CAL_QTR_FLG",
                "dataType": "string",
                "sourceColumn": "FST_DAY_CAL_QTR_FLG"
              },
              {
                "name": "LAST_DAY_CAL_QTR_FLG",
                "dataType": "string",
                "sourceColumn": "LAST_DAY_CAL_QTR_FLG"
              },
              {
                "name": "FST_DAY_CAL_YEAR_FLG",
                "dataType": "string",
                "sourceColumn": "FST_DAY_CAL_YEAR_FLG"
              },
              {
                "name": "LAST_DAY_CAL_YEAR_FLG",
                "dataType": "string",
                "sourceColumn": "LAST_DAY_CAL_YEAR_FLG"
              },
              {
                "name": "CAL_YEAR_WID",
                "dataType": "int64",
                "sourceColumn": "CAL_YEAR_WID"
              },
              {
                "name": "CAL_QTR_WID",
                "dataType": "int64",
                "sourceColumn": "CAL_QTR_WID"
              },
              {
                "name": "CAL_MONTH_WID",
                "dataType": "int64",
                "sourceColumn": "CAL_MONTH_WID"
              },
              {
                "name": "DAY_AGO_WID",
                "dataType": "int64",
                "sourceColumn": "DAY_AGO_WID"
              },
              {
                "name": "WEEK_AGO_WID",
                "dataType": "int64",
                "sourceColumn": "WEEK_AGO_WID"
              },
              {
                "name": "MONTH_AGO_WID",
                "dataType": "int64",
                "sourceColumn": "MONTH_AGO_WID"
              },
              {
                "name": "QUARTER_AGO_WID",
                "dataType": "int64",
                "sourceColumn": "QUARTER_AGO_WID"
              },
              {
                "name": "TRIMESTER_AGO_WID",
                "dataType": "int64",
                "sourceColumn": "TRIMESTER_AGO_WID"
              },
              {
                "name": "HALF_AGO_WID",
                "dataType": "int64",
                "sourceColumn": "HALF_AGO_WID"
              },
              {
                "name": "YEAR_AGO_WID",
                "dataType": "int64",
                "sourceColumn": "YEAR_AGO_WID"
              },
              {
                "name": "M_END_CAL_DT_WID",
                "dataType": "int64",
                "sourceColumn": "M_END_CAL_DT_WID"
              },
              {
                "name": "M_START_CAL_DT_WID",
                "dataType": "int64",
                "sourceColumn": "M_START_CAL_DT_WID"
              },
              {
                "name": "CAL_WEEK_END_DT_WID",
                "dataType": "int64",
                "sourceColumn": "CAL_WEEK_END_DT_WID"
              },
              {
                "name": "CAL_WEEK_START_DT_WID",
                "dataType": "int64",
                "sourceColumn": "CAL_WEEK_START_DT_WID"
              },
              {
                "name": "CAL_QTR_END_DT_WID",
                "dataType": "int64",
                "sourceColumn": "CAL_QTR_END_DT_WID"
              },
              {
                "name": "CAL_QTR_START_DT_WID",
                "dataType": "int64",
                "sourceColumn": "CAL_QTR_START_DT_WID"
              },
              {
                "name": "CAL_YEAR_START_DT_WID",
                "dataType": "int64",
                "sourceColumn": "CAL_YEAR_START_DT_WID"
              },
              {
                "name": "CAL_YEAR_END_DT_WID",
                "dataType": "int64",
                "sourceColumn": "CAL_YEAR_END_DT_WID"
              },
              {
                "name": "ENT_YEAR",
                "dataType": "int64",
                "sourceColumn": "ENT_YEAR"
              },
              {
                "name": "ENT_HALF",
                "dataType": "int64",
                "sourceColumn": "ENT_HALF"
              },
              {
                "name": "ENT_TRIMESTER",
                "dataType": "int64",
                "sourceColumn": "ENT_TRIMESTER"
              },
              {
                "name": "ENT_QTR",
                "dataType": "int64",
                "sourceColumn": "ENT_QTR"
              },
              {
                "name": "ENT_PERIOD",
                "dataType": "int64",
                "sourceColumn": "ENT_PERIOD"
              },
              {
                "name": "ENT_WEEK",
                "dataType": "int64",
                "sourceColumn": "ENT_WEEK"
              },
              {
                "name": "ENT_DAY_OF_PERIOD",
                "dataType": "int64",
                "sourceColumn": "ENT_DAY_OF_PERIOD"

              },
              {
                "name": "ENT_DAY_OF_WEEK",
                "dataType": "int64",
                "sourceColumn": "ENT_DAY_OF_WEEK"
              },
              {
                "name": "ENT_DAY_OF_YEAR",
                "dataType": "int64",
                "sourceColumn": "ENT_DAY_OF_YEAR"
              },
              {
                "name": "ENT_PERIOD_WEEK_NUM",
                "dataType": "int64",
                "sourceColumn": "ENT_PERIOD_WEEK_NUM"
              },
              {
                "name": "PER_NAME_ENT_HALF",
                "dataType": "string",
                "sourceColumn": "PER_NAME_ENT_HALF"
              },
              {
                "name": "PER_NAME_ENT_PERIOD",
                "dataType": "string",
                "sourceColumn": "PER_NAME_ENT_PERIOD"
              },
              {
                "name": "PER_NAME_ENT_QTR",
                "dataType": "string",
                "sourceColumn": "PER_NAME_ENT_QTR"
              },
              {
                "name": "PER_NAME_ENT_TER",
                "dataType": "string",
                "sourceColumn": "PER_NAME_ENT_TER"
              },
              {
                "name": "PER_NAME_ENT_WEEK",
                "dataType": "string",
                "sourceColumn": "PER_NAME_ENT_WEEK"
              },
              {
                "name": "PER_NAME_ENT_YEAR",
                "dataType": "string",
                "sourceColumn": "PER_NAME_ENT_YEAR"
              },
              {
                "name": "ENT_DATE",
                "dataType": "dateTime",
                "sourceColumn": "ENT_DATE"
              },
              {
                "name": "ENT_WEEK_START_DT",
                "dataType": "dateTime",
                "sourceColumn": "ENT_WEEK_START_DT"
              },
              {
                "name": "ENT_WEEK_END_DT",
                "dataType": "dateTime",
                "sourceColumn": "ENT_WEEK_END_DT"
              },
              {
                "name": "ENT_PERIOD_START_DT",
                "dataType": "dateTime",
                "sourceColumn": "ENT_PERIOD_START_DT"
              },
              {
                "name": "ENT_PERIOD_END_DT",
                "dataType": "dateTime",
                "sourceColumn": "ENT_PERIOD_END_DT"
              },
              {
                "name": "ENT_QTR_START_DT",
                "dataType": "dateTime",
                "sourceColumn": "ENT_QTR_START_DT"
              },
              {
                "name": "ENT_QTR_END_DT",
                "dataType": "dateTime",
                "sourceColumn": "ENT_QTR_END_DT"
              },
              {
                "name": "ENT_YEAR_START_DT",
                "dataType": "dateTime",
                "sourceColumn": "ENT_YEAR_START_DT"
              },
              {
                "name": "ENT_YEAR_END_DT",
                "dataType": "dateTime",
                "sourceColumn": "ENT_YEAR_END_DT"
              },
              {
                "name": "ENT_QTR_AGO_WID",
                "dataType": "int64",
                "sourceColumn": "ENT_QTR_AGO_WID"
              },
              {
                "name": "ENT_WEEK_AGO_WID",
                "dataType": "int64",
                "sourceColumn": "ENT_WEEK_AGO_WID"
              },
              {
                "name": "ENT_PERIOD_WID",
                "dataType": "int64",
                "sourceColumn": "ENT_PERIOD_WID"
              },
              {
                "name": "ENT_PERIOD_AGO_WID",
                "dataType": "int64",
                "sourceColumn": "ENT_PERIOD_AGO_WID"
              },
              {
                "name": "ENT_WEEK_START_DT_WID",
                "dataType": "int64",
                "sourceColumn": "ENT_WEEK_START_DT_WID"
              },
              {
                "name": "ENT_WEEK_END_DT_WID",
                "dataType": "int64",
                "sourceColumn": "ENT_WEEK_END_DT_WID"
              },
              {
                "name": "ENT_PERIOD_START_DT_WID",
                "dataType": "int64",
                "sourceColumn": "ENT_PERIOD_START_DT_WID"
              },
              {
                "name": "ENT_PERIOD_END_DT_WID",
                "dataType": "int64",
                "sourceColumn": "ENT_PERIOD_END_DT_WID"
              },
              {
                "name": "ENT_QTR_START_DT_WID",
                "dataType": "int64",
                "sourceColumn": "ENT_QTR_START_DT_WID"
              },
              {
                "name": "ENT_QTR_END_DT_WID",
                "dataType": "int64",
                "sourceColumn": "ENT_QTR_END_DT_WID"
              },
              {
                "name": "ENT_YEAR_START_DT_WID",
                "dataType": "int64",
                "sourceColumn": "ENT_YEAR_START_DT_WID"
              },
              {
                "name": "ENT_YEAR_END_DT_WID",
                "dataType": "int64",
                "sourceColumn": "ENT_YEAR_END_DT_WID"
              },
              {
                "name": "FST_DAY_ENT_WEEK_FLG",
                "dataType": "string",
                "sourceColumn": "FST_DAY_ENT_WEEK_FLG"
              },
              {
                "name": "LAST_DAY_ENT_WEEK_FLG",
                "dataType": "string",
                "sourceColumn": "LAST_DAY_ENT_WEEK_FLG"
              },
              {
                "name": "FST_DAY_ENT_PERIOD_FLG",
                "dataType": "string",
                "sourceColumn": "FST_DAY_ENT_PERIOD_FLG"
              },
              {
                "name": "LAST_DAY_ENT_PERIOD_FLG",
                "dataType": "string",
                "sourceColumn": "LAST_DAY_ENT_PERIOD_FLG"
              },
              {
                "name": "FST_DAY_ENT_QTR_FLG",
                "dataType": "string",
                "sourceColumn": "FST_DAY_ENT_QTR_FLG"
              },
              {
                "name": "LAST_DAY_ENT_QTR_FLG",
                "dataType": "string",
                "sourceColumn": "LAST_DAY_ENT_QTR_FLG"
              },
              {
                "name": "FST_DAY_ENT_YEAR_FLG",
                "dataType": "string",
                "sourceColumn": "FST_DAY_ENT_YEAR_FLG"
              },
              {
                "name": "LAST_DAY_ENT_YEAR_FLG",
                "dataType": "string",
                "sourceColumn": "LAST_DAY_ENT_YEAR_FLG"
              },
              {
                "name": "LUNAR_YEAR",
                "dataType": "int64",
                "sourceColumn": "LUNAR_YEAR"
              },
              {
                "name": "LUNAR_MONTH",
                "dataType": "int64",
                "sourceColumn": "LUNAR_MONTH"
              },
              {
                "name": "LUNAR_DATE_WID",
                "dataType": "int64",
                "sourceColumn": "LUNAR_DATE_WID"
              },
              {
                "name": "LUNAR_DAY",
                "dataType": "int64",
                "sourceColumn": "LUNAR_DAY"
              }
            ],
            "partitions": [
              {
                "name": "Partition",
                "dataView": "full",
                "source": {
                  "type": "m",
                  "expression": [
                    "let",
                    "    Source = #\"SQL/192 168 3 31;PNJ_ROLAP\",",
                    "    dbo_W_DAY_D = Source{[Schema=\"dbo\",Item=\"W_DAY_D\"]}[Data]",
                    "in",
                    "    dbo_W_DAY_D"
                  ]
                }
              }
            ]
          }
        ],
        "relationships": [
          {
            "name": "cce8913d-4f92-4e0b-bb7a-919196d929dc",
            "fromTable": "Dim - Customer",
            "fromColumn": "REGION_WID",
            "toTable": "Dim - Territory",
            "toColumn": "ROW_WID"
          },
          {
            "name": "74cddc4a-0346-479d-9a8a-ba86b9113e02",
            "fromTable": "Dim - Customer",
            "fromColumn": "CREATED_ON_DT",
            "toTable": "Dim - Time",
            "toColumn": "ROW_WID",
            "isActive": false
          },
          {
            "name": "eb9ce498-1612-4672-af84-c7764f1ce76e",
            "fromTable": "Dim - Plant",
            "fromColumn": "First Transaction DT",
            "toTable": "Dim - Time",
            "toColumn": "ROW_WID",
            "isActive": false
          },
          {
            "name": "b0f15988-85ac-410a-a51c-81b9592e53fc",
            "fromTable": "Fact - Marketing Plan",
            "fromColumn": "PLANT_WID",
            "toTable": "Dim - Plant",
            "toColumn": "ROW_WID"
          },
          {
            "name": "5385613a-9940-4b48-b239-408db61ce8fe",
            "fromTable": "Fact - Marketing Plan",
            "fromColumn": "COMPANY_WID",
            "toTable": "Dim - Company",
            "toColumn": "ROW_WID"
          },
          {
            "name": "a8951e3c-f0e1-41bd-a4bc-21904db3bb20",
            "fromTable": "Fact - Marketing Plan",
            "fromColumn": "PROGRAM_WID",
            "toTable": "Dim - Program",
            "toColumn": "ROW_WID"
          },
          {
            "name": "52d8096c-3572-413a-9cdb-02b566b99c78",
            "fromTable": "Fact - Sales Invoice Line",
            "fromColumn": "PRODUCT_WID",
            "toTable": "Dim - Product",
            "toColumn": "ROW_WID"
          },
          {
            "name": "057aa975-bb4a-4937-9695-a37ea44ff4d9",
            "fromTable": "Fact - Sales Invoice Line",
            "fromColumn": "CUSTOMER_SOLD_TO_WID",
            "toTable": "Dim - Customer",
            "toColumn": "ROW_WID"
          },
          {
            "name": "7c23f5e6-208d-4476-bc38-d986f302c7a1",
            "fromTable": "Fact - Sales Invoice Line",
            "fromColumn": "Program_wid",
            "toTable": "Dim - Program",
            "toColumn": "ROW_WID"
          },
          {
            "name": "8437995f-6fb0-4073-bd18-b34a94bfbac8",
            "fromTable": "Fact - Sales Invoice Line",
            "fromColumn": "INVOICED_ON_DT_WID",
            "toTable": "Dim - Time",
            "toColumn": "ROW_WID"
          },
          {
            "name": "df9cbe12-2132-4400-bb73-da4ed2225c19",
            "fromTable": "Fact - ATL",
            "fromColumn": "Date_key",
            "toTable": "Dim - Time",
            "toColumn": "ROW_WID"
          },
          {
            "name": "a2c39372-cfd0-4259-ad21-d960cd304338",
            "fromTable": "Fact - ATL",
            "fromColumn": "Plant_wid",
            "toTable": "Dim - Plant",
            "toColumn": "ROW_WID"
          },
          {
            "name": "b668e31f-ad0f-4090-b707-3fdcb4d546ac",
            "fromTable": "Fact - ATL",
            "fromColumn": "PROGRAM_WID",
            "toTable": "Dim - Program",
            "toColumn": "ROW_WID"
          },
          {
            "name": "50e0e064-01fe-4410-93d3-aa7d65435192",
            "fromTable": "Fact - Camera",
            "fromColumn": "age_range",
            "toTable": "Dim - Camera Age",
            "toColumn": "Palexy AGEID"
          },
          {
            "name": "3f3b5ebb-1650-44f2-85e7-2012cd33cb32",
            "fromTable": "Fact - Camera",
            "fromColumn": "DATE",
            "toTable": "Dim - Time",
            "toColumn": "ROW_WID"
          },
          {
            "name": "e0bde189-c64f-4ba7-9d97-8e5439633c62",
            "fromTable": "Fact - Condition",
            "fromColumn": "SALE_DEAL_WID",
            "toTable": "Dim - Sale Deals",
            "toColumn": "ROW_WID"
          },
          {
            "name": "2bcb5a8b-4048-49a6-b7d9-d383a337b6c7",
            "fromTable": "Fact - Marketing Plan",
            "fromColumn": "PRODUCT_WID",
            "toTable": "Dim - Product",
            "toColumn": "ROW_WID"
          },
          {
            "name": "057b7100-f898-4e4e-9e6d-8615db2731b1",
            "fromTable": "Fact - Marketing Spend",
            "fromColumn": "PROGRAM_WID",
            "toTable": "Dim - Program",
            "toColumn": "ROW_WID"
          },
          {
            "name": "f0852c9f-91ec-4a2a-91a9-28b9211f6a5c",
            "fromTable": "Fact - Sales Invoice Line",
            "fromColumn": "CHANNEL_CODE",
            "toTable": "Dim - Channel",
            "toColumn": "CHANNEL_CODE"
          },
          {
            "name": "1afaebe5-2b0e-4f67-ba9b-50c6af803e2a",
            "fromTable": "Fact - Sales Invoice Line",
            "fromColumn": "Invoice date",
            "toTable": "Dim - Time",
            "toColumn": "Date",
            "isActive": false
          },
          {
            "name": "5728bf72-5930-46ca-b9da-7a4a622893dd",
            "fromTable": "Fact - Sales Invoice Line",
            "fromColumn": "PLANT_WID",
            "toTable": "Dim - Plant",
            "toColumn": "ROW_WID"
          },
          {
            "name": "b21cc03c-16ab-4d77-9d77-963b766f0ba8",
            "fromTable": "Fact - Marketing Plan",
            "fromColumn": "DATE_KEY",
            "toTable": "Dim - Time",
            "toColumn": "ROW_WID"
          },
          {
            "name": "f6299532-1a4d-43b9-a789-9656a72b6e54",
            "fromTable": "Fact - Camera",
            "fromColumn": "PLANT_WID",
            "toTable": "Dim - Plant",
            "toColumn": "ROW_WID"
          },
          {
            "name": "a77fa1d8-ba4e-4a58-b34f-8d176f621e9c",
            "fromTable": "Fact - MKT Cost",
            "fromColumn": "Plant_Wid",
            "toTable": "Dim - Plant",
            "toColumn": "ROW_WID"
          },
          {
            "name": "99629509-5fcc-459a-9960-516e6e6d145d",
            "toCardinality": "many",
            "fromTable": "Fact - Condition",
            "fromColumn": "ConditionID",
            "toTable": "Fact - Sales Invoice Line",
            "toColumn": "ConditionID",
            "crossFilteringBehavior": "bothDirections"
          }
        ],
        "roles": [
          {
            "name": "Administrator",
            "modelPermission": "administrator",
            "members": [
              {
                "memberName": "bi_support@pnj.com.vn",
                "memberId": "bi_support@pnj.com.vn",
                "identityProvider": "AzureAD"
              }
            ]
          },
          {
            "name": "PowerUser",
            "modelPermission": "read",
            "members": [
              {
                "memberName": "PNJCORP\\xuan.ntl",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-27511"
              },
              {
                "memberName": "PNJCORP\\chau.ltb",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-1686"
              },
              {
                "memberName": "PNJCORP\\tram.lth01",

                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-25965"
              },
              {
                "memberName": "PNJCORP\\duy.lnh",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-27822"
              },
              {
                "memberName": "PNJCORP\\duy.ln",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-2798"
              },
              {
                "memberName": "PNJCORP\\long.tnp",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-22543"
              },
              {
                "memberName": "PNJCORP\\linh.nk03",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-28521"
              },
              {
                "memberName": "PNJCORP\\anh.ntb",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-23523"
              },
              {
                "memberName": "PNJCORP\\ngan.ttk08",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-26203"
              },
              {
                "memberName": "PNJCORP\\quynh.ntn06",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-14672"
              },
              {
                "memberName": "PNJCORP\\phung.dbk",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-21366"
              },
              {
                "memberName": "PNJCORP\\nhut.np",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-24903"
              },
              {
                "memberName": "PNJCORP\\dung.ctn",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-2828"
              },
              {
                "memberName": "PNJCORP\\thong.lt",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-2846"
              },
              {
                "memberName": "PNJCORP\\huy.vh01",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-1680"
              },
              {
                "memberName": "PNJCORP\\dung.pt",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-4013"
              },
              {
                "memberName": "PNJCORP\\loi.lq",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-6263"
              },
              {
                "memberName": "PNJCORP\\ha.ttt",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-1675"
              },
              {
                "memberName": "PNJCORP\\thanh.tq",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-5029"
              },
              {
                "memberName": "PNJCORP\\nha.tt",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-5484"
              }
            ]
          },
          {
            "name": "StandardUser",
            "modelPermission": "read",
            "members": [
              {
                "memberName": "PNJCORP\\DTC",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-27866"
              },
              {
                "memberName": "PNJCORP\\bi.ptkd",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-25208"
              },
              {
                "memberName": "PNJCORP\\hien.ntl",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-2742"
              },
              {
                "memberName": "PNJCORP\\tu.nm",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-12504"
              }
            ],
            "tablePermissions": [
              {
                "name": "Dim - Plant",
                "filterExpression": "CONTAINS('Dim - Authoring', 'Dim - Authoring'[Email], USERPRINCIPALNAME(),'Dim - Authoring'[Plant_Wid], 'Dim - Plant'[Row_Wid])"
              },
              {
                "name": "Dim - Authoring",
                "filterExpression": "FALSE"
              },
              {
                "name": "Dim - Authoring Brands",
                "filterExpression": "FALSE"
              },
              {
                "name": "Fact - Condition",
                "filterExpression": "CONTAINS('Dim - Authoring', 'Dim - Authoring'[Email], USERPRINCIPALNAME(),'Dim - Authoring'[Plant_Wid],  'Fact - Condition'[Plant_Wid])"
              }
            ]
          },
          {
            "name": "Brands",
            "modelPermission": "read",
            "members": [
              {
                "memberName": "PNJCORP\\ngoc.pth",
                "memberId": "S-1-5-21-3941070233-2248949771-1228141224-17599"
              }
            ],
            "tablePermissions": [
              {
                "name": "Dim - Product",
                "filterExpression": "CONTAINS('Dim - Authoring Brands', 'Dim - Authoring Brands'[Email], USERPRINCIPALNAME(),'Dim - Authoring Brands'[Brands], 'Dim - Product'[Co-Operate Brand])"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "ClientCompatibilityLevel",
            "value": "600"
          }
        ]
      }
    }
  }
}